import so from"./approval-90ad6b64.js";import ao from"./starter-900d10fb.js";import ro from"./cc-226f3597.js";import fo from"./trigger-938c90c5.js";import go from"./delay-9c1087fe.js";import uo from"./subProcess-996df794.js";import Co from"./route-9fe2a49b.js";import{d as J,h as O,r as q,D as W,L as H,o as ho,ck as A,a as t,c as l,k as d,au as B,f as _,R as L,a6 as G,n as K,am as h,P as Q,cl as X,q as b,a5 as V,l as p,ag as Y,ah as Z,a2 as No}from"./index-d5547550.js";import{b as E}from"./const-a11e1fef.js";import{$ as j}from"./index-a7c7b111.js";import M from"./addNode-8159b811.js";import{u as x}from"./index-71f0fd6b.js";import{_ as oo}from"./_plugin-vue_export-helper-c27b6911.js";import{u as po}from"./flow-165b4256.js";const S=e=>(Y("data-v-c5623240"),e=e(),Z(),e),vo={class:"branch-wrap"},yo={class:"branch-box-wrap"},ko={class:"branch-box"},mo={class:"condition-node"},_o={class:"condition-node-box"},bo=["onClick"],$o={class:"title-wrapper"},Uo=["onBlur","onUpdate:modelValue"],Lo=["onClick"],Po=["onClick"],So=["onClick"],Do=["onClick"],wo=["onClick"],To={key:3,class:"content"},Io={key:4,class:"error_tip"},jo=S(()=>d("i",{class:"anticon anticon-exclamation-circle"},null,-1)),Oo=[jo],Bo=S(()=>d("div",{class:"top-left-cover-line"},null,-1)),Vo=S(()=>d("div",{class:"bottom-left-cover-line"},null,-1)),Eo=S(()=>d("div",{class:"top-right-cover-line"},null,-1)),Mo=S(()=>d("div",{class:"bottom-right-cover-line"},null,-1)),Ro=J({__name:"condition",props:{nodeConfig:{type:Object,default:()=>{}}},emits:["updateData"],setup(e,{emit:P}){const o=e,{proxy:$}=O();let v=q([]);const N=n=>{P("updateData",n)},y=()=>{for(var n=0;n<o.nodeConfig.conditionNodes.length;n++){let c=o.nodeConfig.conditionNodes[n];c.error=!1,n!=o.nodeConfig.conditionNodes.length-1?c.error=!j.checkCondition(o.nodeConfig,n):c.conditionList=[{mode:!0,conditionList:[{key:"",expression:""}]}],c.placeHolder=j.conditionStr(o.nodeConfig,n)}},w=(n,c=1)=>{o.nodeConfig.conditionNodes[n]=o.nodeConfig.conditionNodes.splice(n+c,1,o.nodeConfig.conditionNodes[n])[0],o.nodeConfig.conditionNodes.map((k,s)=>{k.priorityLevel=s+1}),y(),N(o.nodeConfig)},R=n=>{v.value[n]=!1,o.nodeConfig.conditionNodes[n].nodeName=o.nodeConfig.conditionNodes[n].nodeName||"条件"},T=n=>{v.value[n]=!0},I=(n,c)=>{n.childNode?I(n.childNode,c):n.childNode=c},z=n=>{o.nodeConfig.conditionNodes.splice(n,1),o.nodeConfig.conditionNodes.map((c,k)=>{c.priorityLevel=k+1,c.nodeName=`条件${k+1}`}),y(),N(o.nodeConfig),o.nodeConfig.conditionNodes.length==1&&(o.nodeConfig.childNode&&(o.nodeConfig.conditionNodes[0].childNode?I(o.nodeConfig.conditionNodes[0].childNode,o.nodeConfig.childNode):o.nodeConfig.conditionNodes[0].childNode=o.nodeConfig.childNode),N(o.nodeConfig.conditionNodes[0].childNode))};let i=x(),{setCondition:u,setConditionsConfig:m}=i,a=W(()=>i.conditionsConfig1);H(a,n=>{n.flag&&n.id===C&&N(n.value)});let C=O().uid;const g=n=>{m({value:JSON.parse(JSON.stringify(o.nodeConfig)),priorityLevel:n,flag:!1,id:C}),u(!0)},to=()=>{let n=o.nodeConfig.conditionNodes.length+1;o.nodeConfig.conditionNodes.push({nodeName:"条件"+n,type:3,parentId:o.nodeConfig.id,mode:!0,groupRelationMode:!0,groupRelation:[],id:$.$getRandomId(),priorityLevel:n,conditionList:[{mode:!0,conditionList:[{key:"",expression:""}]}],nodeUserList:[],childNode:null}),y(),N(o.nodeConfig)};ho(()=>{y()});let io=po();const lo=W(()=>io.step2);return H(()=>lo.value,n=>{let c=o.nodeConfig;var k=0,s=c.conditionNodes.length;for(var r of c.conditionNodes){if(k>=s-1)break;for(var f of r.conditionList)for(var U of f.conditionList){if(U.key==="root")continue;n.filter(co=>co.id===U.key).length==0&&(U.key="",U.expression="",U.keyType="",U.value="",r.error=!0)}k++}}),(n,c)=>{const k=A("focus");return t(),l("div",vo,[d("div",yo,[d("div",ko,[d("button",{class:"add-branch",style:B(`color: rgb(${_(E)[e.nodeConfig.type]});`),onClick:to},"添加条件 ",4),(t(!0),l(L,null,G(e.nodeConfig.conditionNodes,(s,r)=>(t(),l("div",{class:"col-box",key:r},[d("div",mo,[d("div",_o,[d("div",{class:K(["auto-judge",s.error?"error active":""])},[r!=0?(t(),l("div",{key:0,class:"sort-left",onClick:f=>w(r,-1)},"<",8,bo)):h("",!0),d("div",$o,[_(v)[r]?Q((t(),l("input",{key:0,style:{width:"50%"},type:"text",class:"ant-input editable-title-input",onBlur:f=>R(r),onFocus:c[0]||(c[0]=f=>f.currentTarget.select()),"onUpdate:modelValue":f=>s.nodeName=f},null,40,Uo)),[[k],[X,s.nodeName]]):(t(),l("span",{key:1,class:"editable-title",style:B(`color: rgb(${_(E)[e.nodeConfig.type]});`),onClick:f=>T(r)},b(s.nodeName),13,Lo)),d("span",{class:"priority-title",onClick:f=>g(s.priorityLevel)},"优先级"+b(s.priorityLevel),9,Po),d("i",{class:"anticon anticon-close close",onClick:f=>z(r)},null,8,So)]),r!=e.nodeConfig.conditionNodes.length-1?(t(),l("div",{key:1,class:"sort-right",onClick:f=>w(r)},"> ",8,Do)):h("",!0),r<e.nodeConfig.conditionNodes.length-1?(t(),l("div",{key:2,class:"content",onClick:f=>g(s.priorityLevel)},b(_(j).conditionStr(e.nodeConfig,r)),9,wo)):(t(),l("div",To,b(_(j).conditionStr(e.nodeConfig,r)),1)),s.error?(t(),l("div",Io,Oo)):h("",!0)],2),V(M,{childNodeP:s.childNode,"onUpdate:childNodeP":f=>s.childNode=f,"current-node":s},null,8,["childNodeP","onUpdate:childNodeP","current-node"])])]),s.childNode?(t(),p(F,{key:0,nodeConfig:s.childNode,"onUpdate:nodeConfig":f=>s.childNode=f},null,8,["nodeConfig","onUpdate:nodeConfig"])):h("",!0),r==0?(t(),l(L,{key:1},[Bo,Vo],64)):h("",!0),r==e.nodeConfig.conditionNodes.length-1?(t(),l(L,{key:2},[Eo,Mo],64)):h("",!0)]))),128))]),V(M,{childNodeP:e.nodeConfig.childNode,"onUpdate:childNodeP":c[1]||(c[1]=s=>e.nodeConfig.childNode=s),"current-node":e.nodeConfig},null,8,["childNodeP","current-node"])])])}}});const eo=oo(Ro,[["__scopeId","data-v-c5623240"]]),be=Object.freeze(Object.defineProperty({__proto__:null,default:eo},Symbol.toStringTag,{value:"Module"})),D=e=>(Y("data-v-8dcd83ac"),e=e(),Z(),e),zo={class:"branch-wrap"},Fo={class:"branch-box-wrap"},Wo={class:"branch-box"},Ho={class:"condition-node"},Jo={class:"condition-node-box"},qo=["onClick"],Ao={class:"title-wrapper"},Go=["onBlur","onUpdate:modelValue"],Ko=["onClick"],Qo={class:"priority-title"},Xo=["onClick"],Yo=["onClick"],Zo={class:"content"},xo={key:2,class:"error_tip"},oe=D(()=>d("i",{class:"anticon anticon-exclamation-circle"},null,-1)),ee=[oe],ne=D(()=>d("div",{class:"top-left-cover-line"},null,-1)),te=D(()=>d("div",{class:"bottom-left-cover-line"},null,-1)),de=D(()=>d("div",{class:"top-right-cover-line"},null,-1)),ie=D(()=>d("div",{class:"bottom-right-cover-line"},null,-1)),le=J({__name:"parallel",props:{nodeConfig:{type:Object,default:()=>{}}},emits:["updateData"],setup(e,{emit:P}){const o=e,{proxy:$}=O();let v=q([]);const N=i=>{P("updateData",i)},y=(i,u=1)=>{o.nodeConfig.conditionNodes[i]=o.nodeConfig.conditionNodes.splice(i+u,1,o.nodeConfig.conditionNodes[i])[0],o.nodeConfig.conditionNodes.map((m,a)=>{m.priorityLevel=a+1}),N(o.nodeConfig)},w=i=>{v.value[i]=!1,o.nodeConfig.conditionNodes[i].nodeName=o.nodeConfig.conditionNodes[i].nodeName||"条件"},R=i=>{v.value[i]=!0},T=(i,u)=>{i.childNode?T(i.childNode,u):i.childNode=u},I=i=>{o.nodeConfig.conditionNodes.splice(i,1),o.nodeConfig.conditionNodes.map((u,m)=>{u.priorityLevel=m+1,u.nodeName=`条件${m+1}`}),N(o.nodeConfig),o.nodeConfig.conditionNodes.length==1&&(o.nodeConfig.childNode&&(o.nodeConfig.conditionNodes[0].childNode?T(o.nodeConfig.conditionNodes[0].childNode,o.nodeConfig.childNode):o.nodeConfig.conditionNodes[0].childNode=o.nodeConfig.childNode),N(o.nodeConfig.conditionNodes[0].childNode))};x(),O().uid;const z=()=>{let i=o.nodeConfig.conditionNodes.length+1;o.nodeConfig.conditionNodes.push({nodeName:"分支"+i,type:3,id:$.$getRandomId(),placeHolder:"满足条件",parentId:o.nodeConfig.id,priorityLevel:i,conditionList:[{conditionList:[]}],nodeUserList:[],childNode:null}),N(o.nodeConfig)};return(i,u)=>{const m=A("focus");return t(),l("div",zo,[d("div",Fo,[d("div",Wo,[d("button",{class:"add-branch",style:B(`color: rgb(${_(E)[e.nodeConfig.type]});`),onClick:z},"添加条件 ",4),(t(!0),l(L,null,G(e.nodeConfig.conditionNodes,(a,C)=>(t(),l("div",{class:"col-box",key:C},[d("div",Ho,[d("div",Jo,[d("div",{class:K(["auto-judge",a.error?"error active":""])},[C!=0?(t(),l("div",{key:0,class:"sort-left",onClick:g=>y(C,-1)},"<",8,qo)):h("",!0),d("div",Ao,[_(v)[C]?Q((t(),l("input",{key:0,style:{width:"50%"},type:"text",class:"ant-input editable-title-input",onBlur:g=>w(C),onFocus:u[0]||(u[0]=g=>g.currentTarget.select()),"onUpdate:modelValue":g=>a.nodeName=g},null,40,Go)),[[m],[X,a.nodeName]]):(t(),l("span",{key:1,class:"editable-title",style:B(`color: rgb(${_(E)[e.nodeConfig.type]});`),onClick:g=>R(C)},b(a.nodeName),13,Ko)),d("span",Qo,"优先级"+b(a.priorityLevel),1),d("i",{class:"anticon anticon-close close",onClick:g=>I(C)},null,8,Xo)]),C!=e.nodeConfig.conditionNodes.length-1?(t(),l("div",{key:1,class:"sort-right",onClick:g=>y(C)},"> ",8,Yo)):h("",!0),d("div",Zo,b(a.placeHolder),1),a.error?(t(),l("div",xo,ee)):h("",!0)],2),V(M,{childNodeP:a.childNode,"onUpdate:childNodeP":g=>a.childNode=g,"current-node":a},null,8,["childNodeP","onUpdate:childNodeP","current-node"])])]),a.childNode?(t(),p(F,{key:0,nodeConfig:a.childNode,"onUpdate:nodeConfig":g=>a.childNode=g},null,8,["nodeConfig","onUpdate:nodeConfig"])):h("",!0),C==0?(t(),l(L,{key:1},[ne,te],64)):h("",!0),C==e.nodeConfig.conditionNodes.length-1?(t(),l(L,{key:2},[de,ie],64)):h("",!0)]))),128))]),V(M,{childNodeP:e.nodeConfig.childNode,"onUpdate:childNodeP":u[1]||(u[1]=a=>e.nodeConfig.childNode=a),"current-node":e.nodeConfig},null,8,["childNodeP","current-node"])])])}}});const no=oo(le,[["__scopeId","data-v-8dcd83ac"]]),$e=Object.freeze(Object.defineProperty({__proto__:null,default:no},Symbol.toStringTag,{value:"Module"})),ce={__name:"nodeWrap",props:{nodeConfig:{type:Object,default:()=>({})}},emits:["update:nodeConfig"],setup(e,{emit:P}){const o=$=>{P("update:nodeConfig",$)};return($,v)=>{const N=No("nodeWrap",!0);return t(),l("div",null,[e.nodeConfig.type==1?(t(),p(so,{key:0,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==0?(t(),p(ao,{key:1,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==2?(t(),p(ro,{key:2,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==6?(t(),p(fo,{key:3,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==7?(t(),p(go,{key:4,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==9?(t(),p(uo,{key:5,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==10?(t(),p(Co,{key:6,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==4||e.nodeConfig.type==8?(t(),p(eo,{key:7,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):e.nodeConfig.type==5?(t(),p(no,{key:8,onUpdateData:o,nodeConfig:e.nodeConfig},null,8,["nodeConfig"])):h("",!0),e.nodeConfig.childNode?(t(),p(N,{key:9,nodeConfig:e.nodeConfig.childNode,"onUpdate:nodeConfig":v[0]||(v[0]=y=>e.nodeConfig.childNode=y)},null,8,["nodeConfig"])):h("",!0)])}}},F=ce,Ue=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{Ue as a,be as c,F as n,$e as p};
