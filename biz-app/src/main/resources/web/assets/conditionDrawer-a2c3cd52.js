import{r as N,D as k,L as P,h as A,a as p,l as C,w as c,k as f,n as J,a5 as u,f as _,c as V,R as b,a6 as B,q as $,am as S,a3 as U,as as K,aB as Q}from"./index-e01dade3.js";import{E as W}from"./el-drawer-51597e24.js";import{E as X}from"./el-card-16bdf0d8.js";/* empty css                */import{a as Y,E as Z}from"./el-form-item-85be6a3a.js";import{E as oo}from"./el-switch-e9147eb4.js";import{$ as eo}from"./index-126d0406.js";import{u as to}from"./index-219f5c7e.js";import io from"./condition-59a2bdde.js";import{u as no}from"./flow-2349aa77.js";import{_ as ro}from"./_plugin-vue_export-helper-c27b6911.js";import"./el-dialog-1471a1af.js";import"./refs-dd65b3fd.js";import"./_baseClone-59dac119.js";import"./_Uint8Array-aeb50f83.js";import"./el-time-picker-1aa4e9cb.js";import"./panel-time-pick-cbec15ad.js";import"./el-popper-ee5283d6.js";import"./isEqual-47390e81.js";import"./el-scrollbar-f2029ad1.js";import"./index-f7c59abe.js";import"./debounce-bf37b7f7.js";import"./_baseFlatten-6e5398bc.js";import"./isArrayLikeObject-a5301880.js";import"./_overRest-a79e0547.js";import"./el-date-picker-b8fb5128.js";import"./flatten-178b99bc.js";import"./index-6b517de5.js";import"./el-input-number-182b17d2.js";import"./el-tag-929563f7.js";import"./el-select-c154265f.js";import"./strings-6464b592.js";import"./selectAndShow.vue_vue_type_script_setup_true_lang-a708354f.js";import"./employeesDialog-3166dde1.js";import"./selectBox-a8819872.js";import"./el-avatar-63a3488d.js";import"./el-checkbox-123bf6dd.js";/* empty css                */import"./index-8f0c79b2.js";import"./selectResult-ca10c7f8.js";import"./orgItem-da1d9713.js";const lo=["id"],so={class:"card-header"},ao={style:{display:"flex","flex-direction":"row","justify-content":"space-between"}},co={__name:"conditionDrawer",setup(po){let r=N({conditionNodes:[]}),l=N({}),x=N(""),g=to(),{setCondition:F,setConditionsConfig:I}=g,E=k(()=>g.conditionsConfig1),O=k(()=>g.conditionDrawer),y=k({get(){return O.value},set(){D()}});const T=o=>{var e;(e=l.value)==null||e.conditionList.splice(o,1)},z=(o,e)=>{var t;(t=l.value)==null||t.conditionList[o].conditionList.splice(e,1)},G=()=>{var o;(o=l.value)==null||o.conditionList.push({mode:!0,conditionList:[{}]})},M=(o,e)=>{let t=o.conditionList;t||(t=[]),t.push({}),o.conditionList=t};let R=no();const j=k(()=>R.step2),q=()=>{};P(E,o=>{let e=o.value.conditionNodes;for(var t of e){let n=t.conditionList;for(var m of n){let d=m.conditionList;for(var s of d){let L=s.key;if(L==="root")s.keyType="SelectUser";else{let i=j.value.filter(a=>a.id===L);i.length>0&&(s.keyType=i[0].type)}}}}r.value=o.value,x.value=o.priorityLevel,l.value=o.priorityLevel?r.value.conditionNodes[o.priorityLevel-1]:{nodeUserList:[],conditionList:[]}});const{proxy:h}=A(),H=()=>{D();var o=r.value.conditionNodes.splice(x.value-1,1);r.value.conditionNodes.splice(l.value.priorityLevel-1,0,o[0]),r.value.conditionNodes.map((n,d)=>{n.priorityLevel=d+1});for(var e=0;e<r.value.conditionNodes.length;e++){let n=r.value.conditionNodes[e];n.error=!1;let d=n.conditionList;if(e!=r.value.conditionNodes.length-1){var t=d.length==0;for(var m of d){t=m.conditionList.length==0;for(var s of m.conditionList)if(h.$isBlank(s.key)||h.$isBlank(s.expression)||h.$isBlank(s.value)){t=!0;break}}n.error=t}n.placeHolder=eo.conditionStr(r.value,e)}I({value:r.value,flag:!0,id:E.value.id})},D=o=>{F(!1)};return(o,e)=>{const t=oo,m=Y,s=Z,n=Q,d=X,L=W;return p(),C(L,{"append-to-body":!0,title:"条件设置",modelValue:_(y),"onUpdate:modelValue":e[1]||(e[1]=i=>K(y)?y.value=i:y=i),"show-close":!1,size:550,onOpen:q,"before-close":H},{header:c(({titleId:i,titleClass:a})=>[f("h3",{id:i,class:J(a)},"条件设置",10,lo)]),default:c(()=>[u(s,{"label-width":"120px"},{default:c(()=>[u(m,{label:"条件组关系"},{default:c(()=>[u(t,{modelValue:_(l).groupMode,"onUpdate:modelValue":e[0]||(e[0]=i=>_(l).groupMode=i),"active-text":"且","inactive-text":"或"},null,8,["modelValue"])]),_:1})]),_:1}),(p(!0),V(b,null,B(_(l).conditionList,(i,a)=>(p(),C(d,{class:"box-card",key:a,style:{"margin-bottom":"20px"}},{header:c(()=>[f("div",so,[f("span",null,"条件组"+$(a+1),1),u(t,{modelValue:i.mode,"onUpdate:modelValue":v=>i.mode=v,"active-text":"且","inactive-text":"或"},null,8,["modelValue","onUpdate:modelValue"]),_(l).conditionList.length>1?(p(),C(n,{key:0,text:"",onClick:v=>T(a),icon:o.$icon.Delete},null,8,["onClick","icon"])):S("",!0)])]),default:c(()=>[(p(!0),V(b,null,B(i.conditionList,(v,w)=>(p(),V("div",{key:w},[f("div",ao,[f("div",null,$(w==0?"当":i.mode?"且":"或"),1),f("div",null,[i.conditionList.length>1?(p(),C(n,{key:0,text:"",onClick:uo=>z(a,w),icon:o.$icon.Delete},null,8,["onClick","icon"])):S("",!0)])]),u(io,{condition:v},null,8,["condition"])]))),128)),u(n,{dark:"",type:"success",style:{"margin-top":"20px"},onClick:v=>M(i,a)},{default:c(()=>[U("添加条件")]),_:2},1032,["onClick"])]),_:2},1024))),128)),u(n,{dark:"",type:"primary",onClick:G},{default:c(()=>[U("添加条件组")]),_:1})]),_:1},8,["modelValue"])}}},oe=ro(co,[["__scopeId","data-v-4e9c1a4f"]]);export{oe as default};
