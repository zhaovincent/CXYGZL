import{D as f,r as g,L as P,a as _,l as q,w as c,a5 as d,a3 as V,k as D,P as F,as as b,f as l,cA as M,c as h,R as S,a6 as j,q as z,am as G,aB as H}from"./index-e01dade3.js";import{E as J}from"./el-dialog-1471a1af.js";import{E as K,a as O}from"./el-tab-pane-5b128a44.js";import{r as Q,d as k,g as v,s as u,b as W,a as X,c as Y}from"./selectBox-a8819872.js";import Z from"./selectResult-ca10c7f8.js";import{$ as s}from"./index-126d0406.js";import"./refs-dd65b3fd.js";import"./strings-6464b592.js";import"./el-avatar-63a3488d.js";import"./el-checkbox-123bf6dd.js";import"./isEqual-47390e81.js";import"./_Uint8Array-aeb50f83.js";import"./flatten-178b99bc.js";import"./_baseFlatten-6e5398bc.js";import"./_overRest-a79e0547.js";/* empty css                */import"./index-8f0c79b2.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./flow-2349aa77.js";const ee={class:"person_body clear"},te={class:"person_tree l"},ae={key:0,class:"ellipsis tree_nav"},le=["onClick"],Ne={__name:"employeesRoleDialog",props:{visible:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},isDepartment:{type:Boolean,default:!1}},emits:["update:visible","change"],setup(E,{emit:C}){const m=E;let y=f({get(){return m.visible},set(){A()}}),r=g([]),n=g([]),i=g([]),o=g("1"),L=f(()=>o.value==="2"?[{type:"role",not:!1,data:Q.value,isActiveItem:t=>s.toggleClass(r.value,t,"roleId"),change:t=>s.toChecked(r.value,t,"roleId")}]:[{isDepartment:m.isDepartment,type:"department",data:k.value.childDepartments,isActive:t=>s.toggleClass(i.value,t),change:t=>s.toChecked(i.value,t),next:t=>v(t.id)},{type:"employee",data:k.value.employees,isActive:t=>s.toggleClass(n.value,t),change:t=>s.toChecked(n.value,t)}]),x=f(()=>{let t=[{type:"role",data:r.value,cancel:e=>s.removeEle(r.value,e,"roleId")},{type:"employee",data:n.value,cancel:e=>s.removeEle(n.value,e)}];return m.isDepartment&&t.splice(1,0,{type:"department",data:i.value,cancel:e=>s.removeEle(i.value,e)}),t});P(()=>m.visible,t=>{t&&(o.value="1",v(),u.value="",n.value=m.data.filter(e=>e.type===1).map(({name:e,targetId:p})=>({employeeName:e,id:p})),r.value=m.data.filter(e=>e.type===2).map(({name:e,targetId:p})=>({roleName:e,roleId:p})),i.value=m.data.filter(e=>e.type===3).map(({name:e,targetId:p})=>({departmentName:e,id:p})))});let B=f(()=>n.value.length+r.value.length+i.value.length);const I=()=>{u.value="",o.value==="1"?v():Y()},R=()=>{let t=[...r.value,...n.value,...i.value].map(e=>({type:e.employeeName?1:e.roleName?2:3,targetId:e.id||e.roleId,name:e.employeeName||e.roleName||e.departmentName}));C("change",t)},w=()=>{n.value=[],r.value=[],i.value=[]},A=()=>{C("update:visible",!1)};return(t,e)=>{const p=K,T=O,N=H,$=J;return _(),q($,{title:"选择成员",modelValue:l(y),"onUpdate:modelValue":e[5]||(e[5]=a=>b(y)?y.value=a:y=a),width:600,"append-to-body":"",class:"promoter_person"},{footer:c(()=>[d(N,{onClick:e[4]||(e[4]=a=>t.$emit("update:visible",!1))},{default:c(()=>[V("取 消")]),_:1}),d(N,{type:"primary",onClick:R},{default:c(()=>[V("确 定")]),_:1})]),default:c(()=>[D("div",ee,[D("div",te,[F(D("input",{type:"text",placeholder:"搜索成员","onUpdate:modelValue":e[0]||(e[0]=a=>b(u)?u.value=a:null),onInput:e[1]||(e[1]=a=>l(W)(a,l(o)))},null,544),[[M,l(u)]]),d(T,{modelValue:l(o),"onUpdate:modelValue":e[2]||(e[2]=a=>b(o)?o.value=a:o=a),onTabChange:I},{default:c(()=>[d(p,{label:"组织架构",name:"1"}),d(p,{label:"角色列表",name:"2"})]),_:1},8,["modelValue"]),l(o)==="1"&&!l(u)?(_(),h("p",ae,[D("span",{onClick:e[3]||(e[3]=a=>l(v)(0)),class:"ellipsis"},"天下"),(_(!0),h(S,null,j(l(k).titleDepartments,(a,U)=>(_(),h("span",{class:"ellipsis",key:U+"a",onClick:oe=>l(v)(a.id)},z(a.departmentName),9,le))),128))])):G("",!0),d(X,{list:l(L),style:{height:"360px"}},null,8,["list"])]),d(Z,{total:l(B),onDel:w,list:l(x)},null,8,["total","list"])])]),_:1},8,["modelValue"])}}};export{Ne as default};
