import{d as $,h,r as B,o as V,D as d,L as y,ck as E,a as r,c as l,k as s,au as F,f as i,P as L,cl as O,q as N,am as z,n as J,a5 as M,ag as j,ah as q}from"./index-d5547550.js";import{u as H}from"./flow-165b4256.js";import{p as G,b as K}from"./const-a11e1fef.js";import Q from"./addNode-8159b811.js";import{$ as k}from"./index-a7c7b111.js";import{u as R}from"./index-71f0fd6b.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import"./el-popper-00977718.js";import"./el-popover-07a17928.js";import"./dropdown-b09318e3.js";const b=o=>(j("data-v-ddd095b4"),o=o(),q(),o),X={class:"node-wrap"},Y=["placeholder"],Z={class:"text"},ee=b(()=>s("i",{class:"anticon anticon-right arrow"},null,-1)),oe={key:0,class:"error_tip"},te=b(()=>s("i",{class:"anticon anticon-exclamation-circle"},null,-1)),ne=[te],ae=$({__name:"approval",props:{nodeConfig:{type:Object,default:()=>{}}},emits:["updateData"],setup(o,{emit:S}){const t=o;h();let c=B(!1);V(()=>{t.nodeConfig.error=!k.checkApproval(t.nodeConfig)});let x=H();const D=d(()=>x.step2);y(()=>D.value,n=>{let e=t.nodeConfig;if(e.type==1&&e.assignedType==8){let p=e.formUserId;n.filter(a=>a.id===p).length==0&&(e.formUserId="",e.formUserName="",e.error=!0)}});const w=()=>{c.value=!1,t.nodeConfig.nodeName=t.nodeConfig.nodeName||f};let f=d(()=>G[t.nodeConfig.type]);var g=d(()=>k.setApproverStr(t.nodeConfig));const I=()=>{c.value=!0},m=n=>{S("updateData",n)},_=()=>{m(t.nodeConfig.childNode)};let C=R(),{setApprover:T,setApproverConfig:U}=C,v=h().uid,A=d(()=>C.approverConfigData);y(A,n=>{n.flag&&n.id===v&&m(n.value)});const P=()=>{T(!0),U({value:{...JSON.parse(JSON.stringify(t.nodeConfig)),assignedType:t.nodeConfig.assignedType?t.nodeConfig.assignedType:1,multiple:!1},flag:!1,id:v})};return(n,e)=>{var u;const p=E("focus");return r(),l("div",X,[s("div",{class:J(["node-wrap-box",(o.nodeConfig.type==0?"start-node ":"")+(o.nodeConfig.error?"active error":"")])},[s("div",{class:"title",style:F(`background: rgb(${i(K)[o.nodeConfig.type]});`)},[i(c)?L((r(),l("input",{key:0,type:"text",class:"ant-input editable-title-input",onBlur:e[0]||(e[0]=a=>w()),onFocus:e[1]||(e[1]=a=>a.currentTarget.select()),"onUpdate:modelValue":e[2]||(e[2]=a=>o.nodeConfig.nodeName=a),placeholder:i(f)},null,40,Y)),[[p],[O,o.nodeConfig.nodeName]]):(r(),l("span",{key:1,class:"editable-title",onClick:e[3]||(e[3]=a=>I())},N(o.nodeConfig.nodeName),1)),s("i",{class:"anticon anticon-close close",onClick:_})],4),s("div",{class:"content",onClick:P},[s("div",Z,N(((u=i(g))==null?void 0:u.length)>0?i(g):"请选择"+i(f)),1),ee]),o.nodeConfig.error?(r(),l("div",oe,ne)):z("",!0)],2),M(Q,{"current-node":o.nodeConfig,childNodeP:o.nodeConfig.childNode,"onUpdate:childNodeP":e[4]||(e[4]=a=>o.nodeConfig.childNode=a)},null,8,["current-node","childNodeP"])])}}});const me=W(ae,[["__scopeId","data-v-ddd095b4"]]);export{me as default};
