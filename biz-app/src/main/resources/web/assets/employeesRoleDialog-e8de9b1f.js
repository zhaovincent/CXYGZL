import{D as y,r as g,L as P,a as _,l as q,w as c,a5 as d,a3 as V,k as D,P as F,as as b,f as l,cl as M,c as h,R as S,a6 as j,q as z,am as G,aD as H}from"./index-d5547550.js";/* empty css                  */import{E as J,a as K}from"./el-tab-pane-a6cb13f9.js";import O from"./selectBox-26a3a753.js";import Q from"./selectResult-4abbf083.js";import{$ as s}from"./index-a7c7b111.js";import{r as W,d as k,a as v,s as u,g as X,b as Y}from"./selectBox.vue_vue_type_style_index_0_scoped_82c14c6c_lang-f1c14f73.js";import{E as Z}from"./index-a6355ec2.js";import"./strings-fbdcd853.js";/* empty css                  *//* empty css                    *//* empty css                */import"./_plugin-vue_export-helper-c27b6911.js";import"./index-222e6800.js";import"./isEqual-fe47b28a.js";import"./_Uint8Array-c7447712.js";import"./flatten-36990bb8.js";import"./_baseFlatten-c80c9ba3.js";import"./_overRest-d3d6b67b.js";import"./index-85bc974f.js";import"./flow-165b4256.js";import"./const-a11e1fef.js";/* empty css                                                                     */import"./use-dialog-27a1e524.js";import"./refs-5fd04da2.js";const ee={class:"person_body clear"},te={class:"person_tree l"},ae={key:0,class:"ellipsis tree_nav"},le=["onClick"],Ie={__name:"employeesRoleDialog",props:{visible:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},isDepartment:{type:Boolean,default:!1}},emits:["update:visible","change"],setup(E,{emit:C}){const m=E;let f=y({get(){return m.visible},set(){T()}}),r=g([]),i=g([]),n=g([]),o=g("1"),L=y(()=>o.value==="2"?[{type:"role",not:!1,data:W.value,isActiveItem:t=>s.toggleClass(r.value,t,"roleId"),change:t=>s.toChecked(r.value,t,"roleId")}]:[{isDepartment:m.isDepartment,type:"department",data:k.value.childDepartments,isActive:t=>s.toggleClass(n.value,t),change:t=>s.toChecked(n.value,t),next:t=>v(t.id)},{type:"employee",data:k.value.employees,isActive:t=>s.toggleClass(i.value,t),change:t=>s.toChecked(i.value,t)}]),x=y(()=>{let t=[{type:"role",data:r.value,cancel:e=>s.removeEle(r.value,e,"roleId")},{type:"employee",data:i.value,cancel:e=>s.removeEle(i.value,e)}];return m.isDepartment&&t.splice(1,0,{type:"department",data:n.value,cancel:e=>s.removeEle(n.value,e)}),t});P(()=>m.visible,t=>{t&&(o.value="1",v(),u.value="",i.value=m.data.filter(e=>e.type===1).map(({name:e,targetId:p})=>({employeeName:e,id:p})),r.value=m.data.filter(e=>e.type===2).map(({name:e,targetId:p})=>({roleName:e,roleId:p})),n.value=m.data.filter(e=>e.type===3).map(({name:e,targetId:p})=>({departmentName:e,id:p})))});let B=y(()=>i.value.length+r.value.length+n.value.length);const I=()=>{u.value="",o.value==="1"?v():Y()},R=()=>{let t=[...r.value,...i.value,...n.value].map(e=>({type:e.employeeName?1:e.roleName?2:3,targetId:e.id||e.roleId,name:e.employeeName||e.roleName||e.departmentName}));C("change",t)},w=()=>{i.value=[],r.value=[],n.value=[]},T=()=>{C("update:visible",!1)};return(t,e)=>{const p=J,A=K,N=H,$=Z;return _(),q($,{title:"选择成员",modelValue:l(f),"onUpdate:modelValue":e[5]||(e[5]=a=>b(f)?f.value=a:f=a),width:600,"append-to-body":"",class:"promoter_person"},{footer:c(()=>[d(N,{onClick:e[4]||(e[4]=a=>t.$emit("update:visible",!1))},{default:c(()=>[V("取 消")]),_:1}),d(N,{type:"primary",onClick:R},{default:c(()=>[V("确 定")]),_:1})]),default:c(()=>[D("div",ee,[D("div",te,[F(D("input",{type:"text",placeholder:"搜索成员","onUpdate:modelValue":e[0]||(e[0]=a=>b(u)?u.value=a:null),onInput:e[1]||(e[1]=a=>l(X)(a,l(o)))},null,544),[[M,l(u)]]),d(A,{modelValue:l(o),"onUpdate:modelValue":e[2]||(e[2]=a=>b(o)?o.value=a:o=a),onTabChange:I},{default:c(()=>[d(p,{label:"组织架构",name:"1"}),d(p,{label:"角色列表",name:"2"})]),_:1},8,["modelValue"]),l(o)==="1"&&!l(u)?(_(),h("p",ae,[D("span",{onClick:e[3]||(e[3]=a=>l(v)(0)),class:"ellipsis"},"天下"),(_(!0),h(S,null,j(l(k).titleDepartments,(a,U)=>(_(),h("span",{class:"ellipsis",key:U+"a",onClick:oe=>l(v)(a.id)},z(a.departmentName),9,le))),128))])):G("",!0),d(O,{list:l(L),style:{height:"360px"}},null,8,["list"])]),d(Q,{total:l(B),onDel:w,list:l(x)},null,8,["total","list"])])]),_:1},8,["modelValue"])}}};export{Ie as default};
