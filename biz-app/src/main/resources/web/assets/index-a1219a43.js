import{d as re,r as V,K as k,o as ie,ck as de,a as i,c as pe,k as R,a5 as a,w as l,f as t,aA as se,a3 as r,P as w,l as d,q as ue,am as m,ae as O,bs as me,ez as _e,eA as fe,eB as ce,a7 as E,eC as ye,an as be,eD as ve,aC as ge,aD as he}from"./index-d5547550.js";import{v as Ve}from"./el-loading-7d43f325.js";/* empty css                  */import{E as ke}from"./el-input-number-f4eeab94.js";/* empty css                       */import{E as we,a as Ee}from"./el-radio-92787871.js";import{E as Te}from"./el-tag-de6752b8.js";import"./el-select-46753b34.js";import"./el-scrollbar-cbe0c54f.js";import"./el-popper-00977718.js";import"./el-tree-75cc66b1.js";/* empty css                    */import{E as Ce}from"./el-tree-select-35aec998.js";import{E as Ue}from"./el-card-39a9c0d0.js";import{E as Ne,a as Me}from"./el-table-column-ec0cff67.js";import"./el-tooltip-4ed993c7.js";import{_ as Ae,a as Ie,b as Oe}from"./search-f5308daa.js";import{_ as Be}from"./edit-ce3642cb.js";import{_ as xe}from"./plus-bafa12a0.js";/* empty css                */import{E as B,a as Le}from"./el-form-item-2de9c3c8.js";import{S as De}from"./index-f9f36d5d.js";import{I as Fe}from"./index-68574a33.js";import{E as qe}from"./index-a6355ec2.js";import"./index-da53d962.js";import"./strings-fbdcd853.js";import"./isEqual-fe47b28a.js";import"./_Uint8Array-c7447712.js";import"./debounce-e2bc871f.js";import"./index-e8e7f773.js";import"./index-01b2a18b.js";import"./index-222e6800.js";import"./flatten-36990bb8.js";import"./_baseFlatten-c80c9ba3.js";import"./_overRest-d3d6b67b.js";import"./_baseClone-e7eb389f.js";import"./isArrayLikeObject-724a27ce.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./el-popover-07a17928.js";import"./dropdown-b09318e3.js";import"./el-divider-6edec4d7.js";import"./caret-bottom-6bbb3c8c.js";import"./use-dialog-27a1e524.js";import"./refs-5fd04da2.js";var s=(v=>(v.CATALOG="CATALOG",v.MENU="MENU",v.BUTTON="BUTTON",v.EXTLINK="EXTLINK",v))(s||{});const Ge={class:"app-container"},Ke={class:"search"},Re={class:"dialog-footer"},Ot=re({name:"Menu",inheritAttrs:!1,__name:"index",setup(v){const x=V(B),T=V(B),A=V(!1),y=k({visible:!1}),C=k({}),L=V([]),D=V([]),e=k({parentId:void 0,visible:1,sort:1,type:s.MENU}),z=k({parentId:[{required:!0,message:"请选择父级菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],type:[{required:!0,message:"请选择菜单类型",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件完整路径",trigger:"blur"}]}),S=V(),U=k({type:"",path:""});function b(){A.value=!0,_e(C).then(({data:_})=>{L.value=_}).then(()=>{A.value=!1})}function X(){x.value.resetFields(),b()}function P(_){S.value=_.id}function I(_,n,u){fe().then(({data:p})=>{D.value=[{id:0,name:"顶级菜单",children:p}]}).then(()=>{y.visible=!0,n?(y.title="编辑菜单",Object.assign(e,u),U.type=u.type,U.path=u.path??""):(y.title="新增菜单",e.id=void 0,e.visible=1,e.sort=1,e.type="MENU",e.perm=void 0,e.name=void 0,e.component=void 0,e.path=void 0,e.parentId=_)})}function $(){e.type!==U.type?e.path="":e.path=U.path}function Q(){T.value.validate(_=>{if(_){const n=e.id;n?ce(n,e).then(()=>{E.success("修改成功"),N(),b()}):ye(e).then(()=>{E.success("新增成功"),N(),b()})}})}function j(_){if(!_)return E.warning("请勾选删除项"),!1;be.confirm("确认删除已选中的数据项?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ve(_).then(()=>{E.success("删除成功"),b()})}).catch(()=>E.info("已取消删除"))}function N(){y.visible=!1,H()}function H(){T.value.resetFields(),T.value.clearValidate(),e.id=void 0,e.parentId=void 0,e.visible=1,e.sort=1,e.perm=void 0,e.component=void 0,e.path=void 0}return ie(()=>{b()}),(_,n)=>{const u=ge,p=Le,J=Ae,f=he,W=Ie,F=B,q=xe,c=Ne,g=Te,Y=Be,Z=Oe,ee=Me,te=Ue,le=Ce,h=we,G=Ee,oe=ke,ae=qe,M=de("hasPerm"),ne=Ve;return i(),pe("div",Ge,[R("div",Ke,[a(F,{ref_key:"queryFormRef",ref:x,model:t(C),inline:!0},{default:l(()=>[a(p,{label:"关键字",prop:"keywords"},{default:l(()=>[a(u,{modelValue:t(C).keywords,"onUpdate:modelValue":n[0]||(n[0]=o=>t(C).keywords=o),placeholder:"菜单名称",clearable:"",onKeyup:se(b,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),a(p,null,{default:l(()=>[a(f,{type:"primary",onClick:b},{icon:l(()=>[a(J)]),default:l(()=>[r(" 搜索 ")]),_:1}),a(f,{onClick:X},{icon:l(()=>[a(W)]),default:l(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),a(te,{shadow:"never",size:"small"},{header:l(()=>[w((i(),d(f,{type:"success",onClick:n[1]||(n[1]=o=>I(0))},{icon:l(()=>[a(q)]),default:l(()=>[r(" 新增 ")]),_:1})),[[M,["sys:menu:add"]]])]),default:l(()=>[w((i(),d(ee,{data:t(L),"highlight-current-row":"","tree-props":{children:"children",hasChildren:"hasChildren"},"row-key":"id","default-expand-all":"",border:"",size:"small",onRowClick:P},{default:l(()=>[a(c,{label:"菜单名称","min-width":"200"},{default:l(o=>[a(De,{"icon-class":o.row.type===t(s).BUTTON?"button":o.row.icon},null,8,["icon-class"]),r(" "+ue(o.row.name),1)]),_:1}),a(c,{label:"类型",align:"center",width:"80"},{default:l(o=>[o.row.type===t(s).CATALOG?(i(),d(g,{key:0,type:"warning"},{default:l(()=>[r("目录 ")]),_:1})):m("",!0),o.row.type===t(s).MENU?(i(),d(g,{key:1,type:"success"},{default:l(()=>[r("菜单 ")]),_:1})):m("",!0),o.row.type===t(s).BUTTON?(i(),d(g,{key:2,type:"danger"},{default:l(()=>[r("按钮 ")]),_:1})):m("",!0),o.row.type===t(s).EXTLINK?(i(),d(g,{key:3,type:"info"},{default:l(()=>[r("外链 ")]),_:1})):m("",!0)]),_:1}),a(c,{label:"路由路径",align:"left",width:"150",prop:"path"}),a(c,{label:"组件路径",align:"left",width:"250",prop:"component"}),a(c,{label:"权限标识",align:"center",width:"200",prop:"perm"}),a(c,{label:"状态",align:"center",width:"80"},{default:l(o=>[o.row.visible===1?(i(),d(g,{key:0,type:"success"},{default:l(()=>[r("显示")]),_:1})):(i(),d(g,{key:1,type:"info"},{default:l(()=>[r("隐藏")]),_:1}))]),_:1}),a(c,{label:"排序",align:"center",width:"80",prop:"sort"}),a(c,{fixed:"right",align:"center",label:"操作",width:"220"},{default:l(o=>[o.row.type=="CATALOG"||o.row.type=="MENU"?w((i(),d(f,{key:0,type:"primary",link:"",size:"small",onClick:O(K=>I(o.row.id),["stop"])},{default:l(()=>[a(q),r(" 新增 ")]),_:2},1032,["onClick"])),[[M,["sys:menu:add"]]]):m("",!0),w((i(),d(f,{type:"primary",link:"",size:"small",onClick:O(K=>I(void 0,o.row.id,o.row),["stop"])},{default:l(()=>[a(Y),r(" 编辑 ")]),_:2},1032,["onClick"])),[[M,["sys:menu:edit"]]]),w((i(),d(f,{type:"primary",link:"",size:"small",onClick:O(K=>j(o.row.id),["stop"])},{default:l(()=>[a(Z),r(" 删除 ")]),_:2},1032,["onClick"])),[[M,["sys:menu:delete"]]])]),_:1})]),_:1},8,["data"])),[[ne,t(A)]])]),_:1}),a(ae,{modelValue:t(y).visible,"onUpdate:modelValue":n[14]||(n[14]=o=>t(y).visible=o),title:t(y).title,"destroy-on-close":"","append-to-body":"",width:"750px",onClose:N},{footer:l(()=>[R("div",Re,[a(f,{type:"primary",onClick:Q},{default:l(()=>[r("确 定")]),_:1}),a(f,{onClick:N},{default:l(()=>[r("取 消")]),_:1})])]),default:l(()=>[a(F,{ref_key:"menuFormRef",ref:T,model:t(e),rules:t(z),"label-width":"100px"},{default:l(()=>[a(p,{label:"父级菜单",prop:"parentId"},{default:l(()=>[a(le,{modelValue:t(e).parentId,"onUpdate:modelValue":n[2]||(n[2]=o=>t(e).parentId=o),placeholder:"选择上级菜单",data:t(D),filterable:"",props:{label:"name",value:"id"},"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])]),_:1}),a(p,{label:"菜单名称",prop:"name"},{default:l(()=>[a(u,{modelValue:t(e).name,"onUpdate:modelValue":n[3]||(n[3]=o=>t(e).name=o),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"菜单类型",prop:"type"},{default:l(()=>[a(G,{modelValue:t(e).type,"onUpdate:modelValue":n[4]||(n[4]=o=>t(e).type=o),onChange:$},{default:l(()=>[a(h,{label:"CATALOG"},{default:l(()=>[r("目录")]),_:1}),a(h,{label:"MENU"},{default:l(()=>[r("菜单")]),_:1}),a(h,{label:"BUTTON"},{default:l(()=>[r("按钮")]),_:1}),a(h,{label:"EXTLINK"},{default:l(()=>[r("外链")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(e).type=="EXTLINK"?(i(),d(p,{key:0,label:"外链地址",prop:"path"},{default:l(()=>[a(u,{modelValue:t(e).path,"onUpdate:modelValue":n[5]||(n[5]=o=>t(e).path=o),placeholder:"请输入外链完整路径"},null,8,["modelValue"])]),_:1})):m("",!0),t(e).type==t(s).CATALOG||t(e).type==t(s).MENU?(i(),d(p,{key:1,label:"路由路径",prop:"path"},{default:l(()=>[t(e).type==t(s).CATALOG?(i(),d(u,{key:0,modelValue:t(e).path,"onUpdate:modelValue":n[6]||(n[6]=o=>t(e).path=o),placeholder:"system"},null,8,["modelValue"])):(i(),d(u,{key:1,modelValue:t(e).path,"onUpdate:modelValue":n[7]||(n[7]=o=>t(e).path=o),placeholder:"user"},null,8,["modelValue"]))]),_:1})):m("",!0),t(e).type==t(s).MENU?(i(),d(p,{key:2,label:"页面路径",prop:"component"},{default:l(()=>[a(u,{modelValue:t(e).component,"onUpdate:modelValue":n[8]||(n[8]=o=>t(e).component=o),placeholder:"system/user/index",style:{width:"95%"}},me({_:2},[t(e).type==t(s).MENU?{name:"prepend",fn:l(()=>[r("src/views/ ")]),key:"0"}:void 0,t(e).type==t(s).MENU?{name:"append",fn:l(()=>[r(".vue ")]),key:"1"}:void 0]),1032,["modelValue"])]),_:1})):m("",!0),t(e).type=="BUTTON"?(i(),d(p,{key:3,label:"权限标识",prop:"perm"},{default:l(()=>[a(u,{modelValue:t(e).perm,"onUpdate:modelValue":n[9]||(n[9]=o=>t(e).perm=o),placeholder:"sys:user:add"},null,8,["modelValue"])]),_:1})):m("",!0),t(e).type!=="BUTTON"?(i(),d(p,{key:4,label:"图标",prop:"icon"},{default:l(()=>[a(Fe,{modelValue:t(e).icon,"onUpdate:modelValue":n[10]||(n[10]=o=>t(e).icon=o)},null,8,["modelValue"])]),_:1})):m("",!0),t(e).type==t(s).CATALOG?(i(),d(p,{key:5,label:"跳转路由"},{default:l(()=>[a(u,{modelValue:t(e).redirect,"onUpdate:modelValue":n[11]||(n[11]=o=>t(e).redirect=o),placeholder:"跳转路由"},null,8,["modelValue"])]),_:1})):m("",!0),t(e).type!=="BUTTON"?(i(),d(p,{key:6,label:"状态"},{default:l(()=>[a(G,{modelValue:t(e).visible,"onUpdate:modelValue":n[12]||(n[12]=o=>t(e).visible=o)},{default:l(()=>[a(h,{label:1},{default:l(()=>[r("显示")]),_:1}),a(h,{label:0},{default:l(()=>[r("隐藏")]),_:1})]),_:1},8,["modelValue"])]),_:1})):m("",!0),a(p,{label:"排序",prop:"sort"},{default:l(()=>[a(oe,{modelValue:t(e).sort,"onUpdate:modelValue":n[13]||(n[13]=o=>t(e).sort=o),style:{width:"100px"},"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ot as default};
