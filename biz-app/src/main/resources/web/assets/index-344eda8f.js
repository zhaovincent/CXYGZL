import{d as z,aj as F,ab as N,r as d,h as R,o as k,af as V,a as T,c as U,a5 as t,w as u,k as r,q as b,f as a,ay as q,ae as j,a3 as A,az as O,aA as D,aB as M}from"./index-e01dade3.js";/* empty css                */import"./el-tooltip-4ed993c7.js";import{E as P}from"./el-popper-ee5283d6.js";import{E as B,a as Q}from"./el-form-item-85be6a3a.js";import{_ as L}from"./index.vue_vue_type_script_setup_true_lang-30f39473.js";import{S as h}from"./index-feab0d37.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import"./_baseClone-59dac119.js";import"./_Uint8Array-aeb50f83.js";import"./el-scrollbar-f2029ad1.js";import"./dropdown-b5481c97.js";import"./refs-dd65b3fd.js";const G={class:"login-container"},H={class:"flex text-white items-center py-4"},J={class:"text-2xl flex-1 text-center"},W={class:"p-2 text-white"},X={class:"p-2 text-white"},Y={class:"p-2 text-white"},ee={class:"captcha"},oe=["src"],te=z({__name:"index",setup(se){const g=F(),v=N(),f=d(!1),w=d(!1),m=d(!1),C=d(),x=d(B),n=d({phone:"18755289564",password:"123456"}),E={phone:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur",validator:K}],verifyCode:[{required:!0,trigger:"blur"}]};function K(o,e,s){e.length<6?s(new Error("The password can not be less than 6 digits")):s()}function $(o){const{key:e}=o;w.value=e&&e.length===1&&e>="A"&&e<="Z"}function _(){O().then(({data:o})=>{const{verifyCodeBase64:e,verifyCodeKey:s}=o;n.value.verifyCodeKey=s,C.value=e})}const{proxy:I}=R();k(()=>{const o=v.query,e=o.redirect??"/",s=o.token??"";I.$isNotBlank(s)&&(console.log("-------------"),f.value=!0,g.loginByToken(s).then(()=>{const i=Object.keys(o).reduce((c,l)=>(l!=="redirect"&&(c[l]=o[l]),c),{});V.push({path:e,query:i})}).catch(()=>{_()}).finally(()=>{f.value=!1}))});function y(){x.value.validate(o=>{o&&(f.value=!0,g.login(n.value).then(()=>{const e=v.query,s=e.redirect??"/",i=Object.keys(e).reduce((c,l)=>(l!=="redirect"&&(c[l]=e[l]),c),{});V.push({path:s,query:i})}).catch(()=>{_()}).finally(()=>{f.value=!1}))})}return k(()=>{_()}),(o,e)=>{const s=D,i=Q,c=P,l=M,S=B;return T(),U("div",G,[t(S,{ref_key:"loginFormRef",ref:x,model:a(n),rules:E,class:"login-form"},{default:u(()=>[r("div",H,[r("span",J,b(o.$t("login.title")),1),t(L,{class:"text-white! cursor-pointer"})]),t(i,{prop:"phone"},{default:u(()=>[r("div",W,[t(h,{"icon-class":"user"})]),t(s,{ref:"phone",modelValue:a(n).phone,"onUpdate:modelValue":e[0]||(e[0]=p=>a(n).phone=p),class:"flex-1",size:"large",placeholder:o.$t("login.phone"),name:"phone"},null,8,["modelValue","placeholder"])]),_:1}),t(c,{disabled:a(w)===!1,content:"Caps lock is On",placement:"right"},{default:u(()=>[t(i,{prop:"password"},{default:u(()=>[r("span",X,[t(h,{"icon-class":"password"})]),t(s,{modelValue:a(n).password,"onUpdate:modelValue":e[1]||(e[1]=p=>a(n).password=p),class:"flex-1",placeholder:"密码",type:a(m)===!1?"password":"input",size:"large",name:"password",onKeyup:[$,q(y,["enter"])]},null,8,["modelValue","type","onKeyup"]),r("span",{class:"mr-2",onClick:e[2]||(e[2]=p=>m.value=!a(m))},[t(h,{"icon-class":a(m)===!1?"eye":"eye-open",class:"text-white cursor-pointer"},null,8,["icon-class"])])]),_:1})]),_:1},8,["disabled"]),t(i,{prop:"verifyCode"},{default:u(()=>[r("span",Y,[t(h,{"icon-class":"verify_code"})]),t(s,{modelValue:a(n).verifyCode,"onUpdate:modelValue":e[3]||(e[3]=p=>a(n).verifyCode=p),"auto-complete":"off",placeholder:o.$t("login.verifyCode"),class:"w-[60%]",onKeyup:q(y,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),r("div",ee,[r("img",{src:a(C),onClick:_},null,8,oe)])]),_:1}),t(l,{size:"default",loading:a(f),type:"primary",class:"w-full",onClick:j(y,["prevent"])},{default:u(()=>[A(b(o.$t("login.login")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["model"])])}}});const ye=Z(te,[["__scopeId","data-v-522ba35a"]]);export{ye as default};
