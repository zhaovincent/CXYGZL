import{d as w,r,L as U,a as V,c as I,a5 as s,w as c,f as m,as as _,k as E,R as B,a7 as v}from"./index-e01dade3.js";import{E as z}from"./el-dialog-1471a1af.js";import{E as M}from"./el-progress-be452bc9.js";import{_ as N}from"./plus-95522b44.js";import{u as k}from"./index-f7c9196e.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";const P=["src"],R=w({__name:"MultiUpload",props:{disabled:{type:Boolean,default:!1},modelValue:{type:Array,default:[]},limit:{type:Number,default:10},maxSize:{type:Number,default:10}},emits:["update:modelValue"],setup(d,{emit:p}){const o=d,f=r(""),u=r(!1),n=r([]);U(()=>o.modelValue,e=>{const l=n.value.map(a=>a.url);l.length>0&&l.length===e.length&&l.every(a=>e.some(t=>t===a))&&e.every(a=>l.some(t=>t===a))||(n.value=e.map(a=>({url:a.url,name:a.name})))},{immediate:!0});async function g(e){const{data:l}=await k(e.file),a=n.value.findIndex(t=>t.uid==e.file.uid);n.value.splice(a,1,{name:e.file.name,url:l}),p("update:modelValue",n.value.map(t=>({url:t.url,name:t.name})))}function y(e){e.url&&p("update:modelValue",n.value.map(a=>({url:a.url,name:a.name})))}function x(e){return e.type.indexOf("image")<0?(v.warning("请上传图片"),!1):e.size>o.maxSize*1048*1048?(v.warning("上传图片不能大于"+o.maxSize+"M"),!1):!0}const h=e=>{f.value=e.url,u.value=!0};return(e,l)=>{const a=N,t=M,b=z;return V(),I(B,null,[s(t,{"file-list":m(n),"onUpdate:fileList":l[0]||(l[0]=i=>_(n)?n.value=i:null),"list-type":"picture-card",class:"single-uploader","before-upload":x,"http-request":g,"on-remove":y,"on-preview":h,limit:o.limit,disabled:d.disabled},{default:c(()=>[s(a)]),_:1},8,["file-list","limit","disabled"]),s(b,{modelValue:m(u),"onUpdate:modelValue":l[1]||(l[1]=i=>_(u)?u.value=i:null)},{default:c(()=>[E("img",{"w-full":"",src:m(f),alt:"Preview Image"},null,8,P)]),_:1},8,["modelValue"])],64)}}});const O=L(R,[["__scopeId","data-v-5aaed5ac"]]);export{O as _};
