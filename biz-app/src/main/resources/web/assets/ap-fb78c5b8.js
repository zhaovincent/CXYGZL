import{d as F,aj as N,ab as R,r as d,h as T,o as b,af as q,a as U,c as j,a5 as s,w as u,k as i,q as B,f as a,aA as E,ae as z,a3 as A,aB as D,aC as O,aD as M}from"./index-d5547550.js";/* empty css                */import"./el-tooltip-4ed993c7.js";import{E as P}from"./el-popper-00977718.js";import{E as $,a as Q}from"./el-form-item-2de9c3c8.js";import{_ as L}from"./index.vue_vue_type_script_setup_true_lang-699d7bb4.js";import{S as y}from"./index-f9f36d5d.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import"./_baseClone-e7eb389f.js";import"./_Uint8Array-c7447712.js";import"./el-dropdown-item-15a84c23.js";import"./el-scrollbar-cbe0c54f.js";import"./dropdown-b09318e3.js";import"./refs-5fd04da2.js";const G={class:"login-container"},H={class:"flex text-white items-center py-4"},J={class:"text-2xl flex-1 text-center"},W={class:"p-2 text-white"},X={class:"p-2 text-white"},Y={class:"p-2 text-white"},ee={class:"captcha"},oe=["src"],te=F({__name:"ap",setup(se){const v=N(),w=R(),f=d(!1),C=d(!1),_=d(!1),k=d(),x=d($),n=d({phone:"18755289564",password:"123456"}),K={phone:[{required:!0,trigger:"blur"}],password:[{required:!0,trigger:"blur",validator:I}],verifyCode:[{required:!0,trigger:"blur"}]};function I(o,e,t){e.length<6?t(new Error("The password can not be less than 6 digits")):t()}function S(o){const{key:e}=o;C.value=e&&e.length===1&&e>="A"&&e<="Z"}function h(){D().then(({data:o})=>{const{verifyCodeBase64:e,verifyCodeKey:t}=o;n.value.verifyCodeKey=t,k.value=e})}const{proxy:V}=T();b(()=>{const o=w.query,e=o.redirect??"/";var t=o.token??"";const l=o.authCode??"";console.log(l),V.$isBlank(t)&&(t=l),V.$isNotBlank(t)&&(f.value=!0,v.loginByToken(t).then(()=>{const p=Object.keys(o).reduce((r,m)=>(m!=="redirect"&&(r[m]=o[m]),r),{});q.push({path:e,query:p})}).catch(()=>{h()}).finally(()=>{f.value=!1}))});function g(){x.value.validate(o=>{o&&(f.value=!0,v.login(n.value).then(()=>{const e=w.query,t=e.redirect??"/",l=Object.keys(e).reduce((p,r)=>(r!=="redirect"&&(p[r]=e[r]),p),{});q.push({path:t,query:l})}).catch(()=>{h()}).finally(()=>{f.value=!1}))})}return b(()=>{h()}),(o,e)=>{const t=O,l=Q,p=P,r=M,m=$;return U(),j("div",G,[s(m,{ref_key:"loginFormRef",ref:x,model:a(n),rules:K,class:"login-form"},{default:u(()=>[i("div",H,[i("span",J,B(o.$t("login.title")),1),s(L,{class:"text-white! cursor-pointer"})]),s(l,{prop:"phone"},{default:u(()=>[i("div",W,[s(y,{"icon-class":"user"})]),s(t,{ref:"phone",modelValue:a(n).phone,"onUpdate:modelValue":e[0]||(e[0]=c=>a(n).phone=c),class:"flex-1",size:"large",placeholder:o.$t("login.phone"),name:"phone"},null,8,["modelValue","placeholder"])]),_:1}),s(p,{disabled:a(C)===!1,content:"Caps lock is On",placement:"right"},{default:u(()=>[s(l,{prop:"password"},{default:u(()=>[i("span",X,[s(y,{"icon-class":"password"})]),s(t,{modelValue:a(n).password,"onUpdate:modelValue":e[1]||(e[1]=c=>a(n).password=c),class:"flex-1",placeholder:"密码",type:a(_)===!1?"password":"input",size:"large",name:"password",onKeyup:[S,E(g,["enter"])]},null,8,["modelValue","type","onKeyup"]),i("span",{class:"mr-2",onClick:e[2]||(e[2]=c=>_.value=!a(_))},[s(y,{"icon-class":a(_)===!1?"eye":"eye-open",class:"text-white cursor-pointer"},null,8,["icon-class"])])]),_:1})]),_:1},8,["disabled"]),s(l,{prop:"verifyCode"},{default:u(()=>[i("span",Y,[s(y,{"icon-class":"verify_code"})]),s(t,{modelValue:a(n).verifyCode,"onUpdate:modelValue":e[3]||(e[3]=c=>a(n).verifyCode=c),"auto-complete":"off",placeholder:o.$t("login.verifyCode"),class:"w-[60%]",onKeyup:E(g,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),i("div",ee,[i("img",{src:a(k),onClick:h},null,8,oe)])]),_:1}),s(r,{size:"default",loading:a(f),type:"primary",class:"w-full",onClick:z(g,["prevent"])},{default:u(()=>[A(B(o.$t("login.login")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["model"])])}}});const ge=Z(te,[["__scopeId","data-v-5c60a402"]]);export{ge as default};
