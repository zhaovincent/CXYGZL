import{d as h,r as f,D as k,h as L,a as R,c as b,a5 as t,w as u,k as D,a3 as E,f as O,a7 as U,aD as $}from"./index-d5547550.js";/* empty css                  */import{a as B,E as M}from"./el-row-a594fbeb.js";/* empty css                */import{_ as T}from"./getFormWidget-6a62e076.js";import{_ as j}from"./FlowNodeFormatData.vue_vue_type_script_setup_true_lang-2be44824.js";import{E as P}from"./el-form-item-2de9c3c8.js";import{E as S}from"./index-a6355ec2.js";const q={style:{"text-align":"center"}},ee=h({__name:"startFlowUI",emits:["complete"],setup(z,{expose:F,emit:I}){const d=f(!1),r=f([]),i=f([]),_=f(),N=()=>{if(!m.value.validate()){U.warning("请选择节点执行人");return}let e=m.value.formatSelectNodeUser();r.value.forEach(p=>e[p.id]=p.props.value);for(var o of r.value)if(e[o.id]=o.props.value,o.type==="Layout"){let p=o.props.value;var a=[];for(var s of p){var n={};for(var c of s){let g=c.props.value;n[c.id]=g}a.push(n)}e[o.id]=a}var v={flowId:i.value.flowId,paramMap:e};_.value.validate(function(p){p&&I("complete",v)})};F({handle:(l,e,o)=>{i.value=l;for(var a of e)if(a.type==="Layout"){var s=[];let n=a.props.value;s.push(n),a.props.value=s,a.props.oriForm=y.$deepCopy(n)}r.value=e,w.value=o,d.value=!0},complete:()=>{d.value=!1}});const w=f([]),x=k(()=>{var l={};for(var e of r.value)l[e.id]=e.props.value;return l}),C=l=>{for(var e of r.value){if(e.id!==l)continue;let o=e.props.value,a=e.props.oriForm;o.push(y.$deepCopy(a)),e.props.value=o}},V=(l,e)=>{for(var o of r.value)o.id===l&&o.props.value.splice(e,1)},{proxy:y}=L(),m=f();return(l,e)=>{const o=P,a=$,s=B,n=M,c=S;return R(),b("div",null,[t(c,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=v=>d.value=v),title:"发起流程",width:"800px","destroy-on-close":""},{default:u(()=>[t(n,null,{default:u(()=>[t(s,{span:12},{default:u(()=>[t(o,{"label-position":"top"},{default:u(()=>[t(T,{onAddLayoutOneItem:C,ref_key:"formRenderRef",ref:_,onDeleteLayoutOneItem:V,"form-list":r.value},null,8,["form-list"])]),_:1}),D("div",q,[t(a,{onClick:e[0]||(e[0]=v=>d.value=!1)},{default:u(()=>[E("取消")]),_:1}),t(a,{type:"primary",onClick:N},{default:u(()=>[E(" 提交 ")]),_:1})])]),_:1}),t(s,{span:12},{default:u(()=>[t(j,{formData:O(x),selectUserNodeId:w.value,"flow-id":i.value.flowId,ref_key:"flowNodeFormatRef",ref:m},null,8,["formData","selectUserNodeId","flow-id"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{ee as _};
