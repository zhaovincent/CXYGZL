import{d as Q,r as i,h as W,a as m,c as u,a5 as o,o as ae,D as se,bs as ne,f as s,w as l,k,l as J,a3 as f,R as y,a6 as B,q as h,am as N,I as le,as as ie,aD as me,E as pe}from"./index-d5547550.js";import{E as ue}from"./el-drawer-75c80c60.js";import{b as ce,E as de,a as fe}from"./el-dropdown-item-15a84c23.js";import"./el-popper-00977718.js";import"./el-scrollbar-cbe0c54f.js";/* empty css                */import{E as _e}from"./el-card-39a9c0d0.js";/* empty css                  */import{E as ve}from"./el-text-a7cd3acd.js";import{_ as ke,a as ye}from"./refuse-b0e80fe1.js";import{_ as be}from"./getFormWidget-6a62e076.js";import{_ as Ee}from"./agree.vue_vue_type_script_setup_true_lang-cc34ff3e.js";import{_ as Ie}from"./refuse.vue_vue_type_script_setup_true_lang-59805c7a.js";import{_ as he}from"./reject.vue_vue_type_script_setup_true_lang-721eab06.js";import{_ as we}from"./frontJoin.vue_vue_type_script_setup_true_lang-48aa8640.js";import{_ as ge}from"./backJoin.vue_vue_type_script_setup_true_lang-8b7c2a87.js";import{_ as xe}from"./FlowNodeFormatData.vue_vue_type_script_setup_true_lang-2be44824.js";import{_ as Se}from"./startFlowUI.vue_vue_type_script_setup_true_lang-ed1e2b40.js";import{q as Te,c as Fe}from"./index-8f215b9b.js";import{E as Re}from"./index-85bc974f.js";import{_ as $e}from"./_plugin-vue_export-helper-c27b6911.js";import"./use-dialog-27a1e524.js";import"./dropdown-b09318e3.js";import"./refs-5fd04da2.js";import"./Area-836e6083.js";import"./area-23a735cb.js";import"./index-222e6800.js";import"./isEqual-fe47b28a.js";import"./_Uint8Array-c7447712.js";import"./flatten-36990bb8.js";import"./_baseFlatten-c80c9ba3.js";import"./_overRest-d3d6b67b.js";import"./el-radio-92787871.js";import"./strings-fbdcd853.js";import"./arrays-e667dc24.js";import"./cloneDeep-cfc40afc.js";import"./_baseClone-e7eb389f.js";import"./el-tag-de6752b8.js";import"./index-e8e7f773.js";import"./debounce-e2bc871f.js";/* empty css                    */import"./Date-3e356dbd.js";import"./el-date-picker-2b967550.js";import"./panel-time-pick-ae955f65.js";import"./index-da53d962.js";import"./DateTime-de06f21f.js";import"./Description-41c11d92.js";import"./Empty-e21e601f.js";import"./Input-45ba5ba8.js";import"./el-form-item-2de9c3c8.js";import"./Money-ca211554.js";import"./el-input-number-f4eeab94.js";import"./MultiSelect-355b84fc.js";import"./el-select-46753b34.js";import"./Number-040385fc.js";import"./Score-a0ed8d55.js";import"./el-rate-1b1664df.js";import"./SelectDept-15a8e478.js";import"./selectAndShow.vue_vue_type_script_setup_true_lang-9eafc7ba.js";import"./employeesDialog-54936475.js";/* empty css                  */import"./selectBox-26a3a753.js";import"./selectBox.vue_vue_type_style_index_0_scoped_82c14c6c_lang-f1c14f73.js";import"./index-a7c7b111.js";import"./flow-165b4256.js";import"./const-a11e1fef.js";import"./selectResult-4abbf083.js";/* empty css                                                                     *//* empty css                                                                        */import"./index-a6355ec2.js";import"./orgItem-a67c9471.js";import"./SelectMultiDept-7fbc4ddc.js";import"./SelectMultiUser-a6f17dc4.js";import"./SelectUser-e4906c1f.js";import"./SingleSelect-915a5a36.js";import"./Textarea-466c5ec6.js";import"./Time-1bed9846.js";import"./el-time-picker-f79f3178.js";import"./isArrayLikeObject-724a27ce.js";import"./UploadFile-b7fa1437.js";import"./el-progress-562499f2.js";import"./index-15f47425.js";import"./UploadImage-478fe7ac.js";import"./MultiUpload-acf0a282.js";import"./plus-bafa12a0.js";/* empty css                */import"./el-tab-pane-a6cb13f9.js";import"./el-divider-6edec4d7.js";import"./el-row-a594fbeb.js";const Ce=Q({__name:"subProcessStartFlow",emits:["taskSubmitEvent"],setup(X,{expose:O,emit:V}){const d=i([]);O({handle:(n,c)=>{var _={flowId:n,taskId:c};d.value=_,L(_)}});const r=i(),L=n=>{Te(n.taskId,!1).then(c=>{const{data:_}=c,{formItems:g,selectUserNodeId:T,nodeId:F}=_;d.value.nodeId=F,r.value.handle(n,g,T)})};W();const w=n=>{let c=n.paramMap;c.subProcessStartHandle=!1,c.root_user_task_approve_condition=!0;var _={paramMap:c,taskId:d.value.taskId,approveResult:!0};Fe(_).then(g=>{r.value.complete(g),V("taskSubmitEvent")})};return(n,c)=>(m(),u("div",null,[o(Se,{onComplete:w,ref_key:"startFlowUiRef",ref:r},null,512)]))}}),De={style:{position:"relative"}},He={style:{display:"flex","flex-direction":"row"}},Je={class:"f11"},Ne={class:"f22"},Oe={key:0,class:"iconclass",src:ke},Ve={key:1,class:"iconclass",src:ye},Le={style:{flex:"auto"}},Ue=Q({__name:"taskUi",emits:["taskSubmitEvent"],setup(X,{expose:O,emit:V}){const d=i(!1),v=i([]),r=i({}),L=(t,e,p,x,C,I,z,P,j)=>{var D;if(r.value=e,x&&p)K.value.handle(C,t);else{n.value=I;let S=JSON.parse(z);S.operList&&(v.value=(D=S.operList)==null?void 0:D.filter(a=>a.checked)),R.value=S.id,$.value=JSON.parse(P),d.value=!0,w.value=j}},w=i(!1),n=i(),c=t=>{for(var e of n.value){if(e.id!==t)continue;let p=e.props.value,x=e.props.oriForm;p.push(g.$deepCopy(x)),e.props.value=p}},_=(t,e)=>{for(var p of n.value)p.id===t&&p.props.value.splice(e,1)},{proxy:g}=W(),T=i(),F=i(),M=i(),q=i(),A=i();O({deal:L});const b=()=>{d.value=!1,V("taskSubmitEvent")},G=t=>{E.value.validate(function(e){e&&T.value.handle(r.value,n.value,w.value,t)})},Y=t=>{E.value.validate(function(e){e&&F.value.handle(r.value,n.value,t)})},R=i(""),$=i({}),E=i(),Z=t=>{E.value.validate(function(e){e&&M.value.handle(r.value,n.value,R.value,$.value,t)})},ee=t=>{E.value.validate(function(e){e&&q.value.handle(r.value,n.value,R.value,$.value,t)})},te=t=>{E.value.validate(function(e){e&&A.value.handle(r.value,n.value,R.value,$.value,t)})};ae(()=>{});const oe=se(()=>{var t={};for(var e of n.value)t[e.id]=e.props.value;return t}),K=i(),U=t=>{let e=v.value.filter(p=>p.key===t)[0].name;if(t==="frontJoin"){ee(e);return}if(t==="backJoin"){te(e);return}if(t==="reject"){Z(e);return}if(t==="refuse"){Y(e);return}if(t==="pass"){G(e);return}};return(t,e)=>{const p=ve,x=Re,C=_e,I=me,z=pe,P=ce,j=de,D=fe,S=ue;return m(),u("div",null,[o(S,{modelValue:s(d),"onUpdate:modelValue":e[1]||(e[1]=a=>ie(d)?d.value=a:null),direction:"rtl",size:"500px"},ne({header:l(()=>[o(p,{size:"large",tag:"b",type:"info"},{default:l(()=>[f("流程详情")]),_:1})]),default:l(()=>[o(C,{style:{"margin-bottom":"20px"}},{default:l(()=>[k("div",De,[k("div",He,[k("div",Je,[o(x,{shape:"square",size:50,src:s(r).starterAvatarUrl},{default:l(()=>[f(h(s(r).starterName.substring(0,1)),1)]),_:1},8,["src"])]),k("div",Ne,[k("div",null,[o(p,{tag:"b",size:"large",type:"primary"},{default:l(()=>{var a;return[f(h((a=s(r))==null?void 0:a.processName),1)]}),_:1})]),k("div",null,[o(p,{size:"small"},{default:l(()=>[f(h(s(r).startTime),1)]),_:1})])])]),s(r).processInstanceResult==1?(m(),u("img",Oe)):N("",!0),s(r).processInstanceResult==2?(m(),u("img",Ve)):N("",!0)])]),_:1}),o(C,{class:"box-card"},{default:l(()=>[o(be,{onAddLayoutOneItem:c,onDeleteLayoutOneItem:_,ref_key:"formRenderRef",ref:E,"form-list":s(n)},null,8,["form-list"])]),_:1}),o(xe,{disableSelect:!0,formData:s(oe),"task-id":s(r).taskId,processInstanceId:s(r).processInstanceId,"flow-id":s(r).flowId,ref:"flowNodeFormatRef"},null,8,["formData","task-id","processInstanceId","flow-id"])]),_:2},[s(r).taskExist?{name:"footer",fn:l(()=>[k("div",Le,[s(w)?(m(),J(I,{key:0,size:"large",color:"#9933FF",onClick:e[0]||(e[0]=a=>G("完成任务"))},{default:l(()=>[f(" 完成 ")]),_:1})):(m(),u(y,{key:1},[s(v).length>2?(m(),u(y,{key:0},[o(D,{style:{"margin-right":"20px"},onCommand:U},{dropdown:l(()=>[o(j,null,{default:l(()=>[(m(!0),u(y,null,B(s(v),(a,H)=>(m(),u(y,null,[H>1?(m(),J(P,{key:0,command:a.key,icon:t.$icon[a.icon]},{default:l(()=>[f(h(a.name),1)]),_:2},1032,["command","icon"])):N("",!0)],64))),256))]),_:1})]),default:l(()=>[o(I,{dark:!0},{default:l(()=>[f(" 更多 "),o(z,{class:"el-icon--right"},{default:l(()=>[o(s(le))]),_:1})]),_:1})]),_:1}),(m(!0),u(y,null,B(s(v),(a,H)=>(m(),u(y,null,[H<=1?(m(),J(I,{key:0,type:a.type,dark:!0,onClick:re=>U(a.key)},{default:l(()=>[f(h(a.name),1)]),_:2},1032,["type","onClick"])):N("",!0)],64))),256))],64)):(m(!0),u(y,{key:1},B(s(v),(a,H)=>(m(),J(I,{type:a.type,dark:!0,onClick:re=>U(a.key)},{default:l(()=>[f(h(a.name),1)]),_:2},1032,["type","onClick"]))),256))],64))])]),key:"0"}:void 0]),1032,["modelValue"]),o(Ee,{onTaskSubmitEvent:b,ref_key:"agreeHandler",ref:T},null,512),o(Ie,{onTaskSubmitEvent:b,ref_key:"refuseHandler",ref:F},null,512),o(he,{onTaskSubmitEvent:b,ref_key:"rejectHandler",ref:M},null,512),o(we,{onTaskSubmitEvent:b,ref_key:"frontJoinHandler",ref:q},null,512),o(ge,{onTaskSubmitEvent:b,ref_key:"backJoinHandler",ref:A},null,512),o(Ce,{onTaskSubmitEvent:b,ref_key:"subProcessStartFlowRef",ref:K},null,512)])}}});const ho=$e(Ue,[["__scopeId","data-v-06ce97d5"]]);export{ho as default};
