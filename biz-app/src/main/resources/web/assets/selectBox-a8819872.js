import{e3 as M,r as B,aj as O,D as k,h as F,o as G,L as H,a as d,c,l as J,f,as as K,e4 as Q,am as V,k as r,R as m,a6 as b,q as L,a5 as y,w as g,e5 as W,e6 as X,a3 as Y,aA as Z,E as ee}from"./index-e01dade3.js";import{E as te}from"./el-avatar-63a3488d.js";import{E as ae}from"./el-checkbox-123bf6dd.js";/* empty css                */import{o as se,a as le}from"./index-8f0c79b2.js";import{$ as oe}from"./index-126d0406.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";let ne={};const E=M.create(ne);E.interceptors.request.use(function(e){return e},function(e){return Promise.reject(e)});E.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});let de="/";function j(e){return E.get(`${de}roles.json`,{params:e})}let D=B(""),v=B({titleDepartments:[],childDepartments:[],roleList:[],employees:[]}),N=B({}),ce=async()=>{let{data:{list:e}}=await j();N.value=e},z=async(e=0,_="org")=>{let{data:h}=await se(_,e);v.value=h},ie=(e,_=1)=>{oe.debounce(async()=>{if(e){let h={userName:e,pageNum:1,pageSize:30};if(_==1){v.value.childDepartments=[];let i=await le(h);v.value.employees=i.data}else{let i=await j(h);N.value=i.data.list}}else _==1?await z():await ce()})()};const ue={key:1,class:"ellipsis tree_nav"},pe=["onClick"],fe={class:"select-box"},ye={style:{display:"flex","flex-direction":"row"}},ve={class:"f11"},_e={class:"f12"},he={style:{display:"flex","flex-direction":"row"}},me={class:"d11"},ge={style:{display:"flex","flex-direction":"row"}},xe={class:"f11"},ke={class:"f12"},Ve=["onClick"],be={style:{display:"flex","flex-direction":"row"}},Le={class:"f11"},we={class:"f12"},Ce={__name:"selectBox",props:{selectedList:{type:Array,default:()=>[]},type:{type:String,default:"org"},multiple:{type:Boolean,default:!0},selectSelf:{type:Boolean,default:!0}},emits:["update:selectedList"],setup(e,{expose:_,emit:h}){const i=e,q=O(),R=k(()=>q.userId),x=o=>{z(o,i.type).then(s=>{let u=i.selectedList;for(var l of w.value){console.log(l,"))))))))))))))");for(var n of l.data){var U=u.filter(a=>a.id===n.id&&a.type===n.type).length>0;n.selected=U}}})};let T=k(()=>v.value.childDepartments),S=k(()=>v.value.employees),A=k(()=>v.value.roleList);var w=k(()=>[{type:"dept",data:T.value},{type:"user",data:S.value},{type:"role",data:A.value}]);const{proxy:P}=F();G(()=>{x(0)});const C=o=>{let s=P.$deepCopy(i.selectedList);if(o.selected)i.multiple||(S.value.forEach(l=>l.selected=!1),s=[]),o.selected=!0,s.push(o);else{for(var u of w.value){let l=u.data.filter(n=>n.id===o.id&&n.type===o.type);l.length>0&&(l[0].selected=!1)}s=s.filter(l=>!(l.id===o.id&&l.type===o.type))}h("update:selectedList",s)},I=()=>{let o=i.selectedList;for(var s of w.value)for(var u of s.data){var l=o.filter(n=>n.id===u.id&&n.type===u.type).length>0;u.selected=l}};return _({queryData:x,changeEvent:C,refreshData:I}),H(()=>i.selectedList,o=>{I()}),(o,s)=>{const u=Z,l=ee,n=ae,U=te;return d(),c("div",null,[e.type!="role"?(d(),J(u,{key:0,modelValue:f(D),"onUpdate:modelValue":s[0]||(s[0]=a=>K(D)?D.value=a:null),class:"w-50 m-2",style:{width:"100%"},placeholder:"搜索成员",onInput:s[1]||(s[1]=a=>f(ie)(a)),"prefix-icon":f(Q)},null,8,["modelValue","prefix-icon"])):V("",!0),!f(D)&&e.type!="role"?(d(),c("p",ue,[r("span",{onClick:s[2]||(s[2]=a=>x(0)),class:"ellipsis"},"根节点"),(d(!0),c(m,null,b(f(v).titleDepartments,(a,$)=>(d(),c("span",{class:"ellipsis",key:$+"a",onClick:t=>x(a.id)},L(a.name),9,pe))),128))])):V("",!0),r("ul",fe,[(d(!0),c(m,null,b(f(w),(a,$)=>(d(),c(m,{key:$},[a.type==="role"?(d(!0),c(m,{key:0},b(a.data,t=>(d(),c("li",{key:t.id},[y(n,{modelValue:t.selected,"onUpdate:modelValue":p=>t.selected=p,onChange:p=>C(t),disabled:t.status==0},{default:g(()=>[r("div",ye,[r("div",ve,[y(l,{style:{"font-size":"20px"}},{default:g(()=>[y(f(W))]),_:1})]),r("div",_e,L(t.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"])]))),128)):V("",!0),a.type==="dept"&&(e.type==="org"||e.type==="dept"||e.type==="user")?(d(!0),c(m,{key:1},b(a.data,t=>(d(),c("li",{key:t.id},[r("div",he,[r("div",me,[y(n,{modelValue:t.selected,"onUpdate:modelValue":p=>t.selected=p,onChange:p=>C(t),disabled:!(e.type==="org"||e.type==="dept")||t.status==0},{default:g(()=>[r("div",ge,[r("div",xe,[y(l,{style:{"font-size":"20px"}},{default:g(()=>[y(f(X))]),_:1})]),r("div",ke,L(t.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"])]),r("div",{class:"d22",onClick:p=>x(t.id)}," 下级 ",8,Ve)])]))),128)):V("",!0),a.type==="user"&&(e.type==="org"||e.type==="user")?(d(!0),c(m,{key:2},b(a.data,t=>(d(),c("li",{key:t.id,class:"check_box"},[y(n,{modelValue:t.selected,"onUpdate:modelValue":p=>t.selected=p,disabled:t.status==0||!e.selectSelf&&R.value===t.id,onChange:p=>C(t)},{default:g(()=>[r("div",be,[r("div",Le,[y(U,{shape:"square",size:20,src:t.avatar},{default:g(()=>[Y(L(t.name.substring(0,1)),1)]),_:2},1032,["src"])]),r("div",we,L(t.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]))),128)):V("",!0)],64))),128))])])}}},De=re(Ce,[["__scopeId","data-v-40e844b2"]]),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{De as a,ie as b,ce as c,v as d,Ne as e,z as g,N as r,D as s};
