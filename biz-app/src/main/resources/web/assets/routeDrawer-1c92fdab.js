import{d as j,D,r as N,L as A,h as ee,a as k,l as b,w as u,c as U,R as H,a6 as q,f as v,k as w,q as F,a5 as f,a3 as y,as as V,a7 as oe,aD as te}from"./index-d5547550.js";import{E as ae}from"./el-drawer-75c80c60.js";/* empty css                  */import{E as le}from"./el-card-39a9c0d0.js";import{E as re}from"./el-text-a7cd3acd.js";import"./el-tag-de6752b8.js";import{E as ie,a as ne}from"./el-select-46753b34.js";import"./el-scrollbar-cbe0c54f.js";import"./el-popper-00977718.js";import se from"./conditionGroup-01fc4cb1.js";import{u as pe}from"./flow-165b4256.js";import{$ as h}from"./index-a7c7b111.js";import{u as ue}from"./index-71f0fd6b.js";import{E as de}from"./index-a6355ec2.js";import{_ as me}from"./_plugin-vue_export-helper-c27b6911.js";import"./use-dialog-27a1e524.js";import"./strings-fbdcd853.js";import"./isEqual-fe47b28a.js";import"./_Uint8Array-c7447712.js";import"./debounce-e2bc871f.js";import"./index-e8e7f773.js";/* empty css                */import"./el-form-item-2de9c3c8.js";import"./_baseClone-e7eb389f.js";import"./el-switch-a81630c6.js";import"./condition-7334fe6b.js";import"./area-23a735cb.js";import"./index-222e6800.js";import"./flatten-36990bb8.js";import"./_baseFlatten-c80c9ba3.js";import"./_overRest-d3d6b67b.js";import"./el-radio-92787871.js";import"./arrays-e667dc24.js";import"./cloneDeep-cfc40afc.js";/* empty css                    */import"./el-time-picker-f79f3178.js";import"./panel-time-pick-ae955f65.js";import"./index-da53d962.js";import"./isArrayLikeObject-724a27ce.js";import"./el-date-picker-2b967550.js";import"./el-input-number-f4eeab94.js";import"./index-6e9421a4.js";import"./selectAndShow.vue_vue_type_script_setup_true_lang-9eafc7ba.js";import"./employeesDialog-54936475.js";import"./selectBox-26a3a753.js";/* empty css                  *//* empty css                */import"./selectBox.vue_vue_type_style_index_0_scoped_82c14c6c_lang-f1c14f73.js";import"./index-85bc974f.js";import"./selectResult-4abbf083.js";/* empty css                                                                     *//* empty css                                                                        */import"./orgItem-a67c9471.js";import"./const-a11e1fef.js";import"./refs-5fd04da2.js";const ce={class:"card-header"},ve={style:{"margin-top":"20px"}},fe={class:"dialog-footer"},_e=j({__name:"routeDrawer",setup(ge){let R=pe();var M=D(()=>{let t=[];const e=[10,3];var l={},r=[],n={},m={};console.log("-----------",R.step3),E(void 0,R.step3,l,n,!0,m),S(s.value.id,m,r);var o=l[s.value.id];o==null&&(o=[]),o=o.concat(r),console.log("-----------",o);for(var c of o){var C=n[c].type;e.indexOf(C)==-1&&n[c].id!=s.value.id&&t.push({id:n[c].id,name:n[c].nodeName})}return t});function S(t,e,l){let r=e[t];_.$isBlank(r)||(l.push(r),S(r,e,l))}function E(t,e,l,r,n,m){if(_.$isNode(e)){var o=e.id;if(r[o]=e,_.$isNotBlank(t)){var C=l[t];let T=r[t].type;if((T==5||T==8)&&!n)l[o]=[];else{var a=_.$deepCopy(C);a.push(o),l[o]=a}}else{var c=[];c.push(o),l[o]=c}var g=e.type,i=e.childNode;if(_.$isNode(i)&&(m[o]=i.id),g===5||g===8||g===4){var Y=e.conditionNodes;for(var Z of Y)E(o,Z,l,r,!1,m);_.$isNode(i)&&E(o,i,l,r,!0,m)}else _.$isNode(i)&&E(o,i,l,r,!0,m)}}let s=N({});var d=N(!1),p=N(),B=N(),z=t=>{s.value.list.splice(t,1)},G=()=>{s.value.list.push({groupRelationMode:!0,mode:!0,error:!0,nodeId:"",placeHolder:"",groupRelation:[],conditionList:[]})},J=t=>{d.value=!0,B.value=t,p.value=_.$deepCopy(s.value.list[t])},K=()=>{if(p.value.error=!h.checkCondition({conditionNodes:[p.value,{}]},0),!h.checkCondition({conditionNodes:[p.value,{}]},0)){oe.warning("请完善条件");return}console.log("条件数据",p.value),d.value=!1;let t=h.conditionStr({conditionNodes:[p.value,{}]},0);p.value.placeHolder=t,s.value.list[B.value]=p.value};let $=ue(),{setRouteConfig:O,setRoute:P}=$,Q=D(()=>$.routeDrawer),I=D(()=>$.routeConfigData),x=D({get(){return Q.value},set(){L()}});A(I,t=>{s.value=t.value},{deep:!0});const{proxy:_}=ee(),W=()=>{},X=()=>{s.value.error=!h.routeOk(s.value),O({value:s.value,flag:!0,id:I.value.id}),L()},L=()=>{P(!1)};return(t,e)=>{const l=ie,r=ne,n=te,m=re,o=le,c=de,C=ae;return k(),b(C,{"append-to-body":!0,title:"动态路由",modelValue:v(x),"onUpdate:modelValue":e[3]||(e[3]=a=>V(x)?x.value=a:x=a),onOpen:W,class:"set_copyer","show-close":!1,size:550,"before-close":X},{default:u(()=>[(k(!0),U(H,null,q(v(s).list,(a,g)=>(k(),b(o,{class:"box-card",style:{"margin-bottom":"20px"}},{header:u(()=>[w("div",ce,[w("span",null,"路由"+F(g+1),1),f(r,{modelValue:a.nodeId,"onUpdate:modelValue":i=>a.nodeId=i,placeholder:"选择节点"},{default:u(()=>[(k(!0),U(H,null,q(v(M),i=>(k(),b(l,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),f(n,{class:"button",type:"danger",text:"",onClick:i=>v(z)(g)},{default:u(()=>[y("删除")]),_:2},1032,["onClick"])])]),default:u(()=>[w("div",null,[f(m,{tag:"b"},{default:u(()=>[y(F(a.placeHolder),1)]),_:2},1024)]),w("div",ve,[f(n,{type:"danger",onClick:i=>v(J)(g)},{default:u(()=>[y("添加条件")]),_:2},1032,["onClick"])])]),_:2},1024))),256)),f(n,{text:"",type:"primary",onClick:v(G)},{default:u(()=>[y("添加路由")]),_:1},8,["onClick"]),f(c,{modelValue:v(d),"onUpdate:modelValue":e[2]||(e[2]=a=>V(d)?d.value=a:d=a),width:"500px"},{footer:u(()=>[w("span",fe,[f(n,{onClick:e[1]||(e[1]=a=>V(d)?d.value=!1:d=!1)},{default:u(()=>[y("取消")]),_:1}),f(n,{type:"primary",onClick:v(K)},{default:u(()=>[y(" 确定 ")]),_:1},8,["onClick"])])]),default:u(()=>[f(se,{data:v(p),"onUpdate:data":e[0]||(e[0]=a=>V(p)?p.value=a:p=a)},null,8,["data"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}});const ko=me(_e,[["__scopeId","data-v-731e3ce5"]]);export{ko as default};
