import{aj as A,D as m,h as R,o as j,L as F,a as r,c as n,l as M,f as p,as as T,ea as G,am as x,k as o,R as v,a6 as g,q as k,a5 as f,w as _,eb as H,ec as J,a3 as K,aC as O,E as P}from"./index-d5547550.js";/* empty css                  *//* empty css                    *//* empty css                */import{d as C,s as b,g as Q,a as W}from"./selectBox.vue_vue_type_style_index_0_scoped_82c14c6c_lang-f1c14f73.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import{E as Y}from"./index-222e6800.js";import{E as Z}from"./index-85bc974f.js";import"./index-a7c7b111.js";import"./flow-165b4256.js";import"./const-a11e1fef.js";import"./isEqual-fe47b28a.js";import"./_Uint8Array-c7447712.js";import"./flatten-36990bb8.js";import"./_baseFlatten-c80c9ba3.js";import"./_overRest-d3d6b67b.js";const ee={key:1,class:"ellipsis tree_nav"},te=["onClick"],se={class:"select-box"},ae={style:{display:"flex","flex-direction":"row"}},le={class:"f11"},oe={class:"f12"},de={style:{display:"flex","flex-direction":"row"}},re={class:"d11"},ne={style:{display:"flex","flex-direction":"row"}},ie={class:"f11"},ce={class:"f12"},ue=["onClick"],pe={style:{display:"flex","flex-direction":"row"}},fe={class:"f11"},ye={class:"f12"},ve={__name:"selectBox",props:{selectedList:{type:Array,default:()=>[]},type:{type:String,default:"org"},multiple:{type:Boolean,default:!0},selectSelf:{type:Boolean,default:!0}},emits:["update:selectedList"],setup(i,{expose:B,emit:I}){const y=i,$=A(),S=m(()=>$.userId),h=a=>{W(a,y.type).then(s=>{let c=y.selectedList;for(var l of V.value)for(var d of l.data){var w=c.filter(t=>t.id===d.id&&t.type===d.type).length>0;d.selected=w}})};let N=m(()=>C.value.childDepartments),D=m(()=>C.value.employees),q=m(()=>C.value.roleList);var V=m(()=>[{type:"dept",data:N.value},{type:"user",data:D.value},{type:"role",data:q.value}]);const{proxy:z}=R();j(()=>{h(0)});const L=a=>{let s=z.$deepCopy(y.selectedList);if(a.selected)y.multiple||(D.value.forEach(l=>l.selected=!1),s=[]),a.selected=!0,s.push(a);else{for(var c of V.value){let l=c.data.filter(d=>d.id===a.id&&d.type===a.type);l.length>0&&(l[0].selected=!1)}s=s.filter(l=>!(l.id===a.id&&l.type===a.type))}I("update:selectedList",s)},U=()=>{let a=y.selectedList;for(var s of V.value)for(var c of s.data){var l=a.filter(d=>d.id===c.id&&d.type===c.type).length>0;c.selected=l}};return B({queryData:h,changeEvent:L,refreshData:U}),F(()=>y.selectedList,a=>{U()}),(a,s)=>{const c=O,l=P,d=Y,w=Z;return r(),n("div",null,[i.type!="role"?(r(),M(c,{key:0,modelValue:p(b),"onUpdate:modelValue":s[0]||(s[0]=t=>T(b)?b.value=t:null),class:"w-50 m-2",style:{width:"100%"},placeholder:"搜索成员",onInput:s[1]||(s[1]=t=>p(Q)(t)),"prefix-icon":p(G)},null,8,["modelValue","prefix-icon"])):x("",!0),!p(b)&&i.type!="role"?(r(),n("p",ee,[o("span",{onClick:s[2]||(s[2]=t=>h(0)),class:"ellipsis-node"},"根节点"),(r(!0),n(v,null,g(p(C).titleDepartments,(t,E)=>(r(),n("span",{class:"ellipsis-node",key:E+"a",onClick:e=>h(t.id)},k(t.name),9,te))),128))])):x("",!0),o("ul",se,[(r(!0),n(v,null,g(p(V),(t,E)=>(r(),n(v,{key:E},[t.type==="role"?(r(!0),n(v,{key:0},g(t.data,e=>(r(),n("li",{key:e.id},[f(d,{modelValue:e.selected,"onUpdate:modelValue":u=>e.selected=u,onChange:u=>L(e),disabled:e.status==0},{default:_(()=>[o("div",ae,[o("div",le,[f(l,{style:{"font-size":"20px"}},{default:_(()=>[f(p(H))]),_:1})]),o("div",oe,k(e.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"])]))),128)):x("",!0),t.type==="dept"&&(i.type==="org"||i.type==="dept"||i.type==="user")?(r(!0),n(v,{key:1},g(t.data,e=>(r(),n("li",{key:e.id},[o("div",de,[o("div",re,[f(d,{modelValue:e.selected,"onUpdate:modelValue":u=>e.selected=u,onChange:u=>L(e),disabled:!(i.type==="org"||i.type==="dept")||e.status==0},{default:_(()=>[o("div",ne,[o("div",ie,[f(l,{style:{"font-size":"20px"}},{default:_(()=>[f(p(J))]),_:1})]),o("div",ce,k(e.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"])]),o("div",{class:"d22",onClick:u=>h(e.id)}," 下级 ",8,ue)])]))),128)):x("",!0),t.type==="user"&&(i.type==="org"||i.type==="user")?(r(!0),n(v,{key:2},g(t.data,e=>(r(),n("li",{key:e.id,class:"check_box"},[f(d,{modelValue:e.selected,"onUpdate:modelValue":u=>e.selected=u,disabled:e.status==0||!i.selectSelf&&S.value===e.id,onChange:u=>L(e)},{default:_(()=>[o("div",pe,[o("div",fe,[f(w,{shape:"square",size:20,src:e.avatar},{default:_(()=>[K(k(e.name.substring(0,1)),1)]),_:2},1032,["src"])]),o("div",ye,k(e.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])]))),128)):x("",!0)],64))),128))])])}}},$e=X(ve,[["__scopeId","data-v-82c14c6c"]]);export{$e as default};
