import{u as j}from"./flow-165b4256.js";import{c as F,d as E}from"./const-a11e1fef.js";import{D as M}from"./index-d5547550.js";function R(){}let D=j();const V=M(()=>D.step2),_=M(()=>{var e={};for(var t of V.value)e[t.id]=t;return e.root={name:"发起人",type:"SelectUser"},e});R.prototype={timer:"",debounce(e,t=500){var r=this;return function(l){let s=this,a=l;clearTimeout(r.timer),r.timer=setTimeout(function(){e.call(s,a)},t)}},setCookie(e){for(var t=0,r=e.length;t<r;t++)for(var l in e[t])document.cookie=l+"="+encodeURIComponent(e[t][l])+"; path=/"},getCookie(e){for(var t=document.cookie,r=t.split("; "),l=0,s=r.length;l<s;l++){var a=r[l].split("=");if(e==a[0])return decodeURIComponent(a[1])}},clearCookie(e){var t=new Date;t.setTime(-1e3);for(var r=0,l=e.length;r<l;r++)document.cookie=""+e[r]+"=''; path=/; expires="+t.toGMTString()},arrToStr(e){if(e)return e.map(t=>t.name).toString()},toggleClass(e,t,r="id"){return e.some(l=>l[r]==t[r])},toChecked(e,t,r="id"){var l=this.toggleClass(e,t,r);l?this.removeEle(e,t,r):e.push(t)},removeEle(e,t,r="id"){var l;e.map((s,a)=>{s[r]==t[r]&&(l=a)}),e.splice(l,1)},checkApproval(e){var l;if(e.assignedType==1){if(e.nodeUserList.length==0)return!1}else if(e.assignedType==3){if(e.nodeUserList.length==0)return!1}else{if(e.assignedType==8&&e.formUserId.length==0)return!1;if(e.assignedType==9&&e.formUserId.length==0)return!1}if(e.nobody.handler==="TO_USER"&&e.nobody.assignedUser.length==0||e.refuse.handler==="TO_NODE"&&((l=e.refuse.nodeId)==null?void 0:l.length)==0)return!1;let t=e.operList;return(t==null?void 0:t.filter(s=>s.checked).length)!=0},setApproverStr(e){return e.assignedType==1?e.nodeUserList.length>=1?e.nodeUserList.map(t=>t.name).join(","):"":e.assignedType==3?e.nodeUserList.length>=1?e.nodeUserList.map(t=>t.name).join(","):"":e.assignedType==2?e.deptLeaderLevel==1?"直接部门主管":"第"+e.deptLeaderLevel+"级部门主管":e.assignedType==4?"发起人自选":e.assignedType==5?"发起人自己":e.assignedType==7?"到第"+e.deptLeaderLevel+"级部门主管终止":e.assignedType==8&&e.formUserId.length>0?"表单人员："+e.formUserName:e.assignedType==9&&e.formUserId.length>0?"表单部门："+e.formUserName:""},dealStr(e,t){let r=[],l=e.split(",");for(var s in t)l.map(a=>{a==s&&r.push(t[s].value)});return r.join("或")},checkCondition(e,t){var f;let r=e.conditionNodes,l=r[t],s=l.groupRelationMode,a=l.groupRelation;if(!s&&a.length==0)return!1;let u=l.conditionList;if(u.length==0)return!1;if(t!=r.length-1)for(var d of u){if(d.conditionList.length==0)return!1;for(var i of d.conditionList)if(!(i.keyType==="SelectUser"&&i.userKey.indexOf("empty")>=0)&&(!i.key||i.key.length==0||!i.expression||i.expression.length==0||i.expression.indexOf("empty")<0&&(!i.value||i.value.length==0)||i.keyType==="Area"&&!((f=i.value)!=null&&f.value)&&i.expression.indexOf("empty")<0))return!1}return!0},conditionStr(e,t){let r=e.conditionNodes;if(t==r.length-1)return"默认条件";let l=r[t],s=l.groupRelationMode,a=l.groupRelation;if(!s&&a.length==0)return"请设置条件组关系";var{conditionList:u}=l,d=l.mode;if(u.length==0)return t==r.length-1?"其他条件进入此流程":"请设置条件";var i=[];for(var f of u){let N=f.mode;var c=[];for(var g of f.conditionList){const{key:y,expression:m,value:o}=g;if(!y)continue;let h=_.value[y];var I=h.name,n=o;if(h.type==="SelectUser"){let p=g.userKey,L=g.userKeyFieldList.filter(k=>k.key===p)[0].type;L==="SingleSelect"?n=o.map(k=>k.value).join(","):L&&L.length>0?n||(m.indexOf("empty")>=0?n="":n="?"):n=""}else h.type==="SelectDept"?o?n=o.map(p=>p.name).join(","):m.indexOf("empty")>=0?n="":n="?":h.type==="SingleSelect"||h.type==="MultiSelect"?m.indexOf("empty")>=0?n="":n=o.map(p=>p.value).join(","):h.type==="Area"?m.indexOf("empty")>=0?n="":o!=null&&o.name?n=o.name:n="?":n||(m.indexOf("empty")>=0?n="":n="?");var U={};for(var x in F.value){let p=F.value[x];for(var O of p)U[O.key]=O.name}if(h.type==="SelectUser"){let p=g.userKey,K=g.userKeyFieldList.filter(L=>L.key===p)[0];c.push(I+" "+K.name+" "+(U[m]?U[m]:"")+" "+n)}else c.push(I+" "+U[m]+" "+n)}if(N){let y=c.join(" 且 ");c.length>0&&i.push("("+y+")")}else{let y=c.join(" 或 ");c.length>0&&i.push("("+y+")")}}if(s??!0)return i.length>0?i.join(d?" 且 ":" 或 "):t==r.length-1?"默认条件":"请设置条件";if(i.length==0)return"请设置条件";var v="";for(var S of a)v=v+S.name;for(var T=0;T<i.length;T++)v=v.replaceAll("条件组"+(T+1),i[T]);return v},copyerStr(e){var t;if(((t=e.nodeUserList)==null?void 0:t.length)!=0)return this.arrToStr(e.nodeUserList)},triggerStr(e){return e.httpSetting.url},checkTrigger(e){let t=e.httpSetting.url;var r=/^((ht|f)tps?):\/\/[\w\-]+(\.[\w\-]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?$/;return r.test(t)},delayStr(e){let t=e.value,r=(t==null?void 0:t.length)>0?t:"?",l=e.mode,s=e.delayUnit;if(l){let a=E.filter(u=>u.value===s)[0];return"等待"+r+a.label}return"等至"+r},subProcessStr(e){const{starterMode:t,starterValue:r,subFlowId:l,subFlowName:s}=e;return"子流程:"+((s==null?void 0:s.length)>0?s:"?")},subProcessOK(e){if(e==null)return!1;const{starterMode:t,starterValue:r,subFlowId:l,pcFormList:s,cpFormList:a,multiple:u,multipleMode:d,multipleModeValue:i}=e;if(l.length==0)return!1;for(var f of s)if(f.field.length==0||f.value.length==0)return!1;if(u){if((d==2||d==3)&&(!i||i.length==0))return!1}else for(var f of a)if(f.field.length==0||f.value.length==0)return!1;return!(t==2&&r.length==0||t==3&&(!u||d!=3||i.length==0))},routeStr(e){return this.routeOk(e)?e.list.length+"条动态路由":"请完善路由信息"},routeOk(e){let t=e.list;return t.length==0?!1:t.filter(l=>l.error||l.nodeId.length==0).length==0}};const q=new R;export{q as $};
