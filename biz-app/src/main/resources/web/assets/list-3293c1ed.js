import{d as S,r as n,D as U,h as B,a as v,c as I,a5 as r,w as a,k as m,a3 as R,f as M,a7 as q,aB as A,a8 as P,o as G,R as $,a6 as D,l as J,q as O,ag as T,ah as j}from"./index-e01dade3.js";import{E as z}from"./el-card-16bdf0d8.js";import{E as Q}from"./el-link-b55a22bf.js";import{E as H}from"./el-avatar-63a3488d.js";import{c as K}from"./index-cffc2a4a.js";import{E as W}from"./el-dialog-1471a1af.js";import{a as X,E as Y}from"./el-row-e9611a44.js";/* empty css                */import{_ as Z}from"./FormRender.vue_vue_type_script_setup_true_lang-50f6b849.js";import{_ as oo}from"./FlowNodeFormatData.vue_vue_type_script_setup_true_lang-b8400ff6.js";import{s as eo,g as to}from"./index-a2589c62.js";import{E as ro}from"./el-form-item-85be6a3a.js";import{_ as ao}from"./_plugin-vue_export-helper-c27b6911.js";import"./refs-dd65b3fd.js";import"./getFormWidget-4084fd80.js";import"./Date-e3a674b4.js";import"./el-date-picker-b8fb5128.js";import"./panel-time-pick-cbec15ad.js";import"./el-popper-ee5283d6.js";import"./isEqual-47390e81.js";import"./_Uint8Array-aeb50f83.js";import"./el-scrollbar-f2029ad1.js";import"./index-f7c59abe.js";import"./debounce-bf37b7f7.js";import"./flatten-178b99bc.js";import"./_baseFlatten-6e5398bc.js";import"./index-6b517de5.js";import"./DateTime-e4a39557.js";import"./Description-c9397ba1.js";import"./Empty-b60a7a2f.js";import"./Input-741e75d5.js";import"./Money-53354be7.js";import"./el-input-number-182b17d2.js";import"./MultiSelect-f62683ec.js";import"./el-select-c154265f.js";import"./el-tag-929563f7.js";import"./strings-6464b592.js";import"./Number-4a71bbb3.js";import"./SelectDept-e55ebbaf.js";import"./selectAndShow.vue_vue_type_script_setup_true_lang-a708354f.js";import"./employeesDialog-3166dde1.js";import"./selectBox-a8819872.js";import"./el-checkbox-123bf6dd.js";import"./_overRest-a79e0547.js";/* empty css                */import"./index-8f0c79b2.js";import"./index-126d0406.js";import"./flow-2349aa77.js";import"./selectResult-ca10c7f8.js";import"./orgItem-da1d9713.js";import"./SelectMultiDept-865ded1b.js";import"./SelectMultiUser-f2df4170.js";import"./SelectUser-350b1f1c.js";import"./SingleSelect-4f2549a6.js";import"./Textarea-33dea2bf.js";import"./Time-5f63d134.js";import"./el-time-picker-1aa4e9cb.js";import"./isArrayLikeObject-a5301880.js";import"./UploadFile-9daeda9f.js";import"./el-progress-be452bc9.js";import"./_baseClone-59dac119.js";import"./index-f7c9196e.js";import"./UploadImage-8c59ffb5.js";import"./MultiUpload-c72eb43c.js";import"./plus-95522b44.js";import"./el-tab-pane-5b128a44.js";import"./index-3a646217.js";const so={style:{"text-align":"center"}},lo=S({__name:"startFlow",setup(y,{expose:E}){const i=n(!1),s=n([]),h=n([]),u=n(),x=()=>{if(!N.value.validate()){q.warning("请选择节点执行人");return}let o=N.value.formatSelectNodeUser();s.value.forEach(_=>o[_.id]=_.props.value);for(var e of s.value)if(o[e.id]=e.props.value,e.type==="Layout"){let _=e.props.value;var l=[];for(var c of _){var p={};for(var d of c){let V=d.props.value;p[d.id]=V}l.push(p)}o[e.id]=l}var f={flowId:h.value.flowId,paramMap:o};u.value.validate(function(_){_&&eo(f).then(V=>{i.value=!1})})};E({handle:t=>{h.value=t,F(t)}});const g=n([]),F=t=>{to(t.flowId).then(o=>{const{data:e}=o,{formItems:l}=e;let c=JSON.parse(l);for(var p of c)if(p.type==="Layout"){var d=[];let f=p.props.value;d.push(f),p.props.value=d,p.props.oriForm=L.$deepCopy(f)}s.value=c,g.value=e.selectUserNodeId,i.value=!0})},k=U(()=>{var t={};for(var o of s.value)t[o.id]=o.props.value;return t}),w=t=>{for(var o of s.value){if(o.id!==t)continue;let e=o.props.value,l=o.props.oriForm;e.push(L.$deepCopy(l)),o.props.value=e}},C=(t,o)=>{for(var e of s.value)e.id===t&&e.props.value.splice(o,1)},{proxy:L}=B(),N=n();return(t,o)=>{const e=ro,l=A,c=X,p=Y,d=W;return v(),I("div",null,[r(d,{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=f=>i.value=f),title:"发起流程",width:"800px","destroy-on-close":""},{default:a(()=>[r(p,null,{default:a(()=>[r(c,{span:12},{default:a(()=>[r(e,{"label-position":"top"},{default:a(()=>[r(Z,{onAddLayoutOneItem:w,ref_key:"formRenderRef",ref:u,onDeleteLayoutOneItem:C,"form-list":s.value},null,8,["form-list"])]),_:1}),m("div",so,[r(l,{onClick:o[0]||(o[0]=f=>i.value=!1)},{default:a(()=>[R("取消")]),_:1}),r(l,{type:"primary",onClick:x},{default:a(()=>[R(" 提交 ")]),_:1})])]),_:1}),r(c,{span:12},{default:a(()=>[r(oo,{formData:M(k),selectUserNodeId:g.value,"flow-id":h.value.flowId,ref_key:"flowNodeFormatRef",ref:N},null,8,["formData","selectUserNodeId","flow-id"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),po=y=>(T("data-v-69b8d330"),y=y(),j(),y),no={class:"app-container"},io={class:"card-header"},mo={style:{display:"flex","flex-direction":"row","flex-wrap":"wrap"}},uo={class:"f1"},co={class:"f2"},fo=po(()=>m("div",null,null,-1)),_o=S({__name:"list",setup(y){const E=n();B();const i=n([]);P(),G(()=>{h()});const s=u=>{E.value.handle(u)};function h(){K(!1).then(u=>{const{data:x}=u;i.value=x})}return n(),(u,x)=>{const b=H,g=Q,F=z;return v(),I("div",no,[(v(!0),I($,null,D(i.value,k=>(v(),J(F,{class:"box-card"},{header:a(()=>[m("div",io,[m("span",null,O(k.name),1)])]),default:a(()=>[m("div",mo,[(v(!0),I($,null,D(k.items,(w,C)=>(v(),I("div",{key:C,class:"item"},[m("div",uo,[r(b,{shape:"square",size:50,src:w.logo},null,8,["src"])]),m("div",co,[m("div",null,O(w.name),1),r(g,{onClick:L=>s(w),type:"primary"},{default:a(()=>[R("发起流程")]),_:2},1032,["onClick"]),fo])]))),128))])]),_:2},1024))),256)),r(lo,{ref_key:"startRef",ref:E},null,512)])}}});const Re=ao(_o,[["__scopeId","data-v-69b8d330"]]);export{Re as default};
