(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d792ad5"],{"361e":function(t,e,n){"use strict";var o=n("a237"),r=n.n(o);r.a},"4e02":function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"h",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return l}));var o=n("0c6d");function r(t){return Object(o["a"])({url:"admin/form/group",method:"get",params:t})}function i(t){return Object(o["a"])({url:"admin/form/startGroup",method:"get",params:t})}function s(t){return Object(o["a"])({url:"admin/form/group/sort",method:"put",data:t})}function a(t,e){return Object(o["a"])({url:"admin/form/group",method:e,params:t})}function c(t,e){return Object(o["a"])({url:"admin/form/"+e,method:"put",params:t})}function u(t){return Object(o["a"])({url:"admin/form",method:"post",data:t})}function d(t){return Object(o["a"])({url:"admin/form/detail/"+t,method:"get"})}function l(t){return Object(o["a"])({url:"admin/form/detail",method:"put",data:t})}},"7f4c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"panel",staticClass:"from-panel"},[n("div",{staticClass:"form-title"},[n("span",[t._v("流程面板")]),n("div",[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(e){return t.newProcess("")}}},[t._v("新建表单")]),n("el-button",{attrs:{icon:"el-icon-plus",type:"success",size:"mini"},on:{click:t.addGroup}},[t._v("新建分组")])],1)]),n("draggable",{attrs:{list:t.groups,group:"group",handle:".el-icon-rank",filter:".undrag",options:{animation:300,sort:!0,scroll:!0,chosenClass:"choose"}},on:{start:function(e){t.groupsSort=!0},end:t.groupSort}},t._l(t.groups,(function(e,o){return n("div",{key:o,class:{"form-group":!0,undrag:0===e.id||void 0===e.id}},[n("div",{staticClass:"form-group-title"},[n("span",[t._v(t._s(e.name))]),n("span",[t._v("("+t._s(e.items.length)+")")]),n("i",{staticClass:"el-icon-rank",attrs:{title:"长按拖动可对分组排序"}}),0!==e.id&&void 0!==e.id?n("div",[n("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(n){return t.newProcess(e.id)}}},[t._v("新建表单")]),n("el-dropdown",[n("el-button",{attrs:{type:"text",icon:"el-icon-setting"}},[t._v("编辑分组")]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{icon:"el-icon-edit-outline"},nativeOn:{click:function(n){return t.editGroup(e)}}},[t._v("修改名称")]),n("el-dropdown-item",{attrs:{icon:"el-icon-delete"},nativeOn:{click:function(n){return t.delGroup(e)}}},[t._v("删除分组")])],1)],1)],1):t._e()]),n("draggable",{directives:[{name:"show",rawName:"v-show",value:!t.groupsSort,expression:"!groupsSort"}],staticStyle:{width:"100%","min-height":"25px"},attrs:{list:e.items,group:"from",filter:".undrag",options:{animation:300,delay:200,chosenClass:"choose",scroll:!0,sort:!0}},on:{end:t.groupSort}},t._l(e.items,(function(o,r){return n("div",{key:r,class:{"form-group-item":!0,undrag:o.isStop},attrs:{title:"长按0.5S后可拖拽表单进行排序"}},[n("div",[n("i",{class:o.logo.icon,style:"background: "+o.logo.background}),n("span",[t._v(t._s(o.formName))]),n("br")]),n("div",{staticClass:"desp"},[t._v(t._s(o.remark))]),n("div",[n("span",[t._v("最后更新时间："+t._s(o.updated))])]),n("div",[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline",size:"mini"},on:{click:function(n){return t.editFrom(o,e)}}},[t._v("编辑")]),n("el-button",{attrs:{type:"warning",icon:o.isStop?"el-icon-check":"el-icon-close",size:"mini"},on:{click:function(n){return t.stopFrom(o,e)}}},[t._v(" "+t._s(o.isStop?"启用":"停用")+" ")]),o.isStop?n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.moveFrom(o)}}},[t._v("删除 ")]):n("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"left",trigger:"click",width:"400"},on:{show:function(e){t.moveSelect}}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:t.moveSelect,callback:function(e){t.moveSelect=e},expression:"moveSelect"}},t._l(t.groups,(function(o){return n("el-radio",{directives:[{name:"show",rawName:"v-show",value:o.id>1,expression:"g.id > 1"}],key:o.id,staticStyle:{margin:"10px"},attrs:{label:o.id,border:"",disabled:o.id===e.id}},[t._v(t._s(o.name))])})),1),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.moveFrom(o)}}},[t._v("提交")])],1)],1)],1)])})),0)],1)})),0)],1)},r=[],i=(n("4160"),n("d81d"),n("b0c0"),n("159b"),n("310e")),s=n.n(i),a=n("4e02"),c={name:"FormsPanel",components:{draggable:s.a},data:function(){return{moveSelect:"",visible:!1,groupsSort:!1,groups:[]}},mounted:function(){this.getGroups()},methods:{getGroups:function(){var t=this;Object(a["c"])({hidden:!1}).then((function(e){t.groups=e.data,t.groups.forEach((function(t){t.items.forEach((function(t){t.logo=JSON.parse(t.logo)}))}))})).catch((function(e){return t.$message.error("获取分组异常")}))},newProcess:function(t){console.log("groupid=",t),this.$store.commit("setTemplate",this.getTemplateData()),this.$store.commit("setIsEdit",!1),this.$router.push("/admin/design?groupId="+t)},groupSort:function(){var t=this;this.groupsSort=!1,Object(a["e"])(this.groups.map((function(t){return t.id}))).then((function(e){t.$message.success(e.data),t.getGroups()})).catch((function(e){t.getGroups(),t.$message.error(e.response.data)}))},addGroup:function(){var t=this;this.$prompt("请输入要添加的组名","新的分组名",{confirmButtonText:"提交",cancelButtonText:"取消",inputPattern:/^[\u4E00-\u9FA5A-Za-z0-9\\-]{1,30}$/,inputErrorMessage:"分组名不能为空且长度小于30",inputPlaceholder:"请输入分组名"}).then((function(e){var n=e.value;Object(a["h"])({name:n},"post").then((function(e){t.$message.success(e.data),t.getGroups()})).catch((function(e){return t.$message.error(e.response.data)}))}))},delGroup:function(t){var e=this;console.log(t),t.items.length>0?this.$message.error("当前分组下有表单，不能删除分组"):this.$confirm("确定要删除分组["+t.name+"]吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["h"])({id:t.id},"delete").then((function(t){e.$message.success(t.data),e.getGroups()})).catch((function(t){return e.$message.error(t.response.data)}))}))},editGroup:function(t){var e=this;this.$prompt("请输入新的组名","修改分组名",{confirmButtonText:"提交",cancelButtonText:"取消",inputPattern:/^[\u4E00-\u9FA5A-Za-z0-9\\-]{1,30}$/,inputErrorMessage:"分组名不能为空且长度小于30",inputPlaceholder:"请输入分组名",inputValue:t.name}).then((function(n){var o=n.value;Object(a["h"])({id:t.id,name:o},"put").then((function(t){e.$message.success(t.data),e.getGroups()})).catch((function(t){return e.$message.error(t.response.data)}))}))},updateForm:function(t,e){var n=this;Object(a["f"])({templateId:t.id,type:e},t.formId).then((function(t){n.$message.success(t.data),n.getGroups()})).catch((function(t){return n.$message.error(t.response.data)}))},getTemplateData:function(t,e){return t},editFrom:function(t,e){this.$router.push("/admin/design?code="+t.formId)},stopFrom:function(t,e){var n=this,o=t.isStop?" 启用后将会进入 "+e.name+" 分组，是否继续？":" 停用后将会被转移到 “已停用” 分组，您可以再次启用或者删除它，是否继续?";this.$confirm(t.formName+o,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.updateForm(t,t.isStop?"using":"stop")}))},moveFrom:function(t){var e=this;if(t.isStop)this.$confirm("您确定要删除表单 "+t.formName+" 吗，删除后无法恢复，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.updateForm(t,"delete")}));else{if(null===this.moveSelect||""===this.moveSelect)return void this.$message.error("请选择分组");console.log(t),Object(a["f"])({templateId:t.formId,type:"move",groupId:this.moveSelect},t.formId).then((function(t){e.$message.success(t.data),e.getGroups(),e.moveSelect=null})).catch((function(t){return e.$message.error(t.response.data)}))}}}},u=c,d=(n("361e"),n("2877")),l=Object(d["a"])(u,o,r,!1,null,"0da7016b",null);e["default"]=l.exports},a237:function(t,e,n){},d81d:function(t,e,n){"use strict";var o=n("23e7"),r=n("b727").map,i=n("1dde"),s=n("ae40"),a=i("map"),c=s("map");o({target:"Array",proto:!0,forced:!a||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-0d792ad5.4633384b.js.map