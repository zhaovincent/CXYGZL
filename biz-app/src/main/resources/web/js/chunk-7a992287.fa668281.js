(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a992287"],{"00ce":function(e,t,n){},"0516":function(e,t,n){"use strict";var o=n("9fc7"),i=n.n(o);i.a},"0ff9":function(e,t,n){},"105c":function(e,t,n){"use strict";var o=n("cf06"),i=n.n(o);i.a},1126:function(e,t,n){},"1a94":function(e,t,n){},"1ac9":function(e,t,n){"use strict";var o=n("2ab8"),i=n.n(o);i.a},"1da1":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("d3b7");function o(e,t,n,o,i,r,s){try{var a=e[r](s),l=a.value}catch(c){return void n(c)}a.done?t(l):Promise.resolve(l).then(o,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var s=e.apply(t,n);function a(e){o(s,i,r,a,l,"next",e)}function l(e){o(s,i,r,a,l,"throw",e)}a(void 0)}))}}},"1dcc":function(e,t,n){"use strict";var o=n("f7c3"),i=n.n(o);i.a},"1f10":function(e,t,n){},2120:function(e,t,n){},"2ab8":function(e,t,n){},3396:function(e,t,n){},"41f4":function(e,t,n){e.exports=n.p+"img/code.09fdd434.png"},"439a":function(e,t,n){},"46c6":function(e,t,n){"use strict";var o=n("00ce"),i=n.n(o);i.a},"47d1":function(e,t,n){"use strict";var o=n("905a"),i=n.n(o);i.a},4839:function(e,t,n){},5007:function(e,t,n){"use strict";var o=n("4839"),i=n.n(o);i.a},"50fc":function(e,t,n){"use strict";var o=n("a841"),i=n.n(o);i.a},6062:function(e,t,n){"use strict";var o=n("6d61"),i=n("6566");e.exports=o("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"69be":function(e,t,n){"use strict";var o=n("0ff9"),i=n.n(o);i.a},"6d21":function(e,t,n){"use strict";var o=n("da75"),i=n.n(o);i.a},7247:function(e,t,n){},"7db0":function(e,t,n){"use strict";var o=n("23e7"),i=n("b727").find,r=n("44d2"),s=n("ae40"),a="find",l=!0,c=s(a);a in[]&&Array(1)[a]((function(){l=!1})),o({target:"Array",proto:!0,forced:l||!c},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(a)},8067:function(e,t,n){"use strict";var o=n("a458"),i=n.n(o);i.a},"819a":function(e,t,n){"use strict";var o=n("d9be"),i=n.n(o);i.a},"84c3":function(e,t,n){"use strict";var o=n("a679"),i=n.n(o);i.a},"905a":function(e,t,n){},9091:function(e,t,n){"use strict";var o=n("df57"),i=n.n(o);i.a},"96cf":function(e,t,n){var o=function(e){"use strict";var t,n=Object.prototype,o=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(T){l=function(e,t,n){return e[t]=n}}function c(e,t,n,o){var i=t&&t.prototype instanceof v?t:v,r=Object.create(i.prototype),s=new I(o||[]);return r._invoke=N(e,n,s),r}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=c;var d="suspendedStart",p="suspendedYield",m="executing",f="completed",h={};function v(){}function g(){}function b(){}var y={};y[r]=function(){return this};var _=Object.getPrototypeOf,k=_&&_(_(E([])));k&&k!==n&&o.call(k,r)&&(y=k);var S=b.prototype=v.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(i,r,s,a){var l=u(e[i],e,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"===typeof d&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(l.arg)}var i;function r(e,o){function r(){return new t((function(t,i){n(e,o,t,i)}))}return i=i?i.then(r,r):r()}this._invoke=r}function N(e,t,n){var o=d;return function(i,r){if(o===m)throw new Error("Generator is already running");if(o===f){if("throw"===i)throw r;return P()}n.method=i,n.arg=r;while(1){var s=n.delegate;if(s){var a=C(s,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var l=u(e,t,n);if("normal"===l.type){if(o=n.done?f:p,l.arg===h)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=f,n.method="throw",n.arg=l.arg)}}}function C(e,n){var o=e.iterator[n.method];if(o===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=u(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var r=i.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function $(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function E(e){if(e){var n=e[r];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){while(++i<e.length)if(o.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=S.constructor=b,b.constructor=g,g.displayName=l(b,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,a,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[s]=function(){return this},e.AsyncIterator=x,e.async=function(t,n,o,i,r){void 0===r&&(r=Promise);var s=new x(c(t,n,o,i),r);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(S),l(S,a,"Generator"),S[r]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},e.values=E,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach($),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(o,i){return a.type="throw",a.arg=e,n.next=o,i&&(n.method="next",n.arg=t),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),$(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var i=o.arg;$(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:E(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=o}catch(i){Function("r","regeneratorRuntime = r")(o)}},"99af":function(e,t,n){"use strict";var o=n("23e7"),i=n("d039"),r=n("e8b5"),s=n("861d"),a=n("7b0b"),l=n("50c4"),c=n("8418"),u=n("65f0"),d=n("1dde"),p=n("b622"),m=n("2d00"),f=p("isConcatSpreadable"),h=9007199254740991,v="Maximum allowed index exceeded",g=m>=51||!i((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),b=d("concat"),y=function(e){if(!s(e))return!1;var t=e[f];return void 0!==t?!!t:r(e)},_=!g||!b;o({target:"Array",proto:!0,forced:_},{concat:function(e){var t,n,o,i,r,s=a(this),d=u(s,0),p=0;for(t=-1,o=arguments.length;t<o;t++)if(r=-1===t?s:arguments[t],y(r)){if(i=l(r.length),p+i>h)throw TypeError(v);for(n=0;n<i;n++,p++)n in r&&c(d,p,r[n])}else{if(p>=h)throw TypeError(v);c(d,p++,r)}return d.length=p,d}})},"9fc7":function(e,t,n){},a2c5:function(e){e.exports=JSON.parse('{"id":"3538338","name":"wflow","font_family":"iconfont","css_prefix_text":"icon-","description":"","glyphs":[{"icon_id":"807897","name":"iconfont-kefu","font_class":"iconfontkefu","unicode":"e61c","unicode_decimal":58908},{"icon_id":"1313126","name":"BBD密码","font_class":"mima","unicode":"e648","unicode_decimal":58952},{"icon_id":"2131309","name":"人力社保","font_class":"renlishebao","unicode":"e636","unicode_decimal":58934},{"icon_id":"4774868","name":"部门","font_class":"bumen","unicode":"e758","unicode_decimal":59224},{"icon_id":"6337457","name":"插入图片","font_class":"charutupian","unicode":"ec7f","unicode_decimal":60543},{"icon_id":"2958951","name":"考勤管理","font_class":"kaoqinguanli","unicode":"e610","unicode_decimal":58896},{"icon_id":"3007689","name":"身份证","font_class":"shenfenzheng","unicode":"e614","unicode_decimal":58900},{"icon_id":"5121522","name":"位置","font_class":"weizhi","unicode":"e64b","unicode_decimal":58955},{"icon_id":"7568869","name":"24gf-phoneBubble","font_class":"24gf-phoneBubble","unicode":"e966","unicode_decimal":59750},{"icon_id":"11134714","name":"考勤","font_class":"kaoqin","unicode":"e643","unicode_decimal":58947},{"icon_id":"15972093","name":"会议","font_class":"huiyi","unicode":"e61b","unicode_decimal":58907},{"icon_id":"19883444","name":"加班","font_class":"jiaban","unicode":"e637","unicode_decimal":58935},{"icon_id":"1392555","name":"表格","font_class":"biaoge","unicode":"e665","unicode_decimal":58981},{"icon_id":"3868276","name":"使用文档","font_class":"shiyongwendang","unicode":"eb66","unicode_decimal":60262},{"icon_id":"5881147","name":"多选框","font_class":"duoxuankuang","unicode":"e62e","unicode_decimal":58926},{"icon_id":"26323690","name":"单选","font_class":"danxuan","unicode":"e751","unicode_decimal":59217},{"icon_id":"5032","name":"出租","font_class":"chuzu","unicode":"e600","unicode_decimal":58880},{"icon_id":"1079372","name":"招聘","font_class":"zhaopin","unicode":"e647","unicode_decimal":58951},{"icon_id":"1183143","name":"财务","font_class":"caiwu","unicode":"e67d","unicode_decimal":59005},{"icon_id":"1727267","name":"05采购","font_class":"caigou","unicode":"e887","unicode_decimal":59527},{"icon_id":"1876349","name":"我的产品","font_class":"wodechanpin","unicode":"e679","unicode_decimal":59001},{"icon_id":"1977843","name":"发票管理","font_class":"fapiaoguanli","unicode":"e63b","unicode_decimal":58939},{"icon_id":"7790995","name":"工资","font_class":"gongzi","unicode":"e7e9","unicode_decimal":59369},{"icon_id":"10120009","name":"住房补贴账户","font_class":"zhufangbutiezhanghu","unicode":"e60c","unicode_decimal":58892},{"icon_id":"11435446","name":"维修","font_class":"weixiu","unicode":"e613","unicode_decimal":58899},{"icon_id":"11435453","name":"员工离职","font_class":"yuangonglizhi","unicode":"e615","unicode_decimal":58901},{"icon_id":"11435456","name":"招聘管理","font_class":"zhaopinguanli","unicode":"e616","unicode_decimal":58902},{"icon_id":"12911861","name":"财务","font_class":"caiwu1","unicode":"e603","unicode_decimal":58883},{"icon_id":"14443545","name":"请假申请","font_class":"qingjiashenqing","unicode":"e60d","unicode_decimal":58893},{"icon_id":"14947326","name":"出差","font_class":"ziyuan207","unicode":"e722","unicode_decimal":59170},{"icon_id":"17187052","name":"用餐就餐","font_class":"yongcanjiucan","unicode":"e67e","unicode_decimal":59006},{"icon_id":"18170995","name":"地图组织站点,层级,下级,组织架构布局","font_class":"map-site","unicode":"ea00","unicode_decimal":59904},{"icon_id":"21053836","name":"合同","font_class":"hetong","unicode":"e68a","unicode_decimal":59018},{"icon_id":"21159370","name":"补卡","font_class":"buka","unicode":"e6ca","unicode_decimal":59082},{"icon_id":"24080655","name":"出差","font_class":"chucha","unicode":"e6c7","unicode_decimal":59079},{"icon_id":"24283254","name":"报销申请-费用报销申请-02","font_class":"baoxiaoshenqing-feiyongbaoxiaoshenqing-02","unicode":"e726","unicode_decimal":59174},{"icon_id":"29522596","name":"11C分组,组织树","font_class":"a-11Cfenzuzuzhishu","unicode":"e676","unicode_decimal":58998}]}')},a458:function(e,t,n){},a679:function(e,t,n){},a72f:function(e,t,n){"use strict";var o=n("1f10"),i=n.n(o);i.a},a841:function(e,t,n){},af72:function(e,t,n){"use strict";var o=n("1a94"),i=n.n(o);i.a},b64b:function(e,t,n){var o=n("23e7"),i=n("7b0b"),r=n("df75"),s=n("d039"),a=s((function(){r(1)}));o({target:"Object",stat:!0,forced:a},{keys:function(e){return r(i(e))}})},bb4f:function(e,t,n){},c23f:function(e,t,n){"use strict";var o=n("7247"),i=n.n(o);i.a},c7ea:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("0c6d");function i(e){return Object(o["a"])({url:"/form/selectOptions",method:"post",data:e})}},cf06:function(e,t,n){},d80b:function(e,t,n){"use strict";var o=n("2120"),i=n.n(o);i.a},d8b8:function(e,t,n){"use strict";var o=n("bb4f"),i=n.n(o);i.a},d9be:function(e,t,n){},da75:function(e,t,n){},dbb4:function(e,t,n){var o=n("23e7"),i=n("83ab"),r=n("56ef"),s=n("fc6a"),a=n("06cf"),l=n("8418");o({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(e){var t,n,o=s(e),i=a.f,c=r(o),u={},d=0;while(c.length>d)n=i(o,t=c[d++]),void 0!==n&&l(u,t,n);return u}})},df57:function(e,t,n){},e39d:function(e,t,n){"use strict";var o=n("3396"),i=n.n(o);i.a},e439:function(e,t,n){var o=n("23e7"),i=n("d039"),r=n("fc6a"),s=n("06cf").f,a=n("83ab"),l=i((function(){s(1)})),c=!a||l;o({target:"Object",stat:!0,forced:c,sham:!a},{getOwnPropertyDescriptor:function(e,t){return s(r(e),t)}})},e5e0:function(e,t,n){"use strict";n.r(t);var o,i,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",{staticStyle:{background:"white"}},[n("layout-header",{on:{publish:e.publishProcess,preview:e.preview},model:{value:e.activeSelect,callback:function(t){e.activeSelect=t},expression:"activeSelect"}})],1),n("div",{staticClass:"layout-body"},[n("form-base-setting",{directives:[{name:"show",rawName:"v-show",value:"baseSetting"===e.activeSelect,expression:"activeSelect === 'baseSetting'"}],ref:"baseSetting"}),n("form-design",{directives:[{name:"show",rawName:"v-show",value:"formSetting"===e.activeSelect,expression:"activeSelect === 'formSetting'"}],ref:"formSetting"}),n("process-design",{directives:[{name:"show",rawName:"v-show",value:"processDesign"===e.activeSelect,expression:"activeSelect === 'processDesign'"}],ref:"processDesign"}),n("form-pro-setting",{directives:[{name:"show",rawName:"v-show",value:"proSetting"===e.activeSelect,expression:"activeSelect === 'proSetting'"}],ref:"proSetting"})],1),n("w-dialog",{attrs:{showFooter:!1,title:"设置项检查"},model:{value:e.validVisible,callback:function(t){e.validVisible=t},expression:"validVisible"}},[n("el-steps",{attrs:{"align-center":"",active:e.validStep,"finish-status":"success"}},e._l(e.validOptions,(function(e,t){return n("el-step",{key:t,attrs:{title:e.title,icon:e.icon,status:e.status,description:e.description}})})),1),n("el-result",{attrs:{icon:e.validIcon,title:e.errTitle,subTitle:e.validResult.desc}},[e.validResult.finished?e._e():n("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"30px"},attrs:{slot:"icon"},slot:"icon"}),e.validResult.errs.length>0?n("div",{staticClass:"err-info",attrs:{slot:"subTitle"},slot:"subTitle"},e._l(e.validResult.errs,(function(e,t){return n("ellipsis",{key:t+"_err",attrs:{"hover-tip":"",content:e}},[n("i",{staticClass:"el-icon-warning-outline",attrs:{slot:"pre"},slot:"pre"})])})),1):e._e(),n("template",{slot:"extra"},[e.validResult.finished?n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.doAfter}},[e._v(" "+e._s(e.validResult.action)+" ")]):e._e()],1)],2)],1)],1)},s=[],a=(n("a4d3"),n("e01a"),n("4160"),n("159b"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"header"},[o("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.value,"active-text-color":"#409eff",mode:"horizontal"},on:{select:e.handleSelect}},[o("el-menu-item",{attrs:{index:"baseSetting"},on:{click:function(t){return e.to("baseSetting")}}},[e._v("① 基础信息")]),o("el-menu-item",{attrs:{index:"formSetting"},on:{click:function(t){return e.to("formSetting")}}},[e._v("② 审批表单")]),o("el-menu-item",{attrs:{index:"processDesign"},on:{click:function(t){return e.to("processDesign")}}},[e._v("③ 审批流程 ")]),o("el-menu-item",{attrs:{index:"proSetting"},on:{click:function(t){return e.to("proSetting")}}},[e._v("④ 扩展设置")])],1),o("div",{staticClass:"publish"},[o("el-button",{attrs:{size:"mini"},on:{click:e.preview}},[o("i",{staticClass:"el-icon-view"}),e._v("预览")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.publish}},[o("i",{staticClass:"el-icon-s-promotion"}),e._v("发布")])],1),o("div",{staticClass:"back"},[o("el-button",{attrs:{size:"medium",icon:"el-icon-arrow-left",circle:""},on:{click:e.exit}}),o("span",[o("i",{class:e.setup.logo.icon,style:"background:"+e.setup.logo.background}),o("span",[e._v(e._s(e.setup.formName))])])],1)],1),o("el-dialog",{attrs:{title:"请使用手机扫码预览",visible:e.viewCode,width:"300px","close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.viewCode=t}}},[o("img",{attrs:{src:n("41f4"),width:"250",height:"250"}})])],1)}),l=[],c={name:"LayoutHeader",props:{value:{type:String,default:"baseSetup"}},data:function(){return{viewCode:!1}},computed:{setup:function(){return this.$store.state.design}},created:function(){this.check()},mounted:function(){document.body.offsetWidth<=970&&this.$msgbox.alert("本设计器未适配中小屏幕，建议您在PC电脑端浏览器进行操作"),this.listener()},methods:{publish:function(){this.$emit("publish")},preview:function(){this.$emit("preview"),this.viewCode=!0},valid:function(){return!!this.$isNotEmpty(this.setup.group)||(this.$message.warning("请选择分组"),this.$router.push("/layout/baseSetup"),!1)},exit:function(){var e=this;this.$confirm("未发布的内容将不会被保存，是否直接退出 ?","提示",{confirmButtonText:"退出",cancelButtonText:"取消",type:"warning"}).then((function(){e.$router.push("/formsPanel")}))},to:function(e){this.$emit("input",e)},handleSelect:function(e,t){console.log(e,t)},listener:function(){window.onunload=this.closeBefore(),window.onbeforeunload=this.closeBefore()},closeBefore:function(){return!1},check:function(){this.$store.state.isEdit}}},u=c,d=(n("9091"),n("2877")),p=Object(d["a"])(u,a,l,!1,null,"afbad646",null),m=p.exports,f=n("4e02"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"base-setup",on:{click:function(t){e.showIconSelect=!1}}},[n("el-form",{ref:"baseSetting",attrs:{model:e.setup,"label-position":"top","label-width":"80px"}},[n("el-form-item",{attrs:{label:"表单图标"}},[n("i",{class:e.setup.logo.icon,style:"background:"+e.setup.logo.background}),n("span",{staticClass:"change-icon"},[n("span",[n("span",[e._v("选择背景色")]),n("el-color-picker",{attrs:{"show-alpha":"",size:"small",predefine:e.colors},model:{value:e.setup.logo.background,callback:function(t){e.$set(e.setup.logo,"background",t)},expression:"setup.logo.background"}})],1),n("span",[n("span",[e._v("选择图标")]),n("el-popover",{attrs:{placement:"bottom-start",width:"390",trigger:"click"}},[n("div",{staticClass:"icon-select"},e._l(e.icons,(function(t,o){return n("i",{key:o,class:t,on:{click:function(n){e.setup.logo.icon=t}}})})),0),n("i",{class:e.setup.logo.icon,attrs:{slot:"reference"},slot:"reference"})])],1)])]),n("el-form-item",{attrs:{label:"表单名称",rules:e.getRule("请输入表单名称"),prop:"formName"}},[n("el-input",{attrs:{size:"medium"},model:{value:e.setup.formName,callback:function(t){e.$set(e.setup,"formName",t)},expression:"setup.formName"}})],1),n("el-form-item",{staticClass:"group",attrs:{label:"所在分组",rules:e.getRule("请选择表单分组"),prop:"groupId"}},[n("el-select",{attrs:{placeholder:"请选择分组",size:"medium"},model:{value:e.setup.groupId,callback:function(t){e.$set(e.setup,"groupId",t)},expression:"setup.groupId"}},e._l(e.fromGroup,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1),n("el-popover",{attrs:{placement:"bottom-end",title:"新建表单分组",width:"300",trigger:"click"}},[n("el-input",{attrs:{size:"medium",placeholder:"请输入新的分组名"},model:{value:e.newGroup,callback:function(t){e.newGroup=t},expression:"newGroup"}},[n("el-button",{attrs:{slot:"append",size:"medium",type:"primary"},on:{click:e.addGroup},slot:"append"},[e._v("提交")])],1),n("el-button",{attrs:{slot:"reference",icon:"el-icon-plus",size:"medium",type:"primary"},slot:"reference"},[e._v("新建分组")])],1)],1),n("el-form-item",{attrs:{label:"表单说明"}},[n("el-input",{attrs:{placeholder:"请输入表单说明",type:"textarea","show-word-limit":"",autosize:{minRows:2,maxRows:5},maxlength:"500"},model:{value:e.setup.remark,callback:function(t){e.$set(e.setup,"remark",t)},expression:"setup.remark"}})],1),n("el-form-item",{attrs:{label:"消息通知方式",rules:e.getRule("请选择消息通知方式")}},[n("el-select",{staticStyle:{width:"30%"},attrs:{"value-key":"name",placeholder:"选择消息通知方式",size:"medium",clearable:"",multiple:"","collapse-tags":""},model:{value:e.setup.settings.notify.types,callback:function(t){e.$set(e.setup.settings.notify,"types",t)},expression:"setup.settings.notify.types"}},e._l(e.notifyTypes,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e}})})),1),n("el-input",{staticStyle:{width:"68%",float:"right"},attrs:{size:"medium",placeholder:"消息通知标题"},model:{value:e.setup.settings.notify.title,callback:function(t){e.$set(e.setup.settings.notify,"title",t)},expression:"setup.settings.notify.title"}})],1),n("el-form-item",{attrs:{label:"谁可以管理此表单",rules:e.getRule("请选择管理员")}},[n("el-select",{staticClass:"select-u",attrs:{"value-key":"name",placeholder:"请选择可以管理此表单的人员",size:"medium",multiple:""},nativeOn:{click:function(t){return e.selectUser("admin")}},model:{value:e.setup.settings.admin,callback:function(t){e.$set(e.setup.settings,"admin",t)},expression:"setup.settings.admin"}},e._l(e.setup.settings.admin,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e}})})),1)],1)],1),n("org-picker",{ref:"orgPicker",attrs:{title:"请选择可以管理此表单的人员",type:"user",selected:e.select},on:{ok:e.selected}})],1)},v=[],g=(n("99af"),n("b0c0"),n("498a"),n("709c")),b=n("a2c5"),y={name:"FormBaseSetting",components:{OrgPicker:g["a"]},data:function(){return{nowUserSelect:null,showIconSelect:!1,select:[],newGroup:"",fromGroup:[],notifyTypes:[{type:"APP",name:"应用内通知"},{type:"EMAIL",name:"邮件通知"},{type:"SMS",name:"短信通知"},{type:"WX",name:"微信通知"},{type:"DING",name:"钉钉通知"}],colors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgba(255, 69, 0, 0.68)","rgb(255, 120, 0)","hsl(181, 100%, 37%)","hsla(209, 100%, 56%, 0.73)","#c7158577"],icons:["el-icon-delete-solid","el-icon-s-tools","el-icon-s-goods","el-icon-warning","el-icon-circle-plus","el-icon-camera-solid","el-icon-s-promotion","el-icon-s-cooperation","el-icon-s-platform","el-icon-s-custom","el-icon-s-data","el-icon-s-check","el-icon-s-claim"],rules:{formName:[{}],groupId:[]}}},computed:{setup:function(){return this.$store.state.design},loginUser:function(){return this.$store.state.loginUser}},created:function(){this.loadIconfont()},mounted:function(){console.log("当前登录用户",this.loginUser);var e=this.setup.settings.admin;(!e||e.length<1)&&this.setup.settings.admin.push({id:this.loginUser.id,name:this.loginUser.name,type:"user",avatar:this.loginUser.avatarUrl,selected:!1});var t=this.$route.query.groupId,n=this;this.getGroups((function(){n.$isNotBlank(t)&&(n.setup.groupId=parseInt(t))}))},methods:{getRule:function(e){return[{required:!0,message:e,trigger:"blur"}]},loadIconfont:function(){var e=this;b&&b.id&&b.glyphs.forEach((function(t){e.icons.push("".concat(b.font_family," ").concat(b.css_prefix_text).concat(t.font_class))}))},getGroups:function(e){var t=this;Object(f["c"])({hidden:!1}).then((function(n){t.fromGroup=n.data,e&&e()})).catch((function(e){console.log(e),t.$message.error("获取分组异常")}))},addGroup:function(){var e=this;""!==this.newGroup.trim()&&Object(f["h"])({name:this.newGroup.trim()},"post").then((function(t){e.$message.success(t.data),e.getGroups()})).catch((function(t){return e.$message.error(t.response.data)}))},selected:function(e){this.$set(this.setup.settings,this.nowUserSelect,e)},selectUser:function(e){this.select=this.setup.settings[e],this.nowUserSelect=e,this.$refs.orgPicker.show()},validate:function(){this.$refs.baseSetting.validate();var e=[];return this.$isNotEmpty(this.setup.formName)||e.push("表单名称未设置"),this.$isNotEmpty(this.setup.groupId)||e.push("表单分组未设置"),0===this.setup.settings.notify.types.length&&e.push("审批消息通知方式未设置"),0===this.setup.settings.admin.length&&e.push("流程管理员未设置"),e}}},_=y,k=(n("1ac9"),Object(d["a"])(_,h,v,!1,null,"0cc5d415",null)),S=k.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"calc(100vh - 65px)"}},[n("el-aside",[n("div",{staticClass:"components-nav"},[n("span",{on:{click:function(t){e.libSelect=0}}},[e._v("组件库")])]),n("div",e._l(e.baseComponents,(function(t,o){return n("div",{key:o,staticClass:"components"},[n("p",[e._v(e._s(t.name))]),n("ul",[n("draggable",{staticClass:"drag",attrs:{list:t.components,options:{sort:!1},group:{name:"form",pull:"clone",put:!1},clone:e.clone},on:{start:function(t){e.isStart=!0},end:function(t){e.isStart=!1}}},e._l(t.components,(function(t,o){return n("li",{key:o},[n("i",{class:t.icon}),n("span",[e._v(e._s(t.title))])])})),0)],1)])})),0)]),n("el-main",{staticClass:"layout-main"},[n("div",{staticClass:"tool-nav"},[n("div",[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"撤销",placement:"bottom-start"}},[n("i",{staticClass:"el-icon-refresh-left"})]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"恢复",placement:"bottom-start"}},[n("i",{staticClass:"el-icon-refresh-right"})])],1),n("div",[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"预览表单",placement:"bottom-start"}},[n("i",{staticClass:"el-icon-view",on:{click:e.viewForms}})]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"移动端",placement:"bottom-start"}},[n("i",{class:{"el-icon-mobile":!0,select:e.showMobile},on:{click:function(t){e.showMobile=!0}}})]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"PC端",placement:"bottom-start"}},[n("i",{class:{"el-icon-monitor":!0,select:!e.showMobile},on:{click:function(t){e.showMobile=!1}}})])],1)]),n("div",{staticClass:"work-form"},[n("div",{class:{mobile:e.showMobile,pc:!e.showMobile}},[n("div",{class:{bd:e.showMobile}},[n("div",{class:{"form-content":e.showMobile}},[n("div",{staticClass:"form"},[n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.forms.length&&!e.isStart,expression:"forms.length === 0 && !isStart"}],staticClass:"tip"},[e._v("👈 请在左侧选择控件并拖至此处")]),n("draggable",{staticClass:"drag-from",attrs:{list:e.forms,group:"form",options:{animation:300,chosenClass:"choose",sort:!0}},on:{start:function(t){e.drag=!0,e.selectFormItem=null},end:function(t){e.drag=!1}}},e._l(e.forms,(function(t,o){return n("div",{key:o,staticClass:"form-item",style:e.getSelectedClass(t),on:{click:function(n){return e.selectItem(t)}}},[n("div",{staticClass:"form-header"},[n("p",[t.props&&t.props.required?n("span",[e._v("*")]):e._e(),e._v(e._s(t.title))]),n("div",{staticClass:"option"},[n("i",{staticClass:"el-icon-close",on:{click:function(t){return e.del(o)}}})]),n("form-design-render",{attrs:{config:t}})],1)])})),0)],1)])])])])]),n("el-aside",{staticClass:"layout-param"},[e.selectFormItem?n("div",{staticClass:"tool-nav-r"},[n("i",{class:e.selectFormItem.icon,staticStyle:{"margin-right":"5px","font-size":"medium"}}),n("span",[e._v(e._s(e.selectFormItem.title))])]):e._e(),e.selectFormItem&&0!==e.forms.length?n("div",{staticStyle:{"text-align":"left",padding:"10px"}},[n("form-component-config")],1):n("div",{staticClass:"tip"},[e._v(" 😀 选中控件后在这里进行编辑 ")])]),n("w-dialog",{attrs:{clickClose:"",closeFree:"",width:"800px",showFooter:!1,border:!1,title:"表单预览"},model:{value:e.viewFormVisible,callback:function(t){e.viewFormVisible=t},expression:"viewFormVisible"}},[n("form-render",{ref:"form",attrs:{forms:e.forms},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1)],1)},x=[],N=(n("4de4"),n("a434"),n("d3b7"),n("25f0"),n("6062"),n("3ca3"),n("ddb0"),n("96cf"),n("1da1")),C=n("310e"),O=n.n(C),$=n("2b36"),I=n("d16b"),E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["SpanLayout"!==e.form.name?n("el-form",{attrs:{"label-width":"90px"}},[n("el-form-item",{attrs:{label:"表单名称"}},[n("el-input",{attrs:{size:"small",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),n(e.form.name,{tag:"component",attrs:{fm:e.form},model:{value:e.form.props,callback:function(t){e.$set(e.form,"props",t)},expression:"form.props"}}),n("el-form-item",{attrs:{label:"必填项"}},[n("el-switch",{model:{value:e.form.props.required,callback:function(t){e.$set(e.form.props,"required",t)},expression:"form.props.required"}})],1),n("el-form-item",{attrs:{label:"可打印"}},[n("el-switch",{model:{value:e.form.props.enablePrint,callback:function(t){e.$set(e.form.props,"enablePrint",t)},expression:"form.props.enablePrint"}})],1)],1):n("el-empty",{attrs:{description:"当前组件不支持配置"}})],1)},P=[],T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"最小长度"}},[n("el-input-number",{attrs:{min:0,max:1e3,label:"字符串最小长度"},model:{value:e.value.minLength,callback:function(t){e.$set(e.value,"minLength",t)},expression:"value.minLength"}})],1),n("el-form-item",{attrs:{label:"最大长度"}},[n("el-input-number",{attrs:{min:0,max:1e3,label:"字符串最大长度"},model:{value:e.value.maxLength,callback:function(t){e.$set(e.value,"maxLength",t)},expression:"value.maxLength"}})],1),n("el-form-item",{attrs:{label:"正则表达式"}},[n("el-input",{attrs:{size:"small",placeholder:"^\\d+$"},model:{value:e.value.regex,callback:function(t){e.$set(e.value,"regex",t)},expression:"value.regex"}}),n("el-input",{attrs:{size:"small",placeholder:"请设置验证提示语"},model:{value:e.value.regexMsg,callback:function(t){e.$set(e.value,"regexMsg",t)},expression:"value.regexMsg"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-input",{model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}})],1)],1)},L=[],R={name:"TextInput",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},U=R,F=Object(d["a"])(U,T,L,!1,null,"58c717b2",null),D=F.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"小数位数"}},[n("el-input-number",{attrs:{min:0,max:8,label:"精度"},model:{value:e.value.precision,callback:function(t){e.$set(e.value,"precision",t)},expression:"value.precision"}})],1),n("el-form-item",{attrs:{label:"最小值"}},[n("el-input-number",{attrs:{precision:e.value.precision,label:"最小值"},model:{value:e.value.minNum,callback:function(t){e.$set(e.value,"minNum",t)},expression:"value.minNum"}})],1),n("el-form-item",{attrs:{label:"最大值"}},[n("el-input-number",{attrs:{precision:e.value.precision,label:"最大值"},model:{value:e.value.maxNum,callback:function(t){e.$set(e.value,"maxNum",t)},expression:"value.maxNum"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-input",{attrs:{type:"number"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}})],1)],1)},M=[],z={name:"NumberInput",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},A=z,B=Object(d["a"])(A,j,M,!1,null,"551e2b54",null),V=B.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"保留小数"}},[n("el-input-number",{attrs:{"controls-position":"right",precision:0,max:3,min:0,size:"small",placeholder:"小数位数"},model:{value:e.value.precision,callback:function(t){e.$set(e.value,"precision",t)},expression:"value.precision"}}),e._v(" 位 ")],1),n("el-form-item",{attrs:{label:"最小值"}},[n("el-input-number",{attrs:{precision:e.value.precision,label:"最小值"},model:{value:e.value.minNum,callback:function(t){e.$set(e.value,"minNum",t)},expression:"value.minNum"}})],1),n("el-form-item",{attrs:{label:"最大值"}},[n("el-input-number",{attrs:{precision:e.value.precision,label:"最大值"},model:{value:e.value.maxNum,callback:function(t){e.$set(e.value,"maxNum",t)},expression:"value.maxNum"}})],1),n("el-form-item",{attrs:{label:"展示大写"}},[n("el-switch",{model:{value:e.value.showChinese,callback:function(t){e.$set(e.value,"showChinese",t)},expression:"value.showChinese"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-input",{attrs:{type:"number"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}})],1)],1)},W=[],H={name:"AmountInputConfig",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},K=H,q=Object(d["a"])(K,G,W,!1,null,"d0ba91a2",null),J=q.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"最小长度"}},[n("el-input-number",{attrs:{min:0,max:1e3,label:"字符串最小长度"},model:{value:e.value.minLength,callback:function(t){e.$set(e.value,"minLength",t)},expression:"value.minLength"}})],1),n("el-form-item",{attrs:{label:"最大长度"}},[n("el-input-number",{attrs:{min:0,max:1e3,label:"字符串最大长度"},model:{value:e.value.maxLength,callback:function(t){e.$set(e.value,"maxLength",t)},expression:"value.maxLength"}})],1),n("el-form-item",{attrs:{label:"正则表达式"}},[n("el-input",{attrs:{size:"small",placeholder:"^\\d+$"},model:{value:e.value.regex,callback:function(t){e.$set(e.value,"regex",t)},expression:"value.regex"}}),n("el-input",{attrs:{size:"small",placeholder:"请设置验证提示语"},model:{value:e.value.regexMsg,callback:function(t){e.$set(e.value,"regexMsg",t)},expression:"value.regexMsg"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}})],1)],1)},X=[],Q={name:"TextareaInput",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},Z=Q,ee=Object(d["a"])(Z,Y,X,!1,null,"2032c45c",null),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form",{attrs:{"label-position":"top"}},[n("el-form-item",{staticClass:"options",attrs:{label:"选项设置"}},[n("div",{staticClass:"option-item-label",attrs:{slot:"label"},slot:"label"},[n("span",[e._v("选项设置")])]),e.value.optionsFromRemote?e._e():[n("el-button",{attrs:{icon:"el-icon-plus",type:"text",size:"mini"},on:{click:function(t){return e.value.options.push({key:"",value:""})}}},[e._v("新增选项 ")]),n("draggable",{attrs:{list:e.value.options,group:"option",handler:".el-icon-rank",options:e.dragOption}},e._l(e.value.options,(function(t,o){return n("div",{key:o,staticClass:"option-item"},[n("i",{staticClass:"el-icon-rank"}),n("el-input",{attrs:{clearable:"",placeholder:"请设置选项key值"},model:{value:e.value.options[o].key,callback:function(t){e.$set(e.value.options[o],"key",t)},expression:"value.options[index].key"}}),n("el-input",{attrs:{size:"medium",placeholder:"请设置选项value值",clearable:""},model:{value:e.value.options[o].value,callback:function(t){e.$set(e.value.options[o],"value",t)},expression:"value.options[index].value"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-delete",type:"danger",size:"medium"},on:{click:function(t){return e.value.options.splice(o,1)}},slot:"append"})],1)],1)})),0)]],2)],1),e.value.optionsFromRemote?[n("el-form-item",{attrs:{label:"请求地址"}},[n("el-input",{attrs:{size:"small",placeholder:"获取选项地址"},on:{blur:e.blurEvent},model:{value:e.value.remoteUrl,callback:function(t){e.$set(e.value,"remoteUrl",t)},expression:"value.remoteUrl"}})],1)]:e._e(),n("el-form-item",{attrs:{label:"选项展开"}},[n("el-switch",{model:{value:e.value.expanding,callback:function(t){e.$set(e.value,"expanding",t)},expression:"value.expanding"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-select",{attrs:{multiple:"MultipleSelect"===e.fm.name,placeholder:"请选择"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}},[e.value.optionsFromRemote?e._l(e.value.remoteOptions,(function(e){return n("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})})):e._l(e.value.options,(function(e){return n("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})}))],2)],1)],2)},oe=[],ie=n("c7ea"),re={name:"SelectInputConfig",components:{draggable:O.a},props:{value:{type:Object,default:function(){return{}}},fm:{type:Object,default:function(){return{}}}},mounted:function(){console.log(this.fm)},data:function(){return{dragOption:{animation:300,sort:!0}}},methods:{blurEvent:function(e){this.queryRemoteOption()},queryRemoteOption:function(){var e=this;Object(ie["a"])({remoteUrl:this.value.remoteUrl}).then((function(t){var n=t.data;e.value.remoteOptions=n}))}}},se=re,ae=(n("46c6"),Object(d["a"])(se,ne,oe,!1,null,"e1705edc",null)),le=ae.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置日期提示"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"默认值"}},["time"==e.dateType?n("el-time-picker",{staticStyle:{width:"100%"},attrs:{"arrow-control":"","value-format":"HH:mm:ss",format:"HH:mm:ss",size:"medium"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}}):e._e(),"datetime"==e.dateType?n("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",size:"medium",clearable:"",type:"datetime"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}}):e._e(),"date"==e.dateType?n("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",size:"medium",clearable:"",type:"date"},model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}}):e._e()],1)],1)},ue=[],de=n("ec61"),pe={name:"DateTime",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{value:{type:Object,default:function(){return{}}},fm:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{dateType:function(){return this.value.dateType}},mounted:function(){console.log(this.value.dateType)},methods:{}},me=pe,fe=Object(d["a"])(me,ce,ue,!1,null,"40b3ba23",null),he=fe.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"开始日期提示"},model:{value:e.value.placeholder[0],callback:function(t){e.$set(e.value.placeholder,0,t)},expression:"value.placeholder[0]"}}),n("el-input",{attrs:{size:"small",placeholder:"结束日期提示"},model:{value:e.value.placeholder[1],callback:function(t){e.$set(e.value.placeholder,1,t)},expression:"value.placeholder[1]"}})],1),n("el-form-item",{attrs:{label:"日期格式"}},[n("el-select",{attrs:{size:"small"},model:{value:e.value.format,callback:function(t){e.$set(e.value,"format",t)},expression:"value.format"}},[n("el-option",{attrs:{value:"yyyy",label:"年"}}),n("el-option",{attrs:{value:"yyyy-MM",label:"年-月"}}),n("el-option",{attrs:{value:"yyyy-MM-dd",label:"年-月-日"}}),n("el-option",{attrs:{value:"yyyy-MM-dd HH:mm",label:"年-月-日 时:分"}})],1)],1),n("el-form-item",{attrs:{label:"展示时长"}},[n("el-switch",{model:{value:e.value.showLength,callback:function(t){e.$set(e.value,"showLength",t)},expression:"value.showLength"}})],1)],1)},ge=[],be={name:"DateTimeRangeConfig",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},ye=be,_e=Object(d["a"])(ye,ve,ge,!1,null,"67d8df9a",null),ke=_e.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"数量限制"}},[n("tip",{attrs:{slot:"label",content:"限制最大上传图片数量（为0则不限制）"},slot:"label"},[e._v("数量限制")]),n("el-input-number",{staticClass:"max-fill",attrs:{"controls-position":"right",precision:0,size:"small",placeholder:"最多上传几张图片"},model:{value:e.value.maxNumber,callback:function(t){e.$set(e.value,"maxNumber",t)},expression:"value.maxNumber"}})],1),n("el-form-item",{attrs:{label:"大小限制"}},[n("tip",{attrs:{slot:"label",content:"限制单个图片最大大小-MB（为0则不限制）"},slot:"label"},[e._v("大小限制")]),n("el-input-number",{staticClass:"max-fill",attrs:{"controls-position":"right",precision:1,size:"small",placeholder:"单个文件最大大小"},model:{value:e.value.maxSize,callback:function(t){e.$set(e.value,"maxSize",t)},expression:"value.maxSize"}})],1)],1)},we=[],xe={name:"ImageUploadConfig",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},Ne=xe,Ce=(n("84c3"),Object(d["a"])(Ne,Se,we,!1,null,"7e7df115",null)),Oe=Ce.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"数量限制"}},[n("tip",{attrs:{slot:"label",content:"限制最大上传图片数量（为0则不限制）"},slot:"label"},[e._v("数量限制")]),n("el-input-number",{staticClass:"max-fill",attrs:{"controls-position":"right",precision:0,size:"small",placeholder:"最多上传几张图片"},model:{value:e.value.maxNumber,callback:function(t){e.$set(e.value,"maxNumber",t)},expression:"value.maxNumber"}})],1),n("el-form-item",{attrs:{label:"大小限制"}},[n("tip",{attrs:{slot:"label",content:"限制单个文件最大大小-MB（为0则不限制）"},slot:"label"},[e._v("大小限制")]),n("el-input-number",{staticClass:"max-fill",attrs:{"controls-position":"right",precision:1,size:"small",placeholder:"单个文件最大大小"},model:{value:e.value.maxSize,callback:function(t){e.$set(e.value,"maxSize",t)},expression:"value.maxSize"}})],1),n("el-form-item",{attrs:{label:"类型限制"}},[n("tip",{attrs:{slot:"label",content:"限制上传文件的后缀类型"},slot:"label"},[e._v("类型限制")]),n("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",multiple:"",filterable:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"允许上传文件的后缀格式，可设置多种"},model:{value:e.value.fileTypes,callback:function(t){e.$set(e.value,"fileTypes",t)},expression:"value.fileTypes"}})],1),n("el-form-item",{attrs:{label:"不可下载"}},[n("el-switch",{model:{value:e.value.onlyRead,callback:function(t){e.$set(e.value,"onlyRead",t)},expression:"value.onlyRead"}})],1)],1)},Ie=[],Ee={name:"FileUploadConfig",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},Pe=Ee,Te=(n("d8b8"),Object(d["a"])(Pe,$e,Ie,!1,null,"d3b6f30e",null)),Le=Te.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示内容"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示内容"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"文字颜色"}},[n("el-color-picker",{attrs:{size:"medium"},model:{value:e.value.color,callback:function(t){e.$set(e.value,"color",t)},expression:"value.color"}})],1)],1)},Ue=[],Fe={name:"Description",components:{},props:{value:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},De=Fe,je=Object(d["a"])(De,Re,Ue,!1,null,"14e4d03c",null),Me=je.exports,ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},Ae=[],Be={name:"MoneyInput",components:{},data:function(){return{}},methods:{}},Ve=Be,Ge=Object(d["a"])(Ve,ze,Ae,!1,null,"5dfb482a",null),We=Ge.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"请设置提示语"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"是否多选"}},[n("el-switch",{model:{value:e.value.multiple,callback:function(t){e.$set(e.value,"multiple",t)},expression:"value.multiple"}})],1),n("el-form-item",{attrs:{label:"默认值"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:e.selectNoSetUser}},[e._v("选择")]),n("org-items",{model:{value:e.value.value,callback:function(t){e.$set(e.value,"value",t)},expression:"value.value"}}),n("org-picker",{ref:"orgPicker",attrs:{title:"选择默认值",multiple:e.value.multiple,type:e.pickerType(),selected:e.orgPickerSelected()},on:{ok:e.selected}})],1)],1)},Ke=[],qe={name:"OrgPickerA",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{value:{type:Object,default:function(){return{}}},fm:{type:Object,default:function(){return{}}}},mounted:function(){},data:function(){return{defaultValue:{}}},computed:{formId:function(){return this.fm.id}},watch:{},methods:{orgPickerSelected:function(){return this.initData(),this.defaultValue[this.fm.id].orgPickerSelected},pickerType:function(){return this.initData(),this.defaultValue[this.fm.id].selectOrgType},selectNoSetUser:function(){this.initData(),this.defaultValue[this.fm.id].orgPickerSelected=this.value.value,this.$refs.orgPicker.show()},initData:function(){var e=this.defaultValue[this.fm.id];e||this.$set(this.defaultValue,this.fm.id,{selectOrgType:"DeptPicker"===this.fm.name?"dept":"user",orgPickerSelected:[]})},selected:function(e){this.initData();var t=this.defaultValue[this.fm.id];t.orgPickerSelected.splice(0,t.orgPickerSelected.length),e.forEach((function(e){return t.orgPickerSelected.push(e)})),this.value.value=t.orgPickerSelected}}},Je=qe,Ye=Object(d["a"])(Je,He,Ke,!1,null,"ced94078",null),Xe=Ye.exports,Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form-item",{attrs:{label:"提示文字"}},[n("el-input",{attrs:{size:"small",placeholder:"提醒添加记录的提示"},model:{value:e.value.placeholder,callback:function(t){e.$set(e.value,"placeholder",t)},expression:"value.placeholder"}})],1),n("el-form-item",{attrs:{label:"最大行数"}},[n("tip",{attrs:{slot:"label",content:"允许添加多少条记录（为0则不限制）"},slot:"label"},[e._v("最大行数")]),n("el-input-number",{attrs:{"controls-position":"right",precision:0,max:100,min:0,size:"small",placeholder:"限制条数"},model:{value:e.value.maxSize,callback:function(t){e.$set(e.value,"maxSize",t)},expression:"value.maxSize"}})],1),n("el-form-item",{attrs:{label:"展示合计"}},[n("el-switch",{model:{value:e.value.showSummary,callback:function(t){e.$set(e.value,"showSummary",t)},expression:"value.showSummary"}}),e.value.showSummary?n("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",multiple:"",clearable:"",placeholder:"请选择合计项"},model:{value:e.value.summaryColumns,callback:function(t){e.$set(e.value,"summaryColumns",t)},expression:"value.summaryColumns"}},e._l(e.columns,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1):e._e()],1),n("el-form-item",{attrs:{label:"展示边框"}},[n("el-switch",{model:{value:e.value.showBorder,callback:function(t){e.$set(e.value,"showBorder",t)},expression:"value.showBorder"}})],1)],1)},Ze=[],et={name:"TableListConfig",components:{},props:{value:{type:Object,default:function(){return{}}}},mounted:function(){console.log(this.value)},computed:{columns:function(){return this.value.columns.filter((function(e){return"Number"===e.valueType}))}},data:function(){return{}},methods:{}},tt=et,nt=Object(d["a"])(tt,Qe,Ze,!1,null,"1f360782",null),ot=nt.exports,it={name:"FormComponentConfig",components:{TextInput:D,NumberInput:V,AmountInput:J,TextareaInput:te,SelectInput:le,MultipleSelect:le,DateTime:he,DateTimeRange:ke,ImageUpload:Oe,FileUpload:Le,Description:Me,MoneyInput:We,DeptPicker:Xe,UserPicker:Xe,TableList:ot},props:{},computed:{form:function(){return this.$store.state.selectFormItem}},data:function(){return{}},methods:{}},rt=it,st=Object(d["a"])(rt,E,P,!1,null,"596b26b1",null),at=st.exports,lt=n("8032"),ct={name:"FormDesign",components:{draggable:O.a,FormComponentConfig:at,FormDesignRender:I["a"],FormRender:$["a"]},data:function(){return{formData:{},libSelect:0,viewFormVisible:!1,isStart:!1,showMobile:!0,baseComponents:lt["b"],select:null,drag:!1}},computed:{forms:function(){return this.$store.state.design.formItems},selectFormItem:{get:function(){return this.$store.state.selectFormItem},set:function(e){this.$store.state.selectFormItem=e}},nodeMap:function(){return this.$store.state.nodeMap}},methods:{copy:function(e,t){this.form.splice(t+1,0,Object.assign({},e))},getId:function(){return"field"+(Math.floor(89999*Math.random())+1e4).toString()+(new Date).getTime().toString().substring(5)},del:function(e){var t=this;this.$confirm("删除组件将会连带删除包含该组件的条件以及相关设置，是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning"}).then((function(){"SpanLayout"===t.forms[e].name?(t.forms[e].props.items.forEach((function(e){t.removeFormItemAbout(e)})),t.forms[e].props.items.length=0):t.removeFormItemAbout(t.forms[e]),t.forms.splice(e,1)}))},removeFormItemAbout:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.nodeMap.forEach((function(t){"CONDITION"!==t.type&&"CONDITION"!==t.type||t.props.groups.forEach((function(t){t.conditions=t.conditions.filter((function(t){return t.id!=e.id}))})),"ROOT"!==t.type&&"APPROVAL"!==t.type&&"CC"!==t.type||(t.props.formPerms.removeByKey("id",e.id),t.props.formUser===e.id&&(t.props.formUser=""))}));case 1:case"end":return n.stop()}}),n)})))()},clone:function(e){return e.id=this.getId(),JSON.parse(JSON.stringify(e))},viewForms:function(){this.viewFormVisible=!0},selectItem:function(e){this.selectFormItem=e},getSelectedClass:function(e){return this.selectFormItem&&this.selectFormItem.id===e.id?"border-left: 4px solid #409eff":""},validateItem:function(e,t,n){var o=this;t.has(n.title)&&"SpanLayout"!==n.name&&e.push("表单 ".concat(n.title," 名称重复")),t.add(n.title),"TextInput"!==n.name&&'"TextareaInput"'!==n.name||(n.props.minLength||0==n.props.minLength||e.push("".concat(n.title," 未设置最小长度")),n.props.maxLength||e.push("".concat(n.title," 未设置最大长度")),n.props.minLength&&n.props.maxLength&&n.props.minLength>n.props.maxLength&&e.push("".concat(n.title," 长度设置错误")),n.props.regex.length>0&&n.props.regexMsg.length<1&&e.push("".concat(n.title," 未设置正则表达式验证失败提示语"))),"NumberInput"!==n.name&&"AmountInput"!==n.name||(n.props.precision||0==n.props.precision||e.push("".concat(n.title," 未设置精度")),n.props.minNum&&n.props.maxNum&&n.props.minNum>n.props.maxNum&&e.push("".concat(n.title," 最小值不应大于最大值"))),"ImageUpload"!==n.name&&"FileUpload"!==n.name||((!n.props.maxNumber||n.props.maxNumber<=0)&&e.push("".concat(n.title," 未设置数量限制")),(!n.props.maxSize||n.props.maxSize<=0)&&e.push("".concat(n.title," 未设置大小限制"))),"SelectInput"===n.name||"MultipleSelect"===n.name?(0===n.props.options.length&&e.push("".concat(n.title," 未设置选项")),n.props.optionsFromRemote&&n.props.remoteUrl.length<=0&&e.push("".concat(n.title," 未设置远程请求URL")),n.props.optionsFromRemote&&(!n.props.remoteOptions||n.props.remoteOptions.length<=0)&&e.push("".concat(n.title," 未获取到选项"))):"TableList"===n.name?0===n.props.columns.length&&e.push("明细表 ".concat(n.title," 内未添加组件")):"SpanLayout"===n.name&&(0===n.props.items.length?e.push("分栏内未添加组件"):n.props.items.forEach((function(n){return o.validateItem(e,t,n)})))},validate:function(){var e=this,t=[];if(this.forms.length>0){var n=new Set;this.forms.forEach((function(o){e.validateItem(t,n,o)}))}else t.push("表单为空，请添加组件");return t}}},ut=ct,dt=(n("e39d"),Object(d["a"])(ut,w,x,!1,null,"16978bde",null)),pt=dt.exports,mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-main",[n("div",{staticClass:"design",style:"transform: scale("+e.scale/100+");"},[n("process-tree",{ref:"process-tree",on:{selectedNode:e.nodeSelected}})],1),n("el-drawer",{attrs:{title:e.selectedNode.name,visible:e.showConfig,"modal-append-to-body":!1,size:"CONDITION"===e.selectedNode.type||"CONDITION"===e.selectedNode.type?"600px":"500px",direction:"rtl",modal:!1,"destroy-on-close":""},on:{"update:visible":function(t){e.showConfig=t}}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.showInput,expression:"showInput"}],staticStyle:{width:"300px"},attrs:{size:"medium"},on:{blur:function(t){e.showInput=!1}},model:{value:e.selectedNode.name,callback:function(t){e.$set(e.selectedNode,"name",t)},expression:"selectedNode.name"}}),n("el-link",{directives:[{name:"show",rawName:"v-show",value:!e.showInput,expression:"!showInput"}],staticStyle:{"font-size":"medium"},on:{click:function(t){e.showInput=!0}}},[n("i",{staticClass:"el-icon-edit",staticStyle:{"margin-right":"10px"}}),e._v(" "+e._s(e.selectedNode.name)+" ")])],1),n("div",{staticClass:"node-config-content"},[n("node-config")],1)])],1)},ft=[],ht=(n("c975"),n("d81d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:e.config.name,"show-error":e.showError,content:e.content,"error-info":e.errorInfo,placeholder:"请设置审批人","header-bgc":"#ff943e","header-icon":"el-icon-s-check"},on:{selected:function(t){return e.$emit("selected")},delNode:function(t){return e.$emit("delNode")},insertNode:function(t){return e.$emit("insertNode",t)}}})}),vt=[],gt=(n("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{node:!0,root:e.isRoot||!e.show,"node-error-state":e.showError}},[e.show?n("div",{class:{"node-body":!0,error:e.showError},on:{click:function(t){return e.$emit("selected")}}},[n("div",[n("div",{staticClass:"node-body-header",style:{"background-color":e.headerBgc}},[""!==(e.headerIcon||"")?n("i",{class:e.headerIcon,staticStyle:{"margin-right":"5px"}}):e._e(),n("ellipsis",{staticClass:"name",attrs:{"hover-tip":"",content:e.title}}),e.isRoot?e._e():n("i",{staticClass:"el-icon-close",staticStyle:{float:"right"},on:{click:function(t){return e.$emit("delNode")}}})],1),n("div",{staticClass:"node-body-content"},[e.leftIcon?n("i",{class:e.leftIcon}):e._e(),""===(e.content||"").trim()?n("span",{staticClass:"placeholder"},[e._v(e._s(e.placeholder))]):n("ellipsis",{attrs:{row:3,content:e.content}}),n("i",{staticClass:"el-icon-arrow-right"})],1),e.showError?n("div",{staticClass:"node-error"},[n("el-tooltip",{attrs:{effect:"dark",content:e.errorInfo,placement:"top-start"}},[n("i",{staticClass:"el-icon-warning-outline"})])],1):e._e()])]):e._e(),n("div",{staticClass:"node-footer"},[n("div",{staticClass:"btn"},[n("insert-button",{on:{insertNode:function(t){return e.$emit("insertNode",t)}}})],1)])])}),bt=[],yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-popover",{attrs:{placement:"bottom-start",title:"添加流程节点",width:"350",trigger:"click"}},[n("div",{staticClass:"node-select"},[n("div",{on:{click:e.addApprovalNode}},[n("i",{staticClass:"el-icon-s-check",staticStyle:{color:"rgb(255, 148, 62)"}}),n("span",[e._v("审批人")])]),n("div",{on:{click:e.addCcNode}},[n("i",{staticClass:"el-icon-s-promotion",staticStyle:{color:"rgb(50, 150, 250)"}}),n("span",[e._v("抄送人")])]),n("div",{on:{click:e.addConditionsNode}},[n("i",{staticClass:"el-icon-share",staticStyle:{color:"rgb(21, 188, 131)"}}),n("span",[e._v("条件分支")])]),n("div",{on:{click:e.addConcurrentsNode}},[n("i",{staticClass:"el-icon-s-operation",staticStyle:{color:"#718dff"}}),n("span",[e._v("并行分支")])]),n("div",{on:{click:e.addInclusivesNode}},[n("i",{staticClass:"el-icon-s-grid",staticStyle:{color:"#ff8c00"}}),n("span",[e._v("包容分支")])]),n("div",{on:{click:e.addDelayNode}},[n("i",{staticClass:"el-icon-time",staticStyle:{color:"#f25643"}}),n("span",[e._v("延迟等待")])]),n("div",{on:{click:e.addTriggerNode}},[n("i",{staticClass:"el-icon-set-up",staticStyle:{color:"#15BC83"}}),n("span",[e._v("触发器")])])]),n("el-button",{attrs:{slot:"reference",icon:"el-icon-plus",type:"primary",size:"small",circle:""},slot:"reference"})],1)},_t=[],kt={name:"InsertButton",components:{},data:function(){return{}},computed:{selectedNode:function(){this.$store.state.selectedNode}},methods:{addApprovalNode:function(){this.$emit("insertNode","APPROVAL")},addCcNode:function(){this.$emit("insertNode","CC")},addDelayNode:function(){this.$emit("insertNode","DELAY")},addConditionsNode:function(){this.$emit("insertNode","CONDITIONS")},addInclusivesNode:function(){this.$emit("insertNode","INCLUSIVES")},addConcurrentsNode:function(){this.$emit("insertNode","CONCURRENTS")},addTriggerNode:function(){this.$emit("insertNode","TRIGGER")},addChildProcessNode:function(){this.$emit("insertNode","CHILD_PROCESS")}}},St=kt,wt=(n("0516"),Object(d["a"])(St,yt,_t,!1,null,"8f7522bc",null)),xt=wt.exports,Nt={name:"Node",components:{InsertButton:xt},props:{isRoot:{type:Boolean,default:!1},show:{type:Boolean,default:!0},content:{type:String,default:""},title:{type:String,default:"标题"},placeholder:{type:String,default:"请设置"},leftIcon:{type:String,default:void 0},headerIcon:{type:String,default:""},headerBgc:{type:String,default:"#576a95"},showError:{type:Boolean,default:!1},errorInfo:{type:String,default:"无信息"}},data:function(){return{}},methods:{}},Ct=Nt,Ot=(n("5007"),Object(d["a"])(Ct,gt,bt,!1,null,"e5c46912",null)),$t=Ot.exports,It={name:"ApprovalNode",props:{config:{type:Object,default:function(){return{}}}},watch:{content:function(e){console.log("********",e),this.config.props.placeholder=e}},mounted:function(){},components:{Node:$t},data:function(){return{showError:!1,errorInfo:""}},computed:{content:function(){var e=this.config.props;switch(e.assignedType){case"ASSIGN_USER":if(e.assignedUser.length>0){var t=[];return e.assignedUser.forEach((function(e){return t.push(e.name)})),String(t).replaceAll(",","、")}return"请指定审批人";case"SELF":return"发起人自己";case"SELF_SELECT":return e.selfSelect.multiple?"发起人自选多人":"发起人自选一人";case"LEADER_TOP":return"多级主管依次审批";case"LEADER":return e.leader.level>1?"发起人的第 "+e.leader.level+" 级主管":"发起人的直接主管";case"FORM_USER":if(e.formUser&&""!==e.formUser){var n=this.getFormItemById(e.formUser);return n&&n.title?"表单（".concat(n.title,"）内的人员"):"该表单已被移除😥"}return"表单内联系人（未选择）";case"ROLE":return e.role.length>0?String(e.role).replaceAll(",","、"):"指定角色（未设置）";default:return"未知设置项😥"}}},methods:{getFormItemById:function(e){return this.$store.state.design.formItems.find((function(t){return t.id===e}))},validate:function(e){try{return this.showError=!this["validate_".concat(this.config.props.assignedType)](e)}catch(t){return!0}},validate_ASSIGN_USER:function(e){return this.config.props.assignedUser.length>0||(this.errorInfo="请指定审批人员",e.push("".concat(this.config.name," 未指定审批人员")),!1)},validate_SELF_SELECT:function(e){return!0},validate_LEADER_TOP:function(e){return!0},validate_LEADER:function(e){return!0},validate_ROLE:function(e){return!(this.config.props.role.length<=0)||(this.errorInfo="请指定负责审批的系统角色",e.push("".concat(this.config.name," 未指定审批角色")),!1)},validate_SELF:function(e){return!0},validate_FORM_USER:function(e){return""!==this.config.props.formUser||(this.errorInfo="请指定表单中的人员组件",e.push("".concat(this.config.name," 审批人为表单中人员，但未指定")),!1)},validate_REFUSE:function(e){return!0}}},Et=It,Pt=Object(d["a"])(Et,ht,vt,!1,null,"1e81e764",null),Tt=Pt.exports,Lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:e.config.name,"show-error":e.showError,content:e.content,"error-info":e.errorInfo,placeholder:"请设置抄送人","header-bgc":"#3296fa","header-icon":"el-icon-s-promotion"},on:{selected:function(t){return e.$emit("selected")},delNode:function(t){return e.$emit("delNode")},insertNode:function(t){return e.$emit("insertNode",t)}}})},Rt=[],Ut={name:"CcNode",props:{config:{type:Object,default:function(){return{}}}},mounted:function(){},components:{Node:$t},data:function(){return{showError:!1,errorInfo:""}},computed:{content:function(){if(this.config.props.shouldAdd)return"由发起人指定";if(this.config.props.assignedUser.length>0){var e=[];return this.config.props.assignedUser.forEach((function(t){return e.push(t.name)})),String(e).replaceAll(",","、")}return null}},methods:{validate:function(e){return this.showError=!1,this.config.props.shouldAdd?this.showError=!1:0===this.config.props.assignedUser.length&&(this.showError=!0,this.errorInfo="请选择需要抄送的人员"),this.showError&&e.push("抄送节点 ".concat(this.config.name," 未设置抄送人")),!this.showError}}},Ft=Ut,Dt=Object(d["a"])(Ft,Lt,Rt,!1,null,"f4373ea4",null),jt=Dt.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node"},[n("div",{staticClass:"node-body",on:{click:function(t){return e.$emit("selected")}}},[e.level>1?n("div",{staticClass:"node-body-left",on:{click:function(t){return t.stopPropagation(),e.$emit("leftMove")}}},[n("i",{staticClass:"el-icon-arrow-left"})]):e._e(),n("div",{staticClass:"node-body-main"},[n("div",{staticClass:"node-body-main-header"},[n("span",{staticClass:"title"},[n("i",{staticClass:"el-icon-s-operation"}),n("ellipsis",{staticClass:"name",attrs:{"hover-tip":"",content:e.config.name?e.config.name:"并行任务"+e.level}})],1),n("span",{staticClass:"option"},[n("el-tooltip",{attrs:{effect:"dark",content:"复制分支",placement:"top"}},[n("i",{staticClass:"el-icon-copy-document",on:{click:function(t){return e.$emit("copy")}}})]),n("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.$emit("delNode")}}})],1)]),e._m(0)]),e.level<e.size?n("div",{staticClass:"node-body-right",on:{click:function(t){return t.stopPropagation(),e.$emit("rightMove")}}},[n("i",{staticClass:"el-icon-arrow-right"})]):e._e()]),n("div",{staticClass:"node-footer"},[n("div",{staticClass:"btn"},[n("insert-button",{on:{insertNode:function(t){return e.$emit("insertNode",t)}}})],1)])])},zt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-body-main-content"},[n("span",[e._v("并行任务（同时进行）")])])}],At=(n("a9e3"),{name:"ConcurrentNode",components:{InsertButton:xt},props:{config:{type:Object,default:function(){return{}}},level:{type:Number,default:1},size:{type:Number,default:0}},data:function(){return{}},methods:{}}),Bt=At,Vt=(n("47d1"),Object(d["a"])(Bt,Mt,zt,!1,null,"6d3cffcb",null)),Gt=Vt.exports,Wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{node:!0,"node-error-state":e.showError}},[n("div",{class:{"node-body":!0,error:e.showError}},[e.level>1&&e.level!=e.size?n("div",{staticClass:"node-body-left",on:{click:function(t){return e.$emit("leftMove")}}},[n("i",{staticClass:"el-icon-arrow-left"})]):e._e(),e.level==e.size?[n("div",{staticClass:"node-body-main"},[n("div",{staticClass:"node-body-main-header"},[n("ellipsis",{staticClass:"title",attrs:{"hover-tip":"",content:e.config.name?e.config.name:"条件"+e.level}}),"CONDITIONS"===e.pNode.type?n("span",{staticClass:"level"},[e._v("优先级"+e._s(e.level))]):e._e(),n("span",{staticClass:"option"})],1),n("div",{staticClass:"node-body-main-content"},[""===(e.content||"").trim()?n("span",{staticClass:"placeholder"},[e._v(e._s(e.placeholder))]):n("ellipsis",{attrs:{hoverTip:"",row:100,content:e.content}})],1)])]:[n("div",{staticClass:"node-body-main",on:{click:function(t){return e.$emit("selected")}}},[n("div",{staticClass:"node-body-main-header"},[n("ellipsis",{staticClass:"title",attrs:{"hover-tip":"",content:e.config.name?e.config.name:"条件"+e.level}}),"CONDITIONS"===e.pNode.type?n("span",{staticClass:"level"},[e._v("优先级"+e._s(e.level))]):e._e(),n("span",{staticClass:"option"},[n("el-tooltip",{attrs:{effect:"dark",content:"复制条件",placement:"top"}},[n("i",{staticClass:"el-icon-copy-document",on:{click:function(t){return t.stopPropagation(),e.$emit("copy")}}})]),n("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.$emit("delNode")}}})],1)],1),n("div",{staticClass:"node-body-main-content"},[""===(e.content||"").trim()?n("span",{staticClass:"placeholder"},[e._v(e._s(e.placeholder))]):n("ellipsis",{attrs:{hoverTip:"",row:100,content:e.content}})],1)])],e.level<e.size-1?n("div",{staticClass:"node-body-right",on:{click:function(t){return e.$emit("rightMove")}}},[n("i",{staticClass:"el-icon-arrow-right"})]):e._e(),e.showError?n("div",{staticClass:"node-error"},[n("el-tooltip",{attrs:{effect:"dark",content:e.errorInfo,placement:"top-start"}},[n("i",{staticClass:"el-icon-warning-outline"})])],1):e._e()],2),n("div",{staticClass:"node-footer"},[n("div",{staticClass:"btn"},[n("insert-button",{on:{insertNode:function(t){return e.$emit("insertNode",t)}}})],1)])])},Ht=[],Kt=(n("4ec9"),n("b85c")),qt=["A","B","C","D","E","F","G","H","I","J"],Jt={name:"ConditionNode",components:{InsertButton:xt},props:{pNode:{type:Object,default:function(){return{}}},config:{type:Object,default:function(){return{}}},level:{type:Number,default:1},size:{type:Number,default:0}},mounted:function(){},data:function(){return{ValueType:lt["a"],groupNames:qt,placeholder:"请设置条件",errorInfo:"",showError:!1}},watch:{content:function(e){this.config.props.placeholder=e}},computed:{formItems:function(){return this.$store.state.design.formItems},formMap:function(){var e=this,t=new Map;return this.formItems.forEach((function(n){return e.itemToMap(t,n)})),t},content:function(){var e=this;if(this.size===this.level)return"默认条件";var t=this.config.props.groups,n=[];return t.forEach((function(t){var o=[];t.conditions.forEach((function(t){var n="";switch(t.valueType){case lt["a"].dept:n=e.getDeptConditionContent(t);break;case lt["a"].user:n=e.getUserConditionContent(t);break;case lt["a"].number:case lt["a"].date:case lt["a"].string:n=e.formatConditionShow(t.valueType,t.value,t.compare,t.title,t.id);break}o.push(n)}));var i=String(o).replaceAll(",",o.length>1?"AND"===t.groupType?") 且 (":") 或 (":"AND"===t.groupType?" 且 ":" 或 ");n.push(o.length>1?"(".concat(i,")"):i)})),String(n).replaceAll(",","AND"===this.config.props.groupsType?" 且 ":" 或 ")}},methods:{formatConditionShow:function(e,t,n,o,i){var r=JSON.parse(JSON.stringify(t));if(i&&this.isSelect(i)){var s=this.formMap.get(i).props;if(s.optionsFromRemote&&s.remoteUrl.length>0){var a,l=0,c=Object(Kt["a"])(r);try{for(c.s();!(a=c.n()).done;){var u=a.value,d=s.remoteOptions;if(d){var p=d.filter((function(e){return e.key===u}))[0];p||(p={value:""}),r[l]=p.value,l++}}}catch(f){c.e(f)}finally{c.f()}}}var m=r[0];switch(console.log("DEPT COMPARE",n),n){case"IN":return"".concat(o,"为[").concat(String(r).replaceAll(",","、"),"]中之一");case"B":return"".concat(m," < ").concat(o," < ").concat(r[1]);case"AB":return"".concat(m," ≤ ").concat(o," < ").concat(r[1]);case"BA":return"".concat(m," < ").concat(o," ≤ ").concat(r[1]);case"ABA":return"".concat(m," ≤ ").concat(o," ≤ ").concat(r[1]);case"<=":return"".concat(o," ≤ ").concat(this.getDefault(m," ?"));case">=":return"".concat(o," ≥ ").concat(this.getDefault(m," ?"));case"belong":return"".concat(o," 属于 [").concat(String(r).replaceAll(",",". "),"] 之一");case"parent":return"".concat(o," 属于 [").concat(String(r).replaceAll(",",". "),"] 的父级");case"child":return"".concat(o," 属于 [").concat(String(r).replaceAll(",",". "),"] 的子级");default:return"".concat(o).concat(n).concat(this.getDefault(m," ?"))}},isSelect:function(e){var t=this.formMap.get(e);return!(!t||"SelectInput"!==t.name&&"MultipleSelect"!==t.name)},itemToMap:function(e,t){var n=this;e.set(t.id,t),"SpanLayout"===t.name&&t.props.items.forEach((function(t){return n.itemToMap(e,t)}))},getDefault:function(e,t){return e&&""!==e?e:t},getDeptConditionContent:function(e){console.log("DEPT",e);var t=this.formatConditionShow("",e.value.map((function(e){return e.name})),e.compare,e.title);return console.log("DEPT RESULT",t),t},getUserConditionContent:function(e){console.log("DEPT",e);var t=e.userType;if(t&&"Select"===t){var n=e.userFieldList;if(n){var o,i=n.filter((function(t){return t.key===e.userKey}))[0].label,r=n.filter((function(t){return t.key===e.userKey}))[0].options,s=e.value,a=[],l=Object(Kt["a"])(s);try{for(l.s();!(o=l.n()).done;){var c=o.value,u=r.filter((function(e){return e.key===c}))[0].value;a.push(u)}}catch(d){l.e(d)}finally{l.f()}return this.formatConditionShow("",a,e.compare,e.title+"的"+i)}}else if(t&&"Dept"===t){n=e.userFieldList;if(n){i=n.filter((function(t){return t.key===e.userKey}))[0].label;return this.formatConditionShow("",e.value.map((function(e){return e.name})),e.compare,e.title+"的"+i)}}else if(t&&"Self"!=t){n=e.userFieldList;if(n){i=n.filter((function(t){return t.key===e.userKey}))[0].label;return this.formatConditionShow("",e.value,e.compare,e.title+"的"+i)}}return console.log("================="),"".concat(e.title,"属于[").concat(String(e.value.map((function(e){return e.name}))).replaceAll(",",". "),"]之一")},validate:function(e){var t=this;if(this.size==this.level)return!0;var n=this.config.props;if(n.groups.length<=0)this.showError=!0,this.errorInfo="请设置分支条件",e.push("".concat(this.config.name," 未设置条件"));else for(var o=0;o<n.groups.length;o++){if(0===n.groups[o].conditions.length){this.showError=!0,this.errorInfo="请设置条件组".concat(this.groupNames[o],"内的条件"),e.push("条件 ".concat(this.config.name," 条件组").concat(this.groupNames[o],"内未设置条件"));break}for(var i=n.groups[o].conditions,r=0;r<i.length;r++){this.showError=!1;var s=i[r];if(console.log("条件",s),0===s.value.length)this.showError=!0;else{var a=s.value.filter((function(e){return t.$isNotBlank(e)})).length;a!=s.value.length&&(this.showError=!0),s.valueType===lt["a"].user?(this.$isNotBlank(s.userKey)||(this.showError=!0),this.$isNotBlank(s.userType)||(this.showError=!0),this.$isNotBlank(s.compare)||"Self"==s.userType||(this.showError=!0)):this.$isNotBlank(s.compare)||(this.showError=!0)}if(this.showError)return this.errorInfo="请完善条件组".concat(this.groupNames[o],"内的").concat(s.title,"条件"),e.push("条件 ".concat(this.config.name," 条件组").concat(this.groupNames[o],"内").concat(s.title,"条件未完善")),!1}}return!this.showError}}},Yt=Jt,Xt=(n("ff59"),Object(d["a"])(Yt,Wt,Ht,!1,null,"5f04a64a",null)),Qt=Xt.exports,Zt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:e.config.name,"show-error":e.showError,content:e.content,"error-info":e.errorInfo,placeholder:"请设置触发器","header-bgc":"#47bc82","header-icon":"el-icon-set-up"},on:{selected:function(t){return e.$emit("selected")},delNode:function(t){return e.$emit("delNode")},insertNode:function(t){return e.$emit("insertNode",t)}}})},en=[],tn={name:"TriggerNode",props:{config:{type:Object,default:function(){return{}}}},components:{Node:$t},data:function(){return{showError:!1,errorInfo:""}},computed:{content:function(){this.config}},methods:{validate:function(e){return this.showError=!1,"WEBHOOK"===this.config.props.type?this.$isNotEmpty(this.config.props.http.url)?this.showError=!1:(this.showError=!0,this.errorInfo="请设置WEBHOOK的URL地址"):"EMAIL"===this.config.props.type&&(this.$isNotEmpty(this.config.props.email.subject)&&0!==this.config.props.email.to.length&&this.$isNotEmpty(this.config.props.email.content)?this.showError=!1:(this.showError=!0,this.errorInfo="请设置邮件发送配置")),this.showError&&e.push("".concat(this.config.name," 触发动作未设置完善")),!this.showError}}},nn=tn,on=Object(d["a"])(nn,Zt,en,!1,null,"267f7b11",null),rn=on.exports,sn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:e.config.name,"show-error":e.showError,content:e.content,"error-info":e.errorInfo,placeholder:"请设置子流程","header-bgc":"#9400d3","header-icon":"el-icon-guide"},on:{selected:function(t){return e.$emit("selected")},delNode:function(t){return e.$emit("delNode")},insertNode:function(t){return e.$emit("insertNode",t)}}})},an=[],ln={name:"ChildProcessNode",props:{config:{type:Object,default:function(){return{}}}},mounted:function(){console.log(this.setup)},watch:{content:function(e){this.config.placeholder=e}},components:{Node:$t},data:function(){return{showError:!1,errorInfo:""}},computed:{setup:function(){return this.$store.state.design},content:function(){var e=this.config.props.childProcessName;return e}},methods:{validate:function(e){console.log("验证子流程数据:",this.config);var t=this.config.props;if(2===t.startUserType&&!this.$isNotBlank(t.startUserForm))return e.push("请选择发起人表单"),!1;if(!this.$isNotBlank(t.childProcessId))return e.push("请选择子流程"),!1;var n,o=t.inputFormMapping,i=Object(Kt["a"])(o);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!this.$isNotBlank(r.mainId)||!this.$isNotBlank(r.childId))return e.push("请选择主子流程表单映射"),!1}}catch(e){i.e(e)}finally{i.f()}var s,a=t.outputFormMapping,l=Object(Kt["a"])(a);try{for(l.s();!(s=l.n()).done;){r=s.value;if(!this.$isNotBlank(r.mainId)||!this.$isNotBlank(r.childId))return e.push("请选择子主流程表单映射"),!1}}catch(e){l.e(e)}finally{l.f()}return!0}}},cn=ln,un=Object(d["a"])(cn,sn,an,!1,null,"4f2ae630",null),dn=un.exports,pn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:e.config.name,"show-error":e.showError,content:e.content,"error-info":e.errorInfo,placeholder:"请设置延时时间","header-bgc":"#f25643","header-icon":"el-icon-time"},on:{selected:function(t){return e.$emit("selected")},delNode:function(t){return e.$emit("delNode")},insertNode:function(t){return e.$emit("insertNode",t)}}})},mn=[],fn={name:"DelayNode",props:{config:{type:Object,default:function(){return{}}}},components:{Node:$t},data:function(){return{showError:!1,errorInfo:""}},mounted:function(){},watch:{content:function(e){this.config.props.placeholder=e}},computed:{content:function(){return"FIXED"===this.config.props.type?"等待 ".concat(this.config.props.time," ").concat(this.getName(this.config.props.unit)):"AUTO"===this.config.props.type?"至 ".concat(this.config.props.dateTime):null}},methods:{validate:function(e){this.showError=!1;try{"AUTO"===this.config.props.type?""===(this.config.props.dateTime||"")&&(this.showError=!0,this.errorInfo="请选择时间点"):this.config.props.time<=0&&(this.showError=!0,this.errorInfo="请设置延时时长")}catch(t){this.showError=!0,this.errorInfo="配置出现问题"}return this.showError&&e.push("".concat(this.config.name," 未设置延时规则")),!this.showError},getName:function(e){switch(e){case"Y":return"年";case"M":return"月";case"D":return"天";case"TH":return"小时";case"TM":return"分钟";case"TS":return"秒";default:return"未知"}}}},hn=fn,vn=Object(d["a"])(hn,pn,mn,!1,null,"004db5ee",null),gn=vn.exports,bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{show:!1},on:{insertNode:function(t){return e.$emit("insertNode",t)}}})},yn=[],_n={name:"EmptyNode",components:{Node:$t},data:function(){return{}},methods:{}},kn=_n,Sn=Object(d["a"])(kn,bn,yn,!1,null,"66bfa236",null),wn=Sn.exports,xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("node",{attrs:{title:"发起人","is-root":!0,content:e.content,placeholder:"所有人","header-bgc":"#576a95","header-icon":"el-icon-user-solid"},on:{selected:function(t){return e.$emit("selected")},insertNode:function(t){return e.$emit("insertNode",t)}}})},Nn=[],Cn={name:"RootNode",components:{Node:$t},props:{config:{type:Object,default:function(){return{}}}},computed:{content:function(){if(this.config.props.assignedUser.length>0){var e=[];return this.config.props.assignedUser.forEach((function(t){return e.push(t.name)})),String(e).replaceAll(",","、")}return"所有人"}},data:function(){return{}},methods:{}},On=Cn,$n=Object(d["a"])(On,xn,Nn,!1,null,"5d527ccd",null),In=$n.exports,En={assignedType:"ASSIGN_USER",mode:"AND",sign:!1,nobody:{handler:"TO_PASS",assignedUser:[]},timeLimit:{timeout:{unit:"H",value:0},handler:{type:"REFUSE",notify:{once:!0,hour:1}}},operationBtn:[1],modePercentage:100,assignedUser:[],formPerms:[],selfSelect:{multiple:!1},leaderTop:{endCondition:"TOP",endLevel:1},leader:{level:1},role:[],refuse:{type:"TO_END",target:""},formUser:""},Pn={assignedUser:[],formPerms:[],operationBtn:[1]},Tn={groupsType:"OR",groups:[{groupType:"AND",conditions:[]}],expression:""},Ln={shouldAdd:!1,assignedUser:[],formPerms:[]},Rn={type:"WEBHOOK",http:{method:"POST",url:"",headers:[{name:"",isField:!0,value:""}],contentType:"JSON",params:[{name:"",isField:!0,value:""}],result:[{name:"",isField:!0,value:""}],retry:1,handlerByScript:!1,success:"function handlerOk(res) {\n  return true;\n}",fail:"function handlerFail(res) {\n  return true;\n}"},email:{subject:"",to:[],content:""}},Un={type:"FIXED",time:0,unit:"M",dateTime:""},Fn={startUser:[],startUserType:1,startUserForm:"",childProcessId:"",childProcessName:"",inputFormMapping:[],outputFormMapping:[],startUserCheckForm:!1},Dn={APPROVAL_PROPS:En,CC_PROPS:Ln,DELAY_PROPS:Un,CONDITION_PROPS:Tn,ROOT_PROPS:Pn,TRIGGER_PROPS:Rn,CHILD_PROCESS_PROPS:Fn},jn={name:"ProcessTree",components:{Node:$t,Root:In,Approval:Tt,Cc:jt,Trigger:rn,Concurrent:Gt,child_process:dn,Condition:Qt,Delay:gn,Empty:wn},data:function(){return{valid:!0}},computed:{nodeMap:function(){return this.$store.state.nodeMap},dom:function(){return this.$store.state.design.process}},render:function(e,t){console.log("开始渲染流程树",e),this.nodeMap.clear();var n=this.getDomTree(e,this.dom);return n.push(e("div",{style:{"text-align":"center"}},[e("div",{class:{"process-end":!0},domProps:{innerHTML:"流程结束"}})])),e("div",{class:{_root:!0},ref:"_root"},n)},methods:{getDomTree:function(e,t){var n=this;if(this.toMapping(t),this.isPrimaryNode(t)){var o=this.getDomTree(e,t.children);return this.decodeAppendDom(e,t,o),[e("div",{class:{"primary-node":!0}},o)]}if(this.isBranchNode(t)){var i=0,r=t.branchs.map((function(o){n.toMapping(o);var r=n.getDomTree(e,o.children);return n.decodeAppendDom(e,o,r,{level:i+1,size:t.branchs.length,pNode:t}),n.insertCoverLine(e,i,r,t.branchs),i++,e("div",{class:{"branch-node-item":!0}},r)}));r.unshift(e("div",{class:{"add-branch-btn":!0}},[e("el-button",{class:{"add-branch-btn-el":!0},props:{size:"small",round:!0},on:{click:function(){return n.addBranchNode(t)}},domProps:{innerHTML:"添加".concat(this.isConditionNode(t)?"条件":"分支")}},[])]));var s=[e("div",{class:{"branch-node":!0}},r)],a=this.getDomTree(e,t.children);return[e("div",{},[s,a])]}if(this.isEmptyNode(t)){var l=this.getDomTree(e,t.children);return this.decodeAppendDom(e,t,l),[e("div",{class:{"empty-node":!0}},l)]}return[]},decodeAppendDom:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i.config=t;var r=t.type.toLowerCase();n.unshift(e(r,{props:i,ref:t.id,key:t.id,on:{insertNode:function(e){return o.insertNode(e,t)},delNode:function(){return o.delNode(t)},selected:function(){return o.selectNode(t)},copy:function(){return o.copyBranch(t)},leftMove:function(){return o.branchMove(t,-1)},rightMove:function(){return o.branchMove(t,1)}}},[]))},toMapping:function(e){e&&e.id&&this.nodeMap.set(e.id,e)},insertCoverLine:function(e,t,n,o){0===t?(n.unshift(e("div",{class:{"line-top-left":!0}},[])),n.unshift(e("div",{class:{"line-bot-left":!0}},[]))):t===o.length-1&&(n.unshift(e("div",{class:{"line-top-right":!0}},[])),n.unshift(e("div",{class:{"line-bot-right":!0}},[])))},copyBranch:function(e){var t=this,n=this.nodeMap.get(e.parentId),o=this.$deepCopy(e);o.name=o.name+"-copy",this.forEachNode(n,o,(function(e,n){var o=t.getRandomId();console.log(n,"新id =>"+o,"老nodeId:"+n.id),n.id=o,n.parentId=e.id})),n.branchs.splice(n.branchs.indexOf(e),0,o),this.$forceUpdate()},branchMove:function(e,t){var n=this.nodeMap.get(e.parentId),o=n.branchs.indexOf(e),i=n.branchs[o+t];n.branchs[o+t]=n.branchs[o],n.branchs[o]=i,this.$forceUpdate()},isPrimaryNode:function(e){return e&&("ROOT"===e.type||"APPROVAL"===e.type||"CC"===e.type||"DELAY"===e.type||"CHILD_PROCESS"===e.type||"TRIGGER"===e.type)},isBranchNode:function(e){return e&&("CONDITIONS"===e.type||"CONCURRENTS"===e.type||"INCLUSIVES"===e.type)},isEmptyNode:function(e){return e&&"EMPTY"===e.type},isConditionNode:function(e){return"CONDITIONS"===e.type||"INCLUSIVES"===e.type},isBranchSubNode:function(e){return e&&("CONDITION"===e.type||"CONCURRENT"===e.type||"CONDITION"===e.type)},isConcurrentNode:function(e){return"CONCURRENTS"===e.type},getRandomId:function(){return"node_".concat((new Date).getTime().toString().substring(5)).concat(Math.round(9e3*Math.random()+1e3))},selectNode:function(e){this.$store.commit("selectedNode",e),this.$emit("selectedNode",e)},insertNode:function(e,t){this.$refs["_root"].click();var n=t.children;switch(t.children={id:this.getRandomId(),parentId:t.id,props:{},type:e},e){case"APPROVAL":this.insertApprovalNode(t,n);break;case"CC":this.insertCcNode(t);break;case"DELAY":this.insertDelayNode(t);break;case"TRIGGER":this.insertTriggerNode(t);break;case"CONDITIONS":this.insertConditionsNode(t);break;case"CONCURRENTS":this.insertConcurrentsNode(t);break;case"INCLUSIVES":this.insertInclusivesNode(t);break;case"CHILD_PROCESS":this.insertChildProcessNode(t);break;default:break}this.isBranchNode({type:e})?(n&&n.id&&(n.parentId=t.children.children.id),this.$set(t.children.children,"children",n)):(n&&n.id&&(n.parentId=t.children.id),this.$set(t.children,"children",n)),this.$forceUpdate()},insertApprovalNode:function(e){this.$set(e.children,"name","审批人"),this.$set(e.children,"props",this.$deepCopy(Dn.APPROVAL_PROPS))},insertCcNode:function(e){this.$set(e.children,"name","抄送人"),this.$set(e.children,"props",this.$deepCopy(Dn.CC_PROPS))},insertDelayNode:function(e){this.$set(e.children,"name","延迟等待"),this.$set(e.children,"props",this.$deepCopy(Dn.DELAY_PROPS))},insertTriggerNode:function(e){this.$set(e.children,"name","触发器"),this.$set(e.children,"props",this.$deepCopy(Dn.TRIGGER_PROPS))},insertChildProcessNode:function(e){this.$set(e.children,"name","子流程"),this.$set(e.children,"props",this.$deepCopy(Dn.CHILD_PROCESS_PROPS))},insertInclusivesNode:function(e){this.$set(e.children,"name","包容分支"),this.$set(e.children,"children",{id:this.getRandomId(),parentId:e.children.id,type:"EMPTY"}),this.$set(e.children,"branchs",[{id:this.getRandomId(),parentId:e.children.id,type:"CONDITION",props:this.$deepCopy(Dn.CONDITION_PROPS),name:"条件1",children:{}},{id:this.getRandomId(),parentId:e.children.id,type:"CONDITION",props:this.$deepCopy(Dn.CONDITION_PROPS),name:"条件2",children:{}}])},insertConditionsNode:function(e){this.$set(e.children,"name","条件分支"),this.$set(e.children,"children",{id:this.getRandomId(),parentId:e.children.id,type:"EMPTY"}),this.$set(e.children,"branchs",[{id:this.getRandomId(),parentId:e.children.id,type:"CONDITION",props:this.$deepCopy(Dn.CONDITION_PROPS),name:"条件1",children:{}},{id:this.getRandomId(),parentId:e.children.id,type:"CONDITION",props:this.$deepCopy(Dn.CONDITION_PROPS),name:"条件2",children:{}}])},insertConcurrentsNode:function(e){this.$set(e.children,"name","并行分支"),this.$set(e.children,"children",{id:this.getRandomId(),parentId:e.children.id,type:"EMPTY"}),this.$set(e.children,"branchs",[{id:this.getRandomId(),name:"分支1",parentId:e.children.id,type:"CONCURRENT",props:{},children:{}},{id:this.getRandomId(),name:"分支2",parentId:e.children.id,type:"CONCURRENT",props:{},children:{}}])},getBranchEndNode:function(e){return e.children&&e.children.id?this.getBranchEndNode(e.children):e},addBranchNode:function(e){e.branchs.length<8?e.branchs.push({id:this.getRandomId(),parentId:e.id,name:(this.isConditionNode(e)?"条件":"分支")+(e.branchs.length+1),props:this.isConditionNode(e)?this.$deepCopy(Dn.CONDITION_PROPS):{},type:this.isConditionNode(e)?"CONDITION":"CONCURRENT",children:{}}):this.$message.warning("最多只能添加 8 项😥")},delNode:function(e){console.log("删除节点",e);var t=this.nodeMap.get(e.parentId);if(t){if(this.isBranchNode(t)){if(t.branchs.splice(t.branchs.indexOf(e),1),t.branchs.length<2){var n=this.nodeMap.get(t.parentId);if(t.branchs[0].children&&t.branchs[0].children.id){n.children=t.branchs[0].children,n.children.parentId=n.id;var o=this.getBranchEndNode(t.branchs[0]);o.children=t.children.children,o.children&&o.children.id&&(o.children.parentId=o.id)}else n.children=t.children.children,n.children&&n.children.id&&(n.children.parentId=n.id)}}else e.children&&e.children.id&&(e.children.parentId=t.id),t.children=e.children;this.$forceUpdate()}else this.$message.warning("出现错误，找不到上级节点😥")},validateProcess:function(){this.valid=!0;var e=[];return this.validate(e,this.dom),e},validateNode:function(e,t){this.$refs[t.id].validate&&(this.valid=this.$refs[t.id].validate(e))},nodeDomUpdate:function(e){this.$refs[e.id].$forceUpdate()},forEachNode:function(e,t,n){var o=this;this.isBranchNode(t)?(n(e,t),this.forEachNode(t,t.children,n),t.branchs.map((function(e){n(t,e),o.forEachNode(e,e.children,n)}))):(this.isPrimaryNode(t)||this.isEmptyNode(t)||this.isBranchSubNode(t))&&(n(e,t),this.forEachNode(t,t.children,n))},validate:function(e,t){var n=this;this.isPrimaryNode(t)?(this.validateNode(e,t),this.validate(e,t.children)):this.isBranchNode(t)?(t.branchs.map((function(t){n.validateNode(e,t),n.validate(e,t.children)})),this.validate(e,t.children)):this.isEmptyNode(t)&&this.validate(e,t.children)}},watch:{}},Mn=jn,zn=(n("69be"),Object(d["a"])(Mn,o,i,!1,null,"6693b2fc",null)),An=zn.exports,Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.name&&e.formConfig.length>0?n("el-tabs",{model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("el-tab-pane",{attrs:{label:e.name,name:"properties"}},[n((e.selectNode.type||"").toLowerCase(),{tag:"component",attrs:{fm:e.selectNode,config:e.selectNode.props}})],1),n("el-tab-pane",{attrs:{label:"表单权限设置",name:"permissions"}},[n("form-authority-config")],1)],1):n((e.selectNode.type||"").toLowerCase(),{tag:"component",attrs:{fm:e.selectNode,config:e.selectNode.props}})],1)},Vn=[],Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{attrs:{"label-position":"top","label-width":"90px"}},[n("el-form-item",{staticClass:"user-type",attrs:{label:"⚙ 选择审批对象",prop:"text"}},[n("el-radio-group",{model:{value:e.nodeProps.assignedType,callback:function(t){e.$set(e.nodeProps,"assignedType",t)},expression:"nodeProps.assignedType"}},e._l(e.approvalTypes,(function(t){return n("el-radio",{key:t.type,attrs:{label:t.type}},[e._v(e._s(t.name))])})),1),"ASSIGN_USER"===e.nodeProps.assignedType?n("div",[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:e.selectUser}},[e._v("选择人员")]),n("org-items",{model:{value:e.nodeProps.assignedUser,callback:function(t){e.$set(e.nodeProps,"assignedUser",t)},expression:"nodeProps.assignedUser"}})],1):"SELF_SELECT"===e.nodeProps.assignedType?n("div",[n("el-radio-group",{attrs:{size:"mini"},model:{value:e.nodeProps.selfSelect.multiple,callback:function(t){e.$set(e.nodeProps.selfSelect,"multiple",t)},expression:"nodeProps.selfSelect.multiple"}},[n("el-radio-button",{attrs:{label:!1}},[e._v("自选一个人")]),n("el-radio-button",{attrs:{label:!0}},[e._v("自选多个人")])],1)],1):"LEADER_TOP"===e.nodeProps.assignedType?n("div",[n("el-divider"),n("el-form-item",{staticClass:"approve-end",attrs:{label:"审批终点",prop:"text"}},[n("el-radio-group",{model:{value:e.nodeProps.leaderTop.endCondition,callback:function(t){e.$set(e.nodeProps.leaderTop,"endCondition",t)},expression:"nodeProps.leaderTop.endCondition"}},[n("el-radio",{attrs:{label:"TOP"}},[e._v("直到最上层主管")]),n("el-radio",{attrs:{label:"LEAVE"}},[e._v("不超过发起人的")])],1),"LEAVE"===e.nodeProps.leaderTop.endCondition?n("div",{staticClass:"approve-end-leave"},[n("span",[e._v("第 ")]),n("el-input-number",{attrs:{min:1,max:20,step:1,size:"mini"},model:{value:e.nodeProps.leaderTop.level,callback:function(t){e.$set(e.nodeProps.leaderTop,"level",t)},expression:"nodeProps.leaderTop.level"}}),n("span",[e._v(" 级主管")])],1):e._e()],1)],1):"LEADER"===e.nodeProps.assignedType?n("div",[n("el-divider"),n("el-form-item",{attrs:{label:"指定主管",prop:"text"}},[n("span",[e._v("发起人的第 ")]),n("el-input-number",{attrs:{min:1,max:20,step:1,size:"mini"},model:{value:e.nodeProps.leader.level,callback:function(t){e.$set(e.nodeProps.leader,"level",t)},expression:"nodeProps.leader.level"}}),n("span",[e._v(" 级主管")]),n("div",{staticStyle:{color:"#409EFF","font-size":"small"}},[e._v("👉 直接主管为 第 1 级主管")])],1)],1):"ROLE"===e.nodeProps.assignedType?n("div",[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary",round:""},on:{click:e.selectRole}},[e._v("选择系统角色")]),n("org-items",{model:{value:e.nodeProps.role,callback:function(t){e.$set(e.nodeProps,"role",t)},expression:"nodeProps.role"}})],1):"FORM_USER"===e.nodeProps.assignedType?n("div",[n("el-form-item",{staticClass:"approve-end",attrs:{label:"选择表单联系人项",prop:"text"}},[n("el-select",{staticStyle:{width:"80%"},attrs:{size:"small",placeholder:"请选择包含联系人的表单项"},model:{value:e.nodeProps.formUser,callback:function(t){e.$set(e.nodeProps,"formUser",t)},expression:"nodeProps.formUser"}},e._l(e.forms,(function(e){return n("el-option",{attrs:{label:e.title,value:e.id}})})),1)],1)],1):n("div",[n("span",{staticClass:"item-desc"},[e._v("发起人自己作为审批人进行审批")])])],1),n("el-divider"),n("el-form-item",{staticClass:"line-mode",attrs:{label:"👤 审批人为空时",prop:"text"}},[n("nobody-config")],1),e.showMode?n("div",[n("el-divider"),n("el-form-item",{staticClass:"approve-mode",attrs:{label:"👩‍👦‍👦 多人审批时审批方式",prop:"text"}},[n("el-radio-group",{model:{value:e.nodeProps.mode,callback:function(t){e.$set(e.nodeProps,"mode",t)},expression:"nodeProps.mode"}},[n("el-radio",{attrs:{label:"NEXT"}},[e._v("会签 （按选择顺序审批，每个人必须同意）")]),n("el-radio",{attrs:{label:"AND"}},[e._v("会签（可同时审批，每个人必须同意）")]),n("el-radio",{attrs:{label:"OR"}},[e._v("或签（有一人同意即可）")])],1)],1)],1):e._e(),n("el-divider")],1),n("org-picker",{ref:"orgPicker",attrs:{title:e.pickerTitle,multiple:"",type:e.orgPickerType,selected:e.orgPickerSelected},on:{ok:e.selected}})],1)},Wn=[],Hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-radio-group",{model:{value:e.nodeProps.nobody.handler,callback:function(t){e.$set(e.nodeProps.nobody,"handler",t)},expression:"nodeProps.nobody.handler"}},[n("el-radio",{attrs:{label:"TO_PASS"}},[e._v("自动通过")]),n("el-radio",{attrs:{label:"TO_END"}},[e._v("结束流程")]),n("el-radio",{attrs:{label:"TO_ADMIN"}},[e._v("转交审批管理员")]),n("el-radio",{attrs:{label:"TO_USER"}},[e._v("转交到指定人员")])],1),"TO_USER"===e.nodeProps.nobody.handler?n("div",{staticStyle:{"margin-top":"10px"}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:e.selectNoSetUser}},[e._v("选择人员")]),n("org-items",{model:{value:e.nodeProps.nobody.assignedUser,callback:function(t){e.$set(e.nodeProps.nobody,"assignedUser",t)},expression:"nodeProps.nobody.assignedUser"}})],1):e._e(),n("org-picker",{ref:"orgPicker",attrs:{title:"选择指定人员1",type:"user",selected:e.nodeProps.nobody.assignedUser},on:{ok:e.selected}})],1)},Kn=[],qn={name:"workSpace",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{},data:function(){return{}},mounted:function(){},computed:{nodeProps:function(){return this.$store.state.selectedNode.props}},methods:{selectNoSetUser:function(){this.$refs.orgPicker.show()},selected:function(e){var t=this;e.forEach((function(e){return t.nodeProps.nobody.assignedUser.push(e)}))}}},Jn=qn,Yn=Object(d["a"])(Jn,Hn,Kn,!1,null,"7bf4bb31",null),Xn=Yn.exports,Qn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-radio-group",{model:{value:e.nodeProps.refuse.type,callback:function(t){e.$set(e.nodeProps.refuse,"type",t)},expression:"nodeProps.refuse.type"}},[n("el-radio",{attrs:{label:"TO_END"}},[e._v("直接结束流程")]),n("el-radio",{attrs:{label:"TO_NODE"}},[e._v("驳回到指定节点")])],1),"TO_NODE"===e.nodeProps.refuse.type?n("div",[n("span",[e._v("指定节点:")]),n("el-select",{staticStyle:{"margin-left":"10px",width:"150px"},attrs:{placeholder:"选择跳转步骤",size:"small"},model:{value:e.nodeProps.refuse.target,callback:function(t){e.$set(e.nodeProps.refuse,"target",t)},expression:"nodeProps.refuse.target"}},e._l(e.rejectNodeList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1):e._e()],1)},Zn=[],eo={name:"workSpace",components:{},props:{fm:{type:Object,default:function(){return{}}}},data:function(){return{}},mounted:function(){},computed:{nodeProps:function(){return this.$store.state.selectedNode.props},rejectNodeList:function(){var e=[],t=["EMPTY","CONDITION","INCLUSIVES","CONDITIONS","CONCURRENT","CONCURRENTS"],n={},o={};this.produceSerialNodeList(void 0,this.$store.state.design.process,n,o);var i,r=n[this.fm.id],s=Object(Kt["a"])(r);try{for(s.s();!(i=s.n()).done;){var a=i.value,l=o[a].type;-1===t.indexOf(l)&&o[a].id!=this.fm.id&&e.push({id:o[a].id,name:o[a].name})}}catch(c){s.e(c)}finally{s.f()}return e}},methods:{produceSerialNodeList:function(e,t,n,o){if(this.$isNode(t)){var i=t.id;if(o[i]=t,this.$isNotBlank(e)){var r=n[e],s=this.$deepCopy(r);s.push(i),n[i]=s}else{var a=[];a.push(i),n[i]=a}var l=t.type,c=t.children;if("CONDITIONS"===l||"CONCURRENTS"===l||"INCLUSIVES"===l){c=c.children;var u,d=t.branchs,p=Object(Kt["a"])(d);try{for(p.s();!(u=p.n()).done;){var m=u.value;this.produceSerialNodeList(i,m.children,n,o)}}catch(f){p.e(f)}finally{p.f()}this.$isNode(c)&&this.produceSerialNodeList(i,c,n,o)}else this.$isNode(c)&&this.produceSerialNodeList(i,c,n,o)}}}},to=eo,no=Object(d["a"])(to,Qn,Zn,!1,null,"bfa3544e",null),oo=no.exports,io=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-checkbox-group",{model:{value:e.nodeProps.operationBtn,callback:function(t){e.$set(e.nodeProps,"operationBtn",t)},expression:"nodeProps.operationBtn"}},[n("el-checkbox",{attrs:{label:1}},[e._v("完成")]),n("el-checkbox",{attrs:{label:2}},[e._v("驳回")]),n("el-checkbox",{attrs:{label:3}},[e._v("委派")]),n("el-checkbox",{attrs:{label:4}},[e._v("转交")])],1)],1)},ro=[],so={name:"workSpace",components:{},props:{fm:{type:Object,default:function(){return{}}}},data:function(){return{}},mounted:function(){},computed:{nodeProps:function(){return this.$store.state.selectedNode.props}},methods:{}},ao=so,lo=Object(d["a"])(ao,io,ro,!1,null,"07d5c7b7",null),co=lo.exports,uo={name:"ApprovalNodeConfig",components:{OrgPicker:g["a"],OrgItems:de["a"],NobodyConfig:Xn,RefuseHandlerConfig:oo,OperationConfig:co},props:{config:{type:Object,default:function(){return{}}},fm:{type:Object,default:function(){return{}}}},data:function(){return{showOrgSelect:!1,orgPickerSelected:[],orgPickerType:"user",approvalTypes:[{name:"指定人员",type:"ASSIGN_USER"},{name:"发起人自选",type:"SELF_SELECT"},{name:"连续多级主管",type:"LEADER_TOP"},{name:"主管",type:"LEADER"},{name:"发起人自己",type:"SELF"},{name:"表单内联系人",type:"FORM_USER"}]}},mounted:function(){},computed:{nodeProps:function(){return this.$store.state.selectedNode.props},select:function(){return this.config.assignedUser||[]},forms:function(){return this.$store.state.design.formItems.filter((function(e){return"UserPicker"===e.name}))},pickerTitle:function(){switch(this.orgPickerType){case"user":return"请选择人员";case"role":return"请选择系统角色";default:return null}},showMode:function(){switch(this.nodeProps.assignedType){case"ASSIGN_USER":return this.nodeProps.assignedUser.length>1;case"SELF_SELECT":return this.nodeProps.selfSelect.multiple;case"LEADER_TOP":return""!==this.nodeProps.formUser;case"FORM_USER":return!0;case"ROLE":return!0;default:return!1}}},methods:{selectUser:function(){var e=this;this.orgPickerSelected.length=0,this.config.assignedUser.forEach((function(t){return e.orgPickerSelected.push(t)})),this.orgPickerType="org",this.$refs.orgPicker.show()},selectRole:function(){this.orgPickerSelected=this.select,this.orgPickerType="role",this.$refs.orgPicker.show()},selected:function(e){var t=this;this.orgPickerSelected.length=0,e.forEach((function(e){return t.orgPickerSelected.push(e)})),e.forEach((function(e){return t.config.assignedUser.push(e)}))},removeOrgItem:function(e){this.select.splice(e,1)}}},po=uo,mo=(n("c23f"),Object(d["a"])(po,Gn,Wn,!1,null,"5007cf93",null)),fo=mo.exports,ho=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{attrs:{inline:"","label-width":"100px"}},[n("el-form-item",{attrs:{label:"条件组关系","label-width":"150px"}},[n("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#c1c1c1","active-value":"AND","inactive-value":"OR","active-text":"且","inactive-text":"或"},model:{value:e.config.groupsType,callback:function(t){e.$set(e.config,"groupsType",t)},expression:"config.groupsType"}})],1),n("el-form-item",{attrs:{label:"条件组表达式"}},[n("el-input",{attrs:{size:"mini",placeholder:"输入条件组关系表达式  &为与，|为或"},model:{value:e.config.expression,callback:function(t){e.$set(e.config,"expression",t)},expression:"config.expression"}}),n("span",{staticClass:"item-desc"},[e._v("使用表达式构建复杂逻辑，例如: (A & B) | C")])],1)],1),n("div",[n("el-button",{staticStyle:{margin:"0 15px 15px 0"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.addConditionGroup}},[e._v(" 添加条件组 ")])],1),n("group-item")],1)},vo=[],go=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._l(e.selectedNode.props.groups,(function(t,o){return n("div",{key:o+"_g",staticClass:"group"},[n("div",{staticClass:"group-header"},[n("span",{staticClass:"group-name"},[e._v("条件组 "+e._s(e.groupNames[o]))]),n("div",{staticClass:"group-cp"},[n("span",[e._v("组内条件关系：")]),n("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#c1c1c1","active-value":"AND","inactive-value":"OR","active-text":"且","inactive-text":"或"},model:{value:t.groupType,callback:function(n){e.$set(t,"groupType",n)},expression:"group.groupType"}})],1),n("div",{staticClass:"group-operation"},[n("el-dropdown",{on:{command:e.addConditionHandler,"visible-change":e.conditionVisibleChange}},[n("span",{staticClass:"el-dropdown-link"},[n("i",{staticClass:"el-icon-plus"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.conditionList,(function(t,i){return n("el-dropdown-item",{key:t.id+"_"+i,attrs:{selftest:"",command:i+"-"+o}},[e._v(e._s(t.title)+" ")])})),1)],1),n("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.delGroup(o)}}})],1)]),n("div",{staticClass:"group-content"},[0===t.conditions.length?n("p",[e._v("点击右上角 + 为本条件组添加条件 ☝")]):n("div",[n("el-form",{ref:"condition-form",refInFor:!0,attrs:{"label-width":"100px"}},e._l(t.conditions,(function(o,i){return n("el-form-item",{key:o.id+"_"+i},[n("ellipsis",{attrs:{slot:"label","hover-tip":"",content:o.title},slot:"label"}),o.valueType===e.ValueType.string?n("span",[e.isSelect(o.id)?n("select-condition-show",{attrs:{condition:o,options:e.getOptions(o.id)}}):n("string-condition-show",{attrs:{condition:o}})],1):o.valueType===e.ValueType.number?n("span",[n("number-condition-show",{attrs:{condition:o}})],1):o.valueType===e.ValueType.user?n("span",[n("user-condition-show",{attrs:{condition:o}})],1):o.valueType===e.ValueType.dept?n("span",[n("dept-condition-show",{attrs:{condition:o}})],1):o.valueType===e.ValueType.date?n("span",["date"===o.dateType?[n("date-condition-show",{attrs:{condition:o}})]:e._e(),"datetime"===o.dateType?[n("date-time-condition-show",{attrs:{condition:o}})]:e._e(),"time"===o.dateType?[n("time-condition-show",{attrs:{condition:o}})]:e._e()],2):e._e(),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return e.rmSubCondition(t,i)}}})],1)})),1)],1)])])})),n("org-picker",{ref:"orgPicker",attrs:{type:e.orgType,multiple:"",selected:e.users},on:{ok:e.selected}})],2)},bo=[];n("ac1f"),n("1276"),n("e439"),n("dbb4"),n("b64b");function yo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_o(Object(n),!0).forEach((function(t){yo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var So=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},e._l(e.expList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-date-picker",{staticStyle:{"margin-left":"10px"},style:{width:e.compareValueWidth+"px"},attrs:{"value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",type:"date",size:"small",placeholder:"选择日期"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}})],1)},wo=[],xo={name:"ConditionShow",components:{},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},watch:{},mounted:function(){},data:function(){return{expList:[{label:"等于",value:"=="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="}]}},methods:{}},No=xo,Co=Object(d["a"])(No,So,wo,!1,null,"828d6c6a",null),Oo=Co.exports,$o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},on:{change:function(t){e.condition.value=[]}},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},[n("el-option",{attrs:{label:"等于",value:"=="}}),n("el-option",{attrs:{label:"包含在",value:"IN"}})],1),n("span",{staticStyle:{"margin-left":"10px"}},["=="===e.condition.compare?n("el-input",{style:{width:e.compareValueWidth+"px"},attrs:{placeholder:"输入比较值",size:"small"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}}):e._e(),"IN"===e.condition.compare?n("el-select",{style:{width:e.compareValueWidth+"px"},attrs:{multiple:"",clearable:"",filterable:"","allow-create":"",size:"small",placeholder:"输入可能包含的值"},model:{value:e.condition.value,callback:function(t){e.$set(e.condition,"value",t)},expression:"condition.value"}}):e._e()],1)],1)},Io=[],Eo={name:"ConditionShow",components:{},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},watch:{},data:function(){return{}},methods:{}},Po=Eo,To=Object(d["a"])(Po,$o,Io,!1,null,"62107724",null),Lo=To.exports,Ro=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},on:{change:function(t){e.condition.value=[]}},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},[n("el-option",{attrs:{label:"等于",value:"=="}}),n("el-option",{attrs:{label:"包含在",value:"IN"}})],1),n("span",{staticStyle:{"margin-left":"10px"}},["IN"===e.condition.compare?n("el-select",{style:{width:e.compareValueWidth+"px"},attrs:{clearable:"",multiple:"",size:"small",placeholder:"选择值"},model:{value:e.condition.value,callback:function(t){e.$set(e.condition,"value",t)},expression:"condition.value"}},e._l(e.options,(function(e,t){return n("el-option",{key:t,attrs:{label:e.value,value:e.key}})})),1):n("el-select",{style:{width:e.compareValueWidth+"px"},attrs:{clearable:"",size:"small",placeholder:"选择值"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}},e._l(e.options,(function(e,t){return n("el-option",{key:t,attrs:{label:e.value,value:e.key}})})),1)],1)],1)},Uo=[],Fo={name:"ConditionShow",components:{},props:{options:{type:Array,default:function(){return[]}},condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},watch:{},data:function(){return{}},methods:{}},Do=Fo,jo=Object(d["a"])(Do,Ro,Uo,!1,null,"4ce80951",null),Mo=jo.exports,zo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},on:{change:e.compareChange},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},e._l(e.explains,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("span",{staticStyle:{"margin-left":"10px"}},[0===e.conditionValType(e.condition.compare)?n("el-input",{style:{width:e.compareValueWidth+"px"},attrs:{size:"small",placeholder:"输入比较值",type:"number"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}}):1===e.conditionValType(e.condition.compare)?n("el-select",{style:{width:e.compareValueWidth+"px"},attrs:{multiple:"",filterable:"","allow-create":"",size:"small",placeholder:"输入可能包含的值"},model:{value:e.condition.value,callback:function(t){e.$set(e.condition,"value",t)},expression:"condition.value"}}):e._e()],1)],1)},Ao=[],Bo={name:"ConditionShow",components:{},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},mounted:function(){console.log(this.condition.compare)},watch:{},data:function(){return{explains:[{label:"等于",value:"=="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="},{label:"包含在",value:"IN"}]}},methods:{compareChange:function(e){},conditionValType:function(e){switch(e){case"==":case">":case">=":case"<":case"<=":return 0;case"IN":return 1;default:return 2}}}},Vo=Bo,Go=Object(d["a"])(Vo,zo,Ao,!1,null,"7644d127",null),Wo=Go.exports,Ho=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},e._l(e.expList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-date-picker",{staticStyle:{"margin-left":"10px"},style:{width:e.compareValueWidth+"px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",type:"datetime",size:"small",placeholder:"选择日期"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}})],1)},Ko=[],qo={name:"ConditionShow",components:{},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},watch:{},data:function(){return{expList:[{label:"等于",value:"=="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="}]}},methods:{}},Jo=qo,Yo=Object(d["a"])(Jo,Ho,Ko,!1,null,"141eab34",null),Xo=Yo.exports,Qo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},e._l(e.expList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-time-picker",{staticStyle:{"margin-left":"10px"},style:{width:e.compareValueWidth+"px"},attrs:{"arrow-control":"","value-format":"HH:mm:ss",format:"HH:mm:ss",size:"small"},model:{value:e.condition.value[0],callback:function(t){e.$set(e.condition.value,0,t)},expression:"condition.value[0]"}})],1)},Zo=[],ei={name:"ConditionShow",components:{},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0},compareValueWidth:{type:Number,default:280}},watch:{},data:function(){return{expList:[{label:"等于",value:"=="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="}]}},methods:{}},ti=ei,ni=Object(d["a"])(ti,Qo,Zo,!1,null,"59b45602",null),oi=ni.exports,ii=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},attrs:{size:"small",placeholder:"判断符"},on:{change:e.selectPropChange},model:{value:e.condition.userKey,callback:function(t){e.$set(e.condition,"userKey",t)},expression:"condition.userKey"}},e._l(e.propList,(function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1),"Self"===e.getUserProp(e.condition.userKey).type?[n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.selectUser(e.condition.value,"org")}}},[e._v("选择人员/部门")]),n("org-items",{model:{value:e.condition.value,callback:function(t){e.$set(e.condition,"value",t)},expression:"condition.value"}})]:"Date"===e.getUserProp(e.condition.userKey).type?[n("date-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,condition:e.condition}})]:"DateTime"===e.getUserProp(e.condition.userKey).type?[n("date-time-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,condition:e.condition}})]:"Time"===e.getUserProp(e.condition.userKey).type?[n("time-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,condition:e.condition}})]:"String"===e.getUserProp(e.condition.userKey).type?[n("string-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,condition:e.condition}})]:"Number"===e.getUserProp(e.condition.userKey).type?[n("number-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,condition:e.condition}})]:"Dept"===e.getUserProp(e.condition.userKey).type?[n("dept-condition-show",{key:e.uniKey,attrs:{compareLeftWidth:10,condition:e.condition}})]:"Select"===e.getUserProp(e.condition.userKey).type?[n("select-condition-show",{key:e.uniKey,attrs:{compareValueWidth:135,compareLeftWidth:10,options:e.getUserProp(e.condition.userKey).options,condition:e.condition}})]:e._e(),n("org-picker",{ref:"orgPicker",attrs:{type:e.orgType,multiple:"",selected:e.users},on:{ok:e.selected}})],2)},ri=[],si=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-select",{staticStyle:{width:"120px"},style:{marginLeft:e.compareLeftWidth+"px"},attrs:{size:"small",placeholder:"判断符"},on:{change:e.selectPropChange},model:{value:e.condition.compare,callback:function(t){e.$set(e.condition,"compare",t)},expression:"condition.compare"}},e._l(e.propList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.key,value:e.value}})})),1),[n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:function(t){return e.selectUser(e.condition.value,"dept")}}},[e._v("选择部门")]),n("org-items",{model:{value:e.condition.value,callback:function(t){e.$set(e.condition,"value",t)},expression:"condition.value"}})],n("org-picker",{ref:"orgPicker",attrs:{type:e.orgType,multiple:"",selected:e.users},on:{ok:e.selected}})],2)},ai=[],li={name:"ConditionShow",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{condition:{type:Object,default:function(){return{}}},compareLeftWidth:{type:Number,default:0}},mounted:function(){this.users=this.condition.value},watch:{},data:function(){return{uniKey:(new Date).getTime(),users:[],orgType:"dept",propList:[{key:"属于",value:"belong"},{key:"父级",value:"parent"},{key:"子级",value:"child"}]}},methods:{selectPropChange:function(e){this.uniKey=(new Date).getTime(),this.condition.value.splice(0,this.condition.value.length),this.users.splice(0,this.users.length)},selected:function(e){var t=this;this.users.length=0,e.forEach((function(e){return t.users.push(e)}))},selectUser:function(e,t){this.orgType=t,this.users=e,this.$refs.orgPicker.show()}}},ci=li,ui=Object(d["a"])(ci,si,ai,!1,null,"28e9bca0",null),di=ui.exports,pi=(n("fbad"),{name:"ConditionShow",components:{OrgPicker:g["a"],OrgItems:de["a"],TimeConditionShow:oi,StringConditionShow:Lo,DateTimeConditionShow:Xo,DateConditionShow:Oo,DeptConditionShow:di,NumberConditionShow:Wo,SelectConditionShow:Mo},props:{condition:{type:Object,default:function(){return{}}}},mounted:function(){this.users=this.condition.value},watch:{},data:function(){return{uniKey:(new Date).getTime(),users:[],orgType:"org",propList:[{label:"属于",key:"id",type:"Self",expList:[{label:"属于",value:"=="}]},{label:"部门",key:"depId",type:"Dept",expList:[]},{label:"入职时间",key:"entryDate",type:"Date"},{label:"性别",key:"gender",type:"Select",options:[{key:"1",value:"男"},{key:"2",value:"女"}]}]}},methods:{selectPropChange:function(e){this.uniKey=(new Date).getTime(),this.condition.value.splice(0,this.condition.value.length),this.condition.compare="",this.users.splice(0,this.users.length),this.condition.userType=this.getUserProp(e).type},selected:function(e){var t=this;this.users.length=0,e.forEach((function(e){return t.users.push(e)}))},selectUser:function(e,t){this.orgType=t,this.users=e,this.$refs.orgPicker.show()},getUserProp:function(e){var t=this.propList.filter((function(t){return t.key===e}))[0];return t||{expList:[]}}}}),mi=pi,fi=Object(d["a"])(mi,ii,ri,!1,null,"60d4eb44",null),hi=fi.exports,vi={name:"ConditionGroupItemConfig",components:{OrgPicker:g["a"],OrgItems:de["a"],DeptConditionShow:di,TimeConditionShow:oi,DateTimeConditionShow:Xo,UserConditionShow:hi,DateConditionShow:Oo,StringConditionShow:Lo,SelectConditionShow:Mo,NumberConditionShow:Wo},data:function(){return{ValueType:lt["a"],users:[],orgType:"user",showOrgSelect:!1,groupNames:["A","B","C","D","E","F","G","H","I","J"],supportTypes:[lt["a"].number,lt["a"].string,lt["a"].date,lt["a"].dept,lt["a"].user],userExplains:[{label:"属于",key:"id",expList:[{label:"属于",value:"=="}]},{label:"年龄",key:"age",expList:[{label:"等于",value:"="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="},{label:"包含在",value:"IN"}]},{label:"入职时间",key:"entryDate",expList:[{label:"等于",value:"="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="},{label:"包含在",value:"IN"}]},{label:"性别",key:"gender",expList:[{label:"等于",value:"="}]}],explains:[{label:"等于",value:"="},{label:"大于",value:">"},{label:"大于等于",value:">="},{label:"小于",value:"<"},{label:"小于等于",value:"<="},{label:"包含在",value:"IN"}]}},computed:{selectedNode:function(){return this.$store.state.selectedNode},select:function(){return this.selectedNode.props.assignedUser||[]},formItems:function(){return this.$store.state.design.formItems},formMap:function(){var e=this,t=new Map;return this.formItems.forEach((function(n){return e.itemToMap(t,n)})),t},conditionList:function(){var e=this,t=[];return this.formItems.forEach((function(n){return e.filterCondition(n,t)})),0!==t.length&&"root"===t[0].id||t.unshift({id:"root",title:"发起人",valueType:"User"}),t}},mounted:function(){},methods:{getUserExplains:function(e){var t=this.userExplains.filter((function(t){return t.key===e}))[0];return t||{expList:[]}},itemToMap:function(e,t){var n=this;e.set(t.id,t),"SpanLayout"===t.name&&t.props.items.forEach((function(t){return n.itemToMap(e,t)}))},isSelect:function(e){var t=this.formMap.get(e);return!(!t||"SelectInput"!==t.name&&"MultipleSelect"!==t.name)},conditionValType:function(e){switch(e){case"=":case">":case">=":case"<":case"<=":return 0;case"IN":return 1;default:return 2}},selectUser:function(e,t){this.orgType=t,this.users=e,this.$refs.orgPicker.show()},filterCondition:function(e,t){var n=this;if("SpanLayout"===e.name)e.props.items.forEach((function(e){return n.filterCondition(e,t)}));else if(this.supportTypes.indexOf(e.valueType)>-1){if("UserPicker"===e.name&&e.props.multiple)return;t.push({title:e.title,id:e.id,valueType:e.valueType,format:"Date"===e.valueType?e.props.format:"",dateType:"Date"===e.valueType?e.dateType:""})}},getOptions:function(e){var t=this.formMap.get(e).props;return t.optionsFromRemote&&t.remoteUrl.length>0?t.remoteOptions||[]:t.options||[]},selected:function(e){var t=this;this.users.length=0,e.forEach((function(e){return t.users.push(e)}))},delGroup:function(e){this.selectedNode.props.groups.splice(e,1)},rmSubCondition:function(e,t){e.conditions.splice(t,1)},conditionVisibleChange:function(e){console.log(e)},addConditionHandler:function(e){var t=ko({},this.conditionList[parseInt(e.split("-")[0])]);t.compare="",t.value=[],this.selectedNode.props.groups[parseInt(e.split("-")[1])].conditions.push(t)}}},gi=vi,bi=(n("a72f"),Object(d["a"])(gi,go,bo,!1,null,"6ed7c8ec",null)),yi=bi.exports,_i={name:"ConditionNodeConfig",components:{draggable:O.a,GroupItem:yi},props:{config:{type:Object,default:function(){return{}}}},computed:{selectedNode:function(){return this.$store.state.selectedNode},select:function(){return this.config.assignedUser||[]},nowNodeLeave:function(){return this.prioritySortList.indexOf(this.selectedNode)},prioritySortList:function(){var e=this.$store.state.nodeMap.get(this.selectedNode.parentId);return console.log(this.selectedNode.id,e),e&&e.branchs||[]}},data:function(){return{sortOption:{animation:300,chosenClass:"choose",scroll:!0,sort:!0}}},methods:{addConditionGroup:function(){this.config.groups.push({groupType:"OR",conditions:[]})},selectUser:function(){this.showOrgSelect=!0},selected:function(e){var t=this;console.log(e),this.showOrgSelect=!1,e.forEach((function(e){return t.select.push(e)}))},removeOrgItem:function(e){this.select.splice(e,1)}}},ki=_i,Si=(n("af72"),Object(d["a"])(ki,ho,vo,!1,null,"39987430",null)),wi=Si.exports,xi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{"margin-bottom":"20px"}},[n("p",{staticClass:"item-desc"},[e._v("延时方式")]),n("el-radio-group",{attrs:{size:"small"},model:{value:e.config.type,callback:function(t){e.$set(e.config,"type",t)},expression:"config.type"}},[n("el-radio-button",{attrs:{label:"FIXED"}},[e._v("固定时长")]),n("el-radio-button",{attrs:{label:"AUTO"}},[e._v("自动计算")])],1)],1),"FIXED"===e.config.type?n("div",[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"时间单位",size:"small",type:"number"},model:{value:e.config.time,callback:function(t){e.$set(e.config,"time",t)},expression:"config.time"}},[n("el-select",{staticStyle:{width:"75px"},attrs:{slot:"append",placeholder:"请选择"},slot:"append",model:{value:e.config.unit,callback:function(t){e.$set(e.config,"unit",t)},expression:"config.unit"}},[n("el-option",{attrs:{label:"月",value:"M"}}),n("el-option",{attrs:{label:"天",value:"D"}}),n("el-option",{attrs:{label:"小时",value:"TH"}}),n("el-option",{attrs:{label:"分钟",value:"TM"}}),n("el-option",{attrs:{label:"秒",value:"TS"}})],1)],1),n("span",{staticClass:"item-desc"},[e._v(" 后进入下一步")])],1):n("div",{staticClass:"item-desc"},[n("el-date-picker",{staticStyle:{width:"250px"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",placeholder:"选择日期时间",align:"right"},model:{value:e.config.dateTime,callback:function(t){e.$set(e.config,"dateTime",t)},expression:"config.dateTime"}}),n("span",{staticClass:"item-desc"},[e._v(" 后进入下一步")])],1)])},Ni=[],Ci={name:"DelayNodeConfig",components:{},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{}},methods:{}},Oi=Ci,$i=Object(d["a"])(Oi,xi,Ni,!1,null,"5f28ba94",null),Ii=$i.exports,Ei=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary",round:""},on:{click:e.selectOrg}},[e._v("选择抄送人")]),n("org-items",{model:{value:e.select,callback:function(t){e.select=t},expression:"select"}}),n("org-picker",{ref:"orgPicker",attrs:{multiple:"",selected:e.select},on:{ok:e.selected}})],1)},Pi=[],Ti={name:"CcNodeConfig.vue",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{config:{type:Object,default:function(){return{}}}},computed:{select:{get:function(){return this.config.assignedUser||[]},set:function(e){this.config.assignedUser=e}}},data:function(){return{}},methods:{selectOrg:function(){this.$refs.orgPicker.show()},selected:function(e){console.log(e),this.select=Object.assign([],e)},removeOrgItem:function(e){this.select.splice(e,1)}}},Li=Ti,Ri=(n("819a"),Object(d["a"])(Li,Ei,Pi,!1,null,"4ffbee71",null)),Ui=Ri.exports,Fi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("el-radio-group",{model:{value:e.selectStartUserType,callback:function(t){e.selectStartUserType=t},expression:"selectStartUserType"}},[n("el-radio",{attrs:{label:1}},[e._v("同主流程发起人")]),e.formSingleUserList.length>0?n("el-radio",{attrs:{label:2}},[e._v("选择表单中人员")]):e._e()],1),n("div",{staticStyle:{"margin-top":"20px"}},[3===e.selectStartUserType?[n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary"},on:{click:e.selectOrg}},[e._v("请选择")]),n("org-items",{model:{value:e.selectStartUser,callback:function(t){e.selectStartUser=t},expression:"selectStartUser"}}),n("org-picker",{ref:"orgPicker",attrs:{title:"请选择子流程发起人",type:"user",selected:e.selectStartUser},on:{ok:e.selected}})]:e._e(),2===e.selectStartUserType?[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectStartUserForm,callback:function(t){e.selectStartUserForm=t},expression:"selectStartUserForm"}},e._l(e.formSingleUserList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)]:e._e()],2),n("h4",[e._v("是否需要子流程发起人审阅表单")]),n("el-switch",{attrs:{"active-text":"需要","inactive-text":"不需要"},model:{value:e.selectStartUserCheckForm,callback:function(t){e.selectStartUserCheckForm=t},expression:"selectStartUserCheckForm"}}),n("h4",[e._v("选择子流程")]),n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.childProcessChange},model:{value:e.selectChildProcessId,callback:function(t){e.selectChildProcessId=t},expression:"selectChildProcessId"}},e._l(e.processList,(function(e){return n("el-option",{key:e.formId,attrs:{label:e.formName,value:e.formId}})})),1),e._m(1),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addOneLineInputFormMapping}},[e._v("添加一行")]),e._l(e.inputSelectFormMapping,(function(t,o){return n("el-row",{key:t.id,staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:10}},[n("el-select",{attrs:{placeholder:"主流程表单"},model:{value:t.mainId,callback:function(n){e.$set(t,"mainId",n)},expression:"a.mainId"}},e._l(e.mainRequiredFormSelect,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),n("el-col",{attrs:{span:10}},[t.mainId&&t.mainId.length>0?n("el-select",{attrs:{placeholder:"子流程表单"},model:{value:t.childId,callback:function(n){e.$set(t,"childId",n)},expression:"a.childId"}},e._l(e.getMatchChildProcessForm(t.mainId,t),(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1):e._e()],1),n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteInputFormMapping(o)}}})],1)],1)})),e._m(2),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addOneLineOutputFormMapping}},[e._v("添加一行")]),e._l(e.outputSelectFormMapping,(function(t,o){return n("el-row",{key:t.id,staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:10}},[n("el-select",{attrs:{placeholder:"子流程表单"},model:{value:t.childId,callback:function(n){e.$set(t,"childId",n)},expression:"a.childId"}},e._l(e.childRequiredFormSelect,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),n("el-col",{attrs:{span:10}},[t.childId&&t.childId.length>0?n("el-select",{attrs:{placeholder:"主流程表单"},model:{value:t.mainId,callback:function(n){e.$set(t,"mainId",n)},expression:"a.mainId"}},e._l(e.getMatchMainProcessForm(t.childId,t),(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1):e._e()],1),n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteOutputFormMapping(o)}}})],1)],1)}))],2)},Di=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h4",[e._v("选择嵌入式子流程发起人("),n("span",{staticClass:"desc"},[e._v("默认主流程发起人")]),e._v(")")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h4",[e._v("主子-表单映射("),n("span",{staticClass:"desc"},[e._v("主流程字段为必填项")]),e._v("）")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h4",[e._v("子主-表单映射("),n("span",{staticClass:"desc"},[e._v("子流程字段为必填项")]),e._v("）")])}],ji={name:"RootConfig",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{config:{type:Object,default:function(){return{}}}},mounted:function(){var e=this;this.getRemoteProcessGroup((function(){e.$isNotBlank(e.config.childProcessId)&&e.childProcessChange(e.config.childProcessId,!1)}))},data:function(){return{showOrgSelect:!1,processList:[],childProcessFormItems:[]}},computed:{setup:function(){return this.$store.state.design},inputSelectFormMapping:function(){return this.config.inputFormMapping},outputSelectFormMapping:function(){return this.config.outputFormMapping},formItems:function(){return this.$store.state.design.formItems},mainRequiredFormSelect:function(){var e=this.formItems;return e.filter((function(e){return!0===e.props.required}))},childRequiredFormSelect:function(){var e=this.childProcessFormItems;return e.filter((function(e){return!0===e.props.required}))},formMap:function(){var e=this,t=new Map;return this.formItems.forEach((function(n){return e.itemToMap(t,n)})),t},formSingleUserList:function(){var e=this.formItems.filter((function(e){return e.valueType===lt["a"].user&&!1===e.props.multiple&&!0===e.props.required}));return e},selectStartUser:function(){return this.config.startUser},selectStartUserType:{get:function(){return this.config.startUserType},set:function(e){this.config.startUserType=e}},selectChildProcessId:{get:function(){return this.config.childProcessId},set:function(e){this.config.childProcessId=e}},selectStartUserCheckForm:{get:function(){return this.config.startUserCheckForm},set:function(e){this.config.startUserCheckForm=e}},selectChildProcessName:{get:function(){return this.config.childProcessName},set:function(e){this.$set(this.config,"childProcessName",e)}},selectStartUserForm:{get:function(){return this.config.startUserForm},set:function(e){this.config.startUserForm=e}}},methods:{deleteInputFormMapping:function(e){this.inputSelectFormMapping.splice(e,1)},deleteOutputFormMapping:function(e){this.outputSelectFormMapping.splice(e,1)},getMatchChildProcessForm:function(e,t){var n=this.formItems.filter((function(t){return t.id===e}))[0],o=this.childProcessFormItems.filter((function(e){return e.valueType===n.valueType}));return o},getMatchMainProcessForm:function(e,t){var n=this.childProcessFormItems.filter((function(t){return t.id===e}))[0];if(!n)return[];var o=this.formItems.filter((function(e){return e.valueType===n.valueType}));return o},childProcessChange:function(e,t){var n=this,o=this.processList.filter((function(t){return t.formId===e}));o.length>0&&(this.selectChildProcessName=o[0].formName),void 0==t&&(this.inputSelectFormMapping.splice(0,this.inputSelectFormMapping.length),this.outputSelectFormMapping.splice(0,this.outputSelectFormMapping.length)),Object(f["b"])(e).then((function(e){var t=JSON.parse(e.data.formItems);n.childProcessFormItems=t}))},addOneLineInputFormMapping:function(){this.inputSelectFormMapping.push({mainId:"",childId:""})},addOneLineOutputFormMapping:function(){this.outputSelectFormMapping.push({mainId:"",childId:""})},getRemoteProcessGroup:function(e){var t=this;Object(f["c"])({hidden:!1}).then((function(n){var o,i=n.data,r=Object(Kt["a"])(i);try{for(r.s();!(o=r.n()).done;){var s,a=o.value,l=a.items,c=Object(Kt["a"])(l);try{for(c.s();!(s=c.n()).done;){var u=s.value,d=t.setup.formId;if(t.$isNotBlank(d)){if(d===u.formId)continue;t.processList.push(u)}else t.processList.push(u)}}catch(p){c.e(p)}finally{c.f()}}}catch(p){r.e(p)}finally{r.f()}e&&e()}))},itemToMap:function(e,t){var n=this;e.set(t.id,t),"SpanLayout"===t.name&&t.props.items.forEach((function(t){return n.itemToMap(e,t)}))},selectOrg:function(){this.$refs.orgPicker.show()},selected:function(e){var t=this;this.selectStartUser.length=0,e.forEach((function(e){return t.selectStartUser.push(e)}))},removeOrgItem:function(e){this.selectStartUser.splice(e,1)}}},Mi=ji,zi=(n("f7d4"),Object(d["a"])(Mi,Fi,Di,!1,null,"13dafea8",null)),Ai=zi.exports,Bi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{attrs:{"label-position":"top","label-width":"90px"}},[n("el-form-item",{staticClass:"user-type",attrs:{label:"选择触发的动作",prop:"text"}},[n("el-radio-group",{model:{value:e.config.type,callback:function(t){e.$set(e.config,"type",t)},expression:"config.type"}},[n("el-radio",{attrs:{label:"WEBHOOK"}},[e._v("发送网络请求")])],1)],1),"WEBHOOK"===e.config.type?n("div",[n("el-form-item",{attrs:{label:"请求地址",prop:"text"}},[n("el-input",{attrs:{placeholder:"请输入URL地址",size:"medium"},model:{value:e.config.http.url,callback:function(t){e.$set(e.config.http,"url",t)},expression:"config.http.url"}},[n("el-select",{staticStyle:{width:"85px"},attrs:{slot:"prepend",placeholder:"URL"},slot:"prepend",model:{value:e.config.http.method,callback:function(t){e.$set(e.config.http,"method",t)},expression:"config.http.method"}},[n("el-option",{attrs:{label:"POST",value:"POST"}})],1)],1)],1),n("el-form-item",{attrs:{label:"Header请求头",prop:"text"}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("span",{staticStyle:{"margin-right":"10px"}},[e._v("Header请求头")]),n("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addItem(e.config.http.headers)}}},[e._v(" + 添加")])],1),e._l(e.config.http.headers,(function(t,o){return n("div",{key:o},[e._v(" - "),n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"参数名",size:"small"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"header.name"}}),n("el-radio-group",{staticStyle:{margin:"0 5px"},attrs:{size:"small"},model:{value:t.isField,callback:function(n){e.$set(t,"isField",n)},expression:"header.isField"}},[n("el-radio-button",{attrs:{label:!0}},[e._v("表单")]),n("el-radio-button",{attrs:{label:!1}},[e._v("固定")])],1),t.isField?n("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请选择表单字段"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"header.value"}},e._l(e.forms,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1):n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请设置字段值",size:"small"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"header.value"}}),n("el-icon",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"5px",color:"#c75450",cursor:"pointer"},on:{click:function(t){return e.delItem(e.config.http.headers,o)}}})],1)}))],2),n("el-form-item",{attrs:{label:"Header请求参数",prop:"text"}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("span",{staticStyle:{"margin-right":"10px"}},[e._v("Header请求参数 ")]),n("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"text"},on:{click:function(t){return e.addItem(e.config.http.params)}}},[e._v(" + 添加")]),n("span",[e._v("参数类型 - ")]),n("el-radio-group",{staticStyle:{margin:"0 5px"},attrs:{size:"mini"},model:{value:e.config.http.contentType,callback:function(t){e.$set(e.config.http,"contentType",t)},expression:"config.http.contentType"}},[n("el-radio-button",{attrs:{label:"JSON"}},[e._v("json")])],1)],1),e._l(e.config.http.params,(function(t,o){return n("div",{key:o},[e._v(" - "),n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"参数名",size:"small"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"param.name"}}),n("el-radio-group",{staticStyle:{margin:"0 5px"},attrs:{size:"small"},model:{value:t.isField,callback:function(n){e.$set(t,"isField",n)},expression:"param.isField"}},[n("el-radio-button",{attrs:{label:!0}},[e._v("表单")]),n("el-radio-button",{attrs:{label:!1}},[e._v("固定")])],1),t.isField?n("el-select",{staticStyle:{width:"180px"},attrs:{size:"small",placeholder:"请选择表单字段"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"param.value"}},e._l(e.forms,(function(e){return n("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1):n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请设置字段值",size:"small"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"param.value"}}),n("el-icon",{staticClass:"el-icon-delete",staticStyle:{"margin-left":"5px",color:"#c75450",cursor:"pointer"},on:{click:function(t){return e.delItem(e.config.http.params,o)}}})],1)})),n("div")],2)],1):"EMAIL"===e.config.type?n("div",[n("el-form-item",{attrs:{label:"邮件主题",prop:"text"}},[n("el-input",{attrs:{placeholder:"请输入邮件主题",size:"medium"},model:{value:e.config.email.subject,callback:function(t){e.$set(e.config.email,"subject",t)},expression:"config.email.subject"}})],1),n("el-form-item",{attrs:{label:"收件方",prop:"text"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",multiple:"","allow-create":"","default-first-option":"",placeholder:"请输入收件人"},model:{value:e.config.email.to,callback:function(t){e.$set(e.config.email,"to",t)},expression:"config.email.to"}},e._l(e.config.email.to,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),n("el-form-item",{attrs:{label:"邮件正文",prop:"text"}},[n("el-input",{attrs:{type:"textarea",rows:4,placeholder:"邮件内容，支持变量提取表单数据 ${表单字段名} "},model:{value:e.config.email.content,callback:function(t){e.$set(e.config.email,"content",t)},expression:"config.email.content"}})],1)],1):e._e()],1)],1)},Vi=[],Gi={name:"TriggerNodeConfig",components:{},props:{config:{type:Object,default:function(){return{}}}},computed:{forms:function(){var e=[];e.push({id:"root",title:"发起人"});var t,n=this.$store.state.design.formItems||[],o=Object(Kt["a"])(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;e.push(i)}}catch(r){o.e(r)}finally{o.f()}return e},formsNoRoot:function(){var e,t=[],n=this.$store.state.design.formItems||[],o=Object(Kt["a"])(n);try{for(o.s();!(e=o.n()).done;){var i=e.value;t.push(i)}}catch(r){o.e(r)}finally{o.f()}return t}},data:function(){return{cmOptions:{tabSize:4,indentUnit:4,styleActiveLine:!0,lineNumbers:!0,styleSelectedText:!0,line:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","lock","warn"],highlightSelectionMatches:{showToken:/w/,annotateScrollbar:!0},mode:"javascript",hintOptions:{completeSingle:!1},keyMap:"sublime",matchBrackets:!0,showCursorWhenSelecting:!1,theme:"material",extraKeys:{Ctrl:"autocomplete"},lastLineBefore:0}}},methods:{addItem:function(e){e.length>0&&(""===e[e.length-1].name.trim()||""===e[e.length-1].value.trim())?this.$message.warning("请完善之前项后在添加"):e.push({name:"",value:"",isField:!0})},delItem:function(e,t){e.splice(t,1)},onCmCodeChange:function(){},onCmReady:function(){}}},Wi=Gi,Hi=(n("105c"),Object(d["a"])(Wi,Bi,Vi,!1,null,"7f98a447",null)),Ki=Hi.exports,qi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#f5f6f6"},data:e.formPerms,border:""}},[n("el-table-column",{attrs:{prop:"title","show-overflow-tooltip":"",label:"表单字段"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.required?n("span",{staticStyle:{color:"#c75450"}},[e._v(" * ")]):e._e(),n("span",[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{prop:"readOnly",label:"只读",width:"80"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-radio",{attrs:{label:"R"},on:{change:function(t){return e.allSelect("R")}},model:{value:e.permSelect,callback:function(t){e.permSelect=t},expression:"permSelect"}},[e._v("只读")])]}},{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:"R",name:t.row.id},model:{value:t.row.perm,callback:function(n){e.$set(t.row,"perm",n)},expression:"scope.row.perm"}})]}}])}),"CC"!==e.nowNode.type?n("el-table-column",{attrs:{prop:"editable",label:"可编辑",width:"90"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-radio",{attrs:{label:"E"},on:{change:function(t){return e.allSelect("E")}},model:{value:e.permSelect,callback:function(t){e.permSelect=t},expression:"permSelect"}},[e._v("可编辑")])]}},{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:"E",name:t.row.id},model:{value:t.row.perm,callback:function(n){e.$set(t.row,"perm",n)},expression:"scope.row.perm"}})]}}],null,!1,2030366288)}):e._e(),n("el-table-column",{attrs:{prop:"hide",label:"隐藏",width:"80"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-radio",{attrs:{label:"H"},on:{change:function(t){return e.allSelect("H")}},model:{value:e.permSelect,callback:function(t){e.permSelect=t},expression:"permSelect"}},[e._v("隐藏")])]}},{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:"H",name:t.row.id},model:{value:t.row.perm,callback:function(n){e.$set(t.row,"perm",n)},expression:"scope.row.perm"}})]}}])})],1)],1)},Ji=[],Yi={name:"FormAuthorityConfig",components:{},data:function(){return{tableData:[],isIndeterminate:!1,permSelect:"",checkStatus:{readOnly:!0,editable:!1,hide:!1}}},created:function(){var e=this.formPerms.toMap("id");this.formPerms.length=0,this.formPermsLoad(e,this.formData)},computed:{nowNode:function(){return this.$store.state.selectedNode},formData:function(){return this.$store.state.design.formItems},formPerms:function(){return this.$store.state.selectedNode.props.formPerms}},methods:{allSelect:function(e){this.permSelect=e,this.formPerms.forEach((function(t){return t.perm=e}))},formPermsLoad:function(e,t){var n=this;t.forEach((function(t){if("SpanLayout"===t.name)n.formPermsLoad(e,t.props.items);else{var o=e.get(t.id);o?(o.title=t.title,o.required=t.props.required,n.formPerms.push(o)):n.formPerms.push({id:t.id,title:t.title,required:t.props.required,perm:"ROOT"===n.$store.state.selectedNode.type?"E":"R"})}}))},handleCheckAllChange:function(){}},watch:{formPerms:{deep:!0,handler:function(){var e=new Set(this.formPerms.map((function(e){return e.perm})));this.permSelect=1===e.size?e.values()[0]:""}}}},Xi=Yi,Qi=(n("6d21"),Object(d["a"])(Xi,qi,Ji,!1,null,"1635969d",null)),Zi=Qi.exports,er=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",{staticClass:"desc"},[e._v("选择能发起该审批的人员/部门，不选则默认开放给所有人")]),n("el-button",{attrs:{size:"mini",icon:"el-icon-plus",type:"primary",round:""},on:{click:e.selectOrg}},[e._v("请选择")]),n("org-items",{model:{value:e.select,callback:function(t){e.select=t},expression:"select"}}),n("org-picker",{ref:"orgPicker",attrs:{title:"请选择可发起本审批的人员/部门",multiple:"",selected:e.select},on:{ok:e.selected}})],1)},tr=[],nr={name:"RootConfig",components:{OrgPicker:g["a"],OrgItems:de["a"]},props:{config:{type:Object,default:function(){return{}}}},data:function(){return{showOrgSelect:!1}},computed:{select:function(){return this.config.assignedUser}},methods:{selectOrg:function(){this.$refs.orgPicker.show()},selected:function(e){var t=this;this.select.length=0,e.forEach((function(e){return t.select.push(e)}))},removeOrgItem:function(e){this.select.splice(e,1)}}},or=nr,ir=(n("50fc"),Object(d["a"])(or,er,tr,!1,null,"5e7654a0",null)),rr=ir.exports,sr={name:"NodeConfig",components:{Approval:fo,Condition:wi,Trigger:Ki,Delay:Ii,Root:rr,Cc:Ui,child_process:Ai,FormAuthorityConfig:Zi},data:function(){return{active:"properties"}},computed:{selectNode:function(){return this.$store.state.selectedNode},formConfig:function(){return this.$store.state.design.formItems},name:function(){switch(this.selectNode.type){case"ROOT":return"设置发起人";case"APPROVAL":return"设置审批人";case"CC":return"设置抄送人";default:return null}}},methods:{}},ar=sr,lr=Object(d["a"])(ar,Bn,Vn,!1,null,"55582892",null),cr=lr.exports,ur={name:"ProcessDesign",components:{ProcessTree:An,NodeConfig:cr},data:function(){return{scale:100,selected:{},showInput:!1,showConfig:!1}},computed:{selectedNode:function(){return this.$store.state.selectedNode}},mounted:function(){},methods:{validate:function(){return this.$refs["process-tree"].validateProcess()},nodeSelected:function(e){console.log("配置节点",e),this.showConfig=!0}},watch:{}},dr=ur,pr=(n("d80b"),Object(d["a"])(dr,mt,ft,!1,null,"ec4b80c8",null)),mr=pr.exports,fr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"senior-setup"})},hr=[],vr=n("6b75");function gr(e){if(Array.isArray(e))return Object(vr["a"])(e)}n("d28b"),n("a630");function br(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var yr=n("06c5");function _r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kr(e){return gr(e)||br(e)||Object(yr["a"])(e)||_r()}var Sr=function(e,t,n){return t?/^[a-zA-z]+:\/\/[^\s]*/.test(t)?t.length>200?n(new Error("URL不能超过200个字符")):void n():n(new Error("请输入URL")):n(new Error("URL不能为空"))},wr={name:"FormProSetting",computed:{setup:function(){return this.$store.state.design.settings},formItems:function(){var e=this.$store.state.design.formItems,t=JSON.parse(JSON.stringify(e));return t.unshift({id:"root",title:"发起人",valueType:"User"}),t}},data:function(){return{rules:{url:[{validator:Sr,trigger:"blur"}]}}},mounted:function(){console.log(this.setup)},methods:{delFormItem:function(e,t){console.log(t),this.setup[e].params.splice(t,1)},addEndEventForm:function(){this.setup.endEventForm.params.push({name:"",value:"",isField:!0})},addStartEventForm:function(){this.setup.startEventForm.params.push({name:"",value:"",isField:!0})},validate:function(){var e=[],t=this.setup.startEventForm,n=this.setup.endEventForm;if(t.status){t.url&&/^[a-zA-z]+:\/\/[^\s]*/.test(t.url)?t.url.length>200&&e.push("开始事件URL不能超过200个字符"):e.push("请填写开始事件URL");var o=t.params,i=o.map((function(e){return e.name})),r=kr(new Set(i));r.length<i.length&&e.push("开始事件的自定义字段不能重复");var s,a=Object(Kt["a"])(o);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=l.name,u=l.value,d=l.isField;(!c||c.length<1||c.length>20)&&e.push("请填写开始事件表单自定义参数"),(!u||u.length<1)&&e.push("请选择开始事件表单"),d?(!u||u.length<1)&&e.push("请选择开始事件表单"):(!u||u.length<1||u.length>20)&&e.push("请填写开始事件参数值")}}catch(e){a.e(e)}finally{a.f()}}if(n.status){n.url&&/^[a-zA-z]+:\/\/[^\s]*/.test(n.url)?n.url.length>200&&e.push("结束事件URL不能超过200个字符"):e.push("请填写结束事件URL");o=n.params,i=o.map((function(e){return e.name})),r=kr(new Set(i));r.length<i.length&&e.push("结束事件的自定义字段不能重复");var p,m=Object(Kt["a"])(o);try{for(m.s();!(p=m.n()).done;){l=p.value,c=l.name,u=l.value,d=l.isField;(!c||c.length<1||c.length>20)&&e.push("请填写结束事件表单自定义参数"),d?(!u||u.length<1)&&e.push("请选择结束事件表单"):(!u||u.length<1||u.length>20)&&e.push("请填写结束事件参数值")}}catch(e){m.e(e)}finally{m.f()}}return e.length>0&&(this.$refs["startEventForm"].validate((function(e){})),this.$refs["endEventForm"].validate((function(e){}))),e}}},xr=wr,Nr=(n("1dcc"),Object(d["a"])(xr,fr,hr,!1,null,"0245ab34",null)),Cr=Nr.exports,Or={name:"FormProcessDesign",components:{LayoutHeader:m,FormBaseSetting:S,FormDesign:pt,ProcessDesign:mr,FormProSetting:Cr},data:function(){return{isNew:!0,validStep:0,timer:null,activeSelect:"baseSetting",validVisible:!1,validResult:{},validOptions:[{title:"基础信息",description:"",icon:"",status:""},{title:"审批表单",description:"",icon:"",status:""},{title:"审批流程",description:"",icon:"",status:""},{title:"扩展设置",description:"",icon:"",status:""}],validComponents:["baseSetting","formSetting","processDesign","proSetting"]}},computed:{setup:function(){return this.$store.state.design},errTitle:function(){return this.validResult.finished&&!this.validResult.success?this.validResult.title+" (".concat(this.validResult.errs.length,"项错误) 😥"):this.validResult.title},validIcon:function(){return this.validResult.finished?this.validResult.success?"success":"warning":"el-icon-loading"}},created:function(){this.showValiding();var e=this.$route.query.code;this.loadInitFrom(),this.$isNotEmpty(e)&&(this.isNew=!1,this.loadFormInfo(e));var t=this.$route.query.group;this.setup.groupId=this.$isNotEmpty(t)?parseInt(t):null},beforeDestroy:function(){this.stopTimer()},methods:{loadFormInfo:function(e){var t=this;Object(f["b"])(e).then((function(e){var n=e.data;n.logo=JSON.parse(n.logo),n.settings=JSON.parse(n.settings),n.formItems=JSON.parse(n.formItems),n.process=JSON.parse(n.process),t.$store.commit("loadForm",n)})).catch((function(e){t.$message.error(e)}))},loadInitFrom:function(){this.$store.commit("loadForm",{formId:null,formName:"未命名表单",logo:{icon:"el-icon-eleme",background:"#1e90ff"},settings:{startEventForm:{status:!1,url:"",method:"post",params:[]},endEventForm:{status:!1,url:"",method:"post",params:[]},commiter:[],admin:[],sign:!1,notify:{types:["APP"],title:"消息通知标题"}},groupId:void 0,formItems:[],process:{id:"root",parentId:null,type:"ROOT",name:"发起人",desc:"任何人",props:{assignedUser:[],formPerms:[]},children:{}},remark:"备注说明"})},validateDesign:function(){var e=this;this.validVisible=!0,this.validStep=0,this.showValiding(),this.stopTimer(),this.timer=setInterval((function(){e.validResult.errs=e.$refs[e.validComponents[e.validStep]].validate(),Array.isArray(e.validResult.errs)&&0===e.validResult.errs.length?(e.validStep++,e.validStep>=e.validOptions.length&&(e.stopTimer(),e.showValidFinish(!0))):(e.stopTimer(),e.validOptions[e.validStep].status="error",e.showValidFinish(!1,e.getDefaultValidErr()))}),300)},getDefaultValidErr:function(){switch(this.validStep){case 0:return"请检查基础设置项";case 1:return"请检查审批表单相关设置";case 2:return"请检查审批流程，查看对应标注节点错误信息";case 3:return"请检查扩展设置";default:return"未知错误"}},showValidFinish:function(e,t){this.validResult.success=e,this.validResult.finished=!0,this.validResult.title=e?"校验完成 😀":"校验失败 ",this.validResult.desc=e?"设置项校验成功，是否提交？":t,this.validResult.action=e?"提 交":"去修改"},showValiding:function(){this.validResult={errs:[],finished:!1,success:!1,title:"检查中...",action:"处理",desc:"正在检查设置项"},this.validStep=0,this.validOptions.forEach((function(e){e.status="",e.icon="",e.description=""}))},doAfter:function(){this.validResult.success?this.doPublish():(this.activeSelect=this.validComponents[this.validStep],this.validVisible=!1)},stopTimer:function(){this.timer&&clearInterval(this.timer)},preview:function(){this.validateDesign()},publishProcess:function(){this.validateDesign()},doPublish:function(){var e=this;this.$confirm("如果您只想预览请选择预览，确认发布后流程立即生效，是否继续?","提示",{confirmButtonText:"发布",cancelButtonText:"取消",type:"warning"}).then((function(){var t={formId:e.setup.formId,formName:e.setup.formName,logo:JSON.stringify(e.setup.logo),settings:JSON.stringify(e.setup.settings),groupId:e.setup.groupId,formItems:JSON.stringify(e.setup.formItems),process:JSON.stringify(e.setup.process),remark:e.setup.remark};e.isNew||!e.$isNotEmpty(e.setup.formId)?Object(f["a"])(t).then((function(t){e.$message.success("创建表单成功"),e.$router.push("/formsPanel")})).catch((function(t){e.$message.error(t)})):Object(f["g"])(t).then((function(t){e.$message.success("更新表单成功"),e.$router.push("/formsPanel")})).catch((function(t){e.$message.error(t)}))}))}}},$r=Or,Ir=(n("8067"),Object(d["a"])($r,r,s,!1,null,"51017911",null));t["default"]=Ir.exports},f7c3:function(e,t,n){},f7d4:function(e,t,n){"use strict";var o=n("1126"),i=n.n(o);i.a},fbad:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("0c6d");function i(e){return Object(o["a"])({url:"/userField/queryAll",method:"get",params:e})}},ff59:function(e,t,n){"use strict";var o=n("439a"),i=n.n(o);i.a}}]);
//# sourceMappingURL=chunk-7a992287.fa668281.js.map