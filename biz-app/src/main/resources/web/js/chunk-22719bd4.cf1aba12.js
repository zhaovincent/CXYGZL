(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22719bd4"],{"68ec":function(e,t,n){},"7ca0":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["DESIGN"===e.mode?n("div",[n("draggable",{staticClass:"l-drag-from",attrs:{list:e._columns,group:"form",options:{animation:300,chosenClass:"choose",sort:!0}},on:{start:function(t){e.drag=!0,e.selectFormItem=null},end:function(t){e.drag=!1}}},e._l(e._columns,(function(t,i){return n("div",{key:i,staticClass:"l-form-item",style:e.getSelectedClass(t),on:{click:function(n){return n.stopPropagation(),e.selectItem(t)}}},[n("div",{staticClass:"l-form-header"},[n("p",[t.props.required?n("span",[e._v("*")]):e._e(),e._v(e._s(t.title))]),n("div",{staticClass:"l-option"},[n("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delItem(i)}}})]),n("form-design-render",{attrs:{config:t}})],1)])})),0),n("div",{staticStyle:{color:"#c0bebe","text-align":"center",width:"90%",padding:"5px"}},[e._v("☝ 拖拽控件到表格内部")])],1):n("div",[e.rowLayout?n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{size:"medium","header-cell-style":{background:"#f5f7fa",padding:"3px 0"},border:e.showBorder,data:e._value}},[n("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),e._l(e._columns,(function(t,i){return n("el-table-column",{attrs:{"min-width":e.getMinWidth(t),prop:t.id,label:t.title},scopedSlots:e._u([{key:"default",fn:function(i){return[n("form-design-render",{class:{"valid-error":e.showError(t,e._value[i.$index][t.id])},attrs:{mode:e.mode,config:t},model:{value:e._value[i.$index][t.id],callback:function(n){e.$set(e._value[i.$index],t.id,n)},expression:"_value[scope.$index][column.id]"}})]}}],null,!0)})})),n("el-table-column",{attrs:{fixed:"right","min-width":"90",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return e.copyData(t.$index,t.row)}}},[e._v("复制 ")]),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return e.delRow(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3431180089)})],2),n("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v(e._s(e.placeholder))])],1):n("div",[e._l(e._value,(function(t,i){return n("el-form",{key:i,ref:"table-form-"+i,refInFor:!0,staticClass:"table-column",attrs:{rules:e.rules,model:t}},[n("div",{staticClass:"table-column-action"},[n("span",[e._v("第 "+e._s(i+1)+" 项")]),"R"!=e.perm?n("i",{staticClass:"el-icon-close",on:{click:function(n){return e.delRow(i,t)}}}):e._e()]),e._l(e._columns,(function(i,r){return n("el-form-item",{key:"column_"+r,attrs:{prop:i.id,label:i.title}},[n("form-design-render",{key:e.tempkey,attrs:{mode:e.mode,config:i},model:{value:t[i.id],callback:function(n){e.$set(t,i.id,n)},expression:"row[column.id]"}})],1)}))],2)})),"E"==e.perm?n("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v(e._s(e.placeholder)+" ")]):e._e()],2)])])},r=[],o=(n("4160"),n("a434"),n("b0c0"),n("a9e3"),n("159b"),n("b85c")),a=n("310e"),s=n.n(a),l=n("8032"),u=n("d16b"),c=n("8f73"),d={mixins:[c["a"]],name:"TableList",components:{draggable:s.a,FormDesignRender:u["a"]},props:{value:{type:Array,default:function(){return[]}},placeholder:{type:String,default:"添加数据"},columns:{type:Array,default:function(){return[]}},showBorder:{type:Boolean,default:!0},maxSize:{type:Number,default:0},rowLayout:{type:Boolean,default:!0},perm:{type:String,default:"E"}},mounted:function(){var e,t=Object(o["a"])(this.columns);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.props.perm=this.perm}}catch(i){t.e(i)}finally{t.f()}this.tempkey=(new Date).getTime()},watch:{perm:function(e){console.log("perm",e)}},created:function(){Array.isArray(this.value)||(this._value=[])},computed:{rules:function(){var e={};return this.columns.forEach((function(t){t.props.required&&(e[t.id]=[{type:"Array"===t.valueType?"array":void 0,required:!0,message:"请填写".concat(t.title),trigger:"blur"}])})),e},_columns:{get:function(){return this.columns},set:function(e){this.columns=e}},selectFormItem:{get:function(){return this.$store.state.selectFormItem},set:function(e){this.$store.state.selectFormItem=e}}},data:function(){return{tempkey:(new Date).getTime(),select:null,drag:!1,ValueType:l["a"]}},methods:{getMinWidth:function(e){switch(e.name){case"DateTime":return"250px";case"DateTimeRange":return"280px";case"MultipleSelect":return"200px";default:return"150px"}},showError:function(e,t){if(e.props.required)switch(e.valueType){case l["a"].dept:case l["a"].user:case l["a"].dateRange:case l["a"].array:return!(Array.isArray(t)&&t.length>0);default:return!this.$isNotEmpty(t)}return!1},copyData:function(e,t){this._value.push(this.$deepCopy(t))},delRow:function(e,t){this._value.splice(e,1)},addRow:function(){var e=this;if(this.maxSize>0&&this._value.length>=this.maxSize)this.$message.warning("最多只能添加".concat(this.maxSize,"行"));else{var t={};this.columns.forEach((function(n){return e.$set(t,n.id,void 0)})),this._value.push(t),this.$set(this,"_value",this._value)}},delItem:function(e){this._columns.splice(e,1)},selectItem:function(e){this.selectFormItem=e},getSelectedClass:function(e){return this.selectFormItem&&this.selectFormItem.id===e.id?"border-left: 4px solid #f56c6c":""},validate:function(e){var t=this;if(this.rowLayout){for(var n=!0,i=0;i<this.columns.length;i++)if(this.columns[i].props.required)for(var r=0;r<this._value.length;r++)if(n=!this.showError(this.columns[i],this._value[r][this.columns[i].id]),!n)return void e(!1);e(n)}else{var o=0;this._value.forEach((function(e,n){var i=t.$refs["table-form-".concat(n)];i&&Array.isArray(i)&&i.length>0&&i[0].validate((function(e){e&&o++}))})),o===this._value.length?e(!0):e(!1)}}}},m=d,f=(n("f348"),n("2877")),p=Object(f["a"])(m,i,r,!1,null,"de0596e2",null);t["default"]=p.exports},"8f73":function(e,t,n){"use strict";t["a"]={props:{mode:{type:String,default:"DESIGN"},required:{type:Boolean,default:!1}},data:function(){return{}},computed:{_value:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}}},f348:function(e,t,n){"use strict";var i=n("68ec"),r=n.n(i);r.a}}]);
//# sourceMappingURL=chunk-22719bd4.cf1aba12.js.map